<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Creating a Java Native Image application and run it as Production with Jenkins X - Cloud SQL - 2/10"><link href=https://joostvdg.github.io/jenkinsx/java-native-prod/02-cloud-sql/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-8.5.9"><title>Jenkins X - Java Native Image Prod - J's Software Development Pages</title><link rel=stylesheet href=../../../assets/stylesheets/main.20d9efc8.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.08040f6c.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#google-cloud-sql class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="J's Software Development Pages" class="md-header__button md-logo" aria-label="J's Software Development Pages" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 0 0 0 14a6 6 0 0 0 6 6h13a5 5 0 0 0 5-5c0-2.64-2.05-4.78-4.65-4.97Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> J's Software Development Pages </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Jenkins X - Java Native Image Prod </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=teal aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/joostvdg/joostvdg.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../blogs/jenkins-pipeline-support-tool/ class=md-tabs__link> Blogs </a> </li> <li class=md-tabs__item> <a href=../../../jenkins/jenkins-on-kubernetes/ class=md-tabs__link> Jenkins & CloudBees </a> </li> <li class=md-tabs__item> <a href=../../../openshift/rhos311-gcp-minimal/ class=md-tabs__link> Kubernetes & Docker </a> </li> <li class=md-tabs__item> <a href=../../../tanzu/ class=md-tabs__link> VMware Tanzu </a> </li> <li class=md-tabs__item> <a href=../../build-packs/ class="md-tabs__link md-tabs__link--active"> Jenkins X </a> </li> <li class=md-tabs__item> <a href=../../../cloud/automation-pulumi/ class=md-tabs__link> Software Eng. </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="J's Software Development Pages" class="md-nav__button md-logo" aria-label="J's Software Development Pages" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 0 0 0 14a6 6 0 0 0 6 6h13a5 5 0 0 0 5-5c0-2.64-2.05-4.78-4.65-4.97Z"/></svg> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../../other/mkdocs/ class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../../other/vim/ class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../../other/shell/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Blogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Blogs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blogs/jenkins-pipeline-support-tool/ class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class=md-nav__item> <a href=../../../blogs/graceful-shutdown/ class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../../blogs/docker-alternatives/ class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../../blogs/k8s-lets-encrypt/ class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../../../blogs/sso-azure-ad/ class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../../../blogs/teams-automation/ class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../../blogs/kubernetes-sso-keycloak/ class=md-nav__link> Kubernetes SSO Keycloak </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_8 type=checkbox id=__nav_2_8> <label class=md-nav__link for=__nav_2_8> Jenkins X Java Native Image Prod <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins X Java Native Image Prod" data-md-level=2> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Jenkins X Java Native Image Prod </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Cloud SQL <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Cloud SQL </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#requirements class=md-nav__link> Requirements </a> </li> <li class=md-nav__item> <a href=#ui class=md-nav__link> UI </a> </li> <li class=md-nav__item> <a href=#gcloud-cli class=md-nav__link> Gcloud CLI </a> <nav class=md-nav aria-label="Gcloud CLI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enable-cloud-sql-api class=md-nav__link> Enable Cloud SQL API </a> </li> <li class=md-nav__item> <a href=#create-database-instance class=md-nav__link> Create Database Instance </a> </li> <li class=md-nav__item> <a href=#create-database class=md-nav__link> Create Database </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#terraform class=md-nav__link> Terraform </a> <nav class=md-nav aria-label=Terraform> <ul class=md-nav__list> <li class=md-nav__item> <a href=#process class=md-nav__link> Process </a> </li> <li class=md-nav__item> <a href=#terraform-files class=md-nav__link> Terraform Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-to-connect-to-the-database class=md-nav__link> How To Connect To The Database </a> <nav class=md-nav aria-label="How To Connect To The Database"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-service-account class=md-nav__link> Create Service Account </a> </li> <li class=md-nav__item> <a href=#generate-json-key class=md-nav__link> Generate JSON Key </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../03-quarkus/ class=md-nav__link> Quarkus </a> </li> <li class=md-nav__item> <a href=../04-jx-import/ class=md-nav__link> Import Into Jenkins X </a> </li> <li class=md-nav__item> <a href=../05-jx-secrets/ class=md-nav__link> Database Connection And Secrets </a> </li> <li class=md-nav__item> <a href=../06-native-image/ class=md-nav__link> Native Image </a> </li> <li class=md-nav__item> <a href=../07-pipeline-improvements/ class=md-nav__link> Pipeline Improvements </a> </li> <li class=md-nav__item> <a href=../08-preview-int-test/ class=md-nav__link> Previews & Integration Tests </a> </li> <li class=md-nav__item> <a href=../09-production-improvements/ class=md-nav__link> Production Improvements </a> </li> <li class=md-nav__item> <a href=../10-promote-prod/ class=md-nav__link> Promote To Production </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_9 type=checkbox id=__nav_2_9> <label class=md-nav__link for=__nav_2_9> Jenkins Monitoring Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins Monitoring Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/introduction/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/prepare/ class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/install/ class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/metrics/ class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/alerts/ class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/pipeline/ class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/dashboard/ class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../../../blogs/monitor-jenkins-on-k8s/cloudbees/ class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../blogs/k8s-crd/ class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../../../blogs/dockercon-eu-2018/ class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Jenkins & CloudBees <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins & CloudBees" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Jenkins & CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins/jenkins-on-kubernetes/ class=md-nav__link> Jenkins On Kubernetes </a> </li> <li class=md-nav__item> <a href=../../../tanzu/jenkins-tap/ class=md-nav__link> TAP & Jenkins </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> CloudBees <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CloudBees data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cloudbees/cbci-casc/ class=md-nav__link> CloudBees CasC </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/sso-azure-ad/ class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/teams-automation/ class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-gke-helm/ class=md-nav__link> CloudBees CI on GKE </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-eks/ class=md-nav__link> CloudBees CI on EKS </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-team-namespace/ class=md-nav__link> Team Master Namespace </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/multi-cluster-gke/ class=md-nav__link> Multi-Cluster GKE </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/multi-cluster-eks/ class=md-nav__link> Multi-Cluster EKS </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/multi-cluster/ class=md-nav__link> Multi-Cluster (OLD/AKS) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Jenkins <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Jenkins data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jobdsl/ class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jenkins-jobs-builder/ class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Jenkins Pipelines <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins Pipelines" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline/job-types/ class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/kaniko-pipelines/ class=md-nav__link> Build Docker Image Kaniko </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/podtemplate-dind/ class=md-nav__link> PodTemplate With Docker-In-Docker </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/jenkins-parallel-pipeline/ class=md-nav__link> Parallel Pipelines </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/core-concepts/ class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/artifactory-integration/ class=md-nav__link> Artifactory Integration </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/declarative-pipeline/ class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/groovy-pipeline/ class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/global-shared-library/ class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/ide-integration-pipeline-dsl/ class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/input/ class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Jenkins Pipeline Examples <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins Pipeline Examples" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-alternatives/ class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/maven-declarative/ class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-declarative/ class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Kubernetes & Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Kubernetes & Docker" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Kubernetes & Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1> OpenShift <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=OpenShift data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> OpenShift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../openshift/rhos311-gcp-minimal/ class=md-nav__link> OpenShift 3.11 GCP(minimal) </a> </li> <li class=md-nav__item> <a href=../../../openshift/rhos311-gcp-medium/ class=md-nav__link> OpenShift 3.11 GCP(medium) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Kubernetes (K8S) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Kubernetes (K8S)" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/cka-exam-prep/ class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/tools/ class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Managed Kubernetes (cloud) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Managed Kubernetes (cloud)" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Managed Kubernetes (cloud) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/distributions/install-gke/ class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/gke-terraform/ class=md-nav__link> GKE Terraform </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/eks-eksctl/ class=md-nav__link> AWS EKS </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-cli/ class=md-nav__link> AKS CLI </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-terraform/ class=md-nav__link> AKS Terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> K8S Hard Way - GCE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="K8S Hard Way - GCE" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/ class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/terraform-compute/ class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/certificates/ class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/kubeconfigs/ class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/encryption/ class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/etcd/ class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/controller/ class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/worker/ class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/remote-access/ class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/network/ class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/debug/ class=md-nav__link> Debug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_5 type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docker/graceful-shutdown/ class=md-nav__link> Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../../docker/build-kit/ class=md-nav__link> BuildKit </a> </li> <li class=md-nav__item> <a href=../../../docker/multi-stage-builds/ class=md-nav__link> Multi-Stage Builds(TBD) </a> </li> <li class=md-nav__item> <a href=../../../docker/swarm/ class=md-nav__link> Swarm (mode) (TBD) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6 type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/systemd/ class=md-nav__link> SystemD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> VMware Tanzu <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="VMware Tanzu" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> VMware Tanzu </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tanzu/ class=md-nav__link> Tanzu </a> </li> <li class=md-nav__item> <a href=../../../tanzu/tap-on-tkgs/ class=md-nav__link> TAP on TKGs </a> </li> <li class=md-nav__item> <a href=../../../tanzu/harbor-ca/ class=md-nav__link> Harbor with custom CA </a> </li> <li class=md-nav__item> <a href=../../../tanzu/jenkins-tap/ class=md-nav__link> TAP Jenkins </a> </li> <li class=md-nav__item> <a href=../../../tanzu/tkg-grafana/ class=md-nav__link> TKG Grafana with LDAP </a> </li> <li class=md-nav__item> <a href=../../../tanzu/dependencies/ class=md-nav__link> Dependencies </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> Jenkins X <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Jenkins X" data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../build-packs/ class=md-nav__link> Build Packs </a> </li> <li class=md-nav__item> <a href=../../jx-pipelines/ class=md-nav__link> Jenkins X Pipelines </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_3 type=checkbox id=__nav_6_3 checked> <label class=md-nav__link for=__nav_6_3> Java Native Image Prod <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Java Native Image Prod" data-md-level=2> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Java Native Image Prod </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-intro/ class=md-nav__link> Intro </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Cloud SQL <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Cloud SQL </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#requirements class=md-nav__link> Requirements </a> </li> <li class=md-nav__item> <a href=#ui class=md-nav__link> UI </a> </li> <li class=md-nav__item> <a href=#gcloud-cli class=md-nav__link> Gcloud CLI </a> <nav class=md-nav aria-label="Gcloud CLI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enable-cloud-sql-api class=md-nav__link> Enable Cloud SQL API </a> </li> <li class=md-nav__item> <a href=#create-database-instance class=md-nav__link> Create Database Instance </a> </li> <li class=md-nav__item> <a href=#create-database class=md-nav__link> Create Database </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#terraform class=md-nav__link> Terraform </a> <nav class=md-nav aria-label=Terraform> <ul class=md-nav__list> <li class=md-nav__item> <a href=#process class=md-nav__link> Process </a> </li> <li class=md-nav__item> <a href=#terraform-files class=md-nav__link> Terraform Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-to-connect-to-the-database class=md-nav__link> How To Connect To The Database </a> <nav class=md-nav aria-label="How To Connect To The Database"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-service-account class=md-nav__link> Create Service Account </a> </li> <li class=md-nav__item> <a href=#generate-json-key class=md-nav__link> Generate JSON Key </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../03-quarkus/ class=md-nav__link> Quarkus </a> </li> <li class=md-nav__item> <a href=../04-jx-import/ class=md-nav__link> Import Into Jenkins X </a> </li> <li class=md-nav__item> <a href=../05-jx-secrets/ class=md-nav__link> Database Connection And Secrets </a> </li> <li class=md-nav__item> <a href=../06-native-image/ class=md-nav__link> Native Image </a> </li> <li class=md-nav__item> <a href=../07-pipeline-improvements/ class=md-nav__link> Pipeline Improvements </a> </li> <li class=md-nav__item> <a href=../08-preview-int-test/ class=md-nav__link> Previews & Integration Tests </a> </li> <li class=md-nav__item> <a href=../09-production-improvements/ class=md-nav__link> Production Improvements </a> </li> <li class=md-nav__item> <a href=../10-promote-prod/ class=md-nav__link> Promote To Production </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../builder-image/ class=md-nav__link> Create Builder Image </a> </li> <li class=md-nav__item> <a href=../../jxboot/ class=md-nav__link> JX Boot GKE </a> </li> <li class=md-nav__item> <a href=../../jxboot-aks/ class=md-nav__link> JX Boot AKS </a> </li> <li class=md-nav__item> <a href=../../aks-boot-core/ class=md-nav__link> JX Boot & CloudBees Core </a> </li> <li class=md-nav__item> <a href=../../rhos-311-minimal/ class=md-nav__link> OpenShift 3.11 </a> </li> <li class=md-nav__item> <a href=../../rhos-311-restricted/ class=md-nav__link> OpenShift 3.11 - Restricted </a> </li> <li class=md-nav__item> <a href=../../lighthouse-bitbucket/ class=md-nav__link> Lighthouse & Bitbucket </a> </li> <li class=md-nav__item> <a href=../../hello-world/ class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../maven/ class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../hybrid/ class=md-nav__link> Hybrid </a> </li> <li class=md-nav__item> <a href=../../kubernetes-days/ class=md-nav__link> Example For Console Reel </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Software Eng. <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Software Eng." data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Software Eng. </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7_1 type=checkbox id=__nav_7_1> <label class=md-nav__link for=__nav_7_1> Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automation data-md-level=2> <label class=md-nav__title for=__nav_7_1> <span class="md-nav__icon md-icon"></span> Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cloud/automation-pulumi/ class=md-nav__link> Pulumi </a> </li> <li class=md-nav__item> <a href=../../../certificates/lets-encrypt-k8s/ class=md-nav__link> Let's Encrypt K8S </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7_2 type=checkbox id=__nav_7_2> <label class=md-nav__link for=__nav_7_2> Software Engineering <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Software Engineering" data-md-level=2> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../swe/important-concepts/ class=md-nav__link> Important Concepts </a> </li> <li class=md-nav__item> <a href=../../../swe/naming/ class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../../swe/distributed/ class=md-nav__link> Distributed Computing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7_3 type=checkbox id=__nav_7_3> <label class=md-nav__link for=__nav_7_3> Productivity <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Productivity data-md-level=2> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../productivity/ class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../productivity/incidents/ class=md-nav__link> Incidents </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7_4 type=checkbox id=__nav_7_4> <label class=md-nav__link for=__nav_7_4> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=2> <label class=md-nav__title for=__nav_7_4> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../java/ class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../keep-watching/ class=md-nav__link> Spring Boot App </a> </li> <li class=md-nav__item> <a href=../../../java/networking/ class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../../java/concurrency/ class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#requirements class=md-nav__link> Requirements </a> </li> <li class=md-nav__item> <a href=#ui class=md-nav__link> UI </a> </li> <li class=md-nav__item> <a href=#gcloud-cli class=md-nav__link> Gcloud CLI </a> <nav class=md-nav aria-label="Gcloud CLI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enable-cloud-sql-api class=md-nav__link> Enable Cloud SQL API </a> </li> <li class=md-nav__item> <a href=#create-database-instance class=md-nav__link> Create Database Instance </a> </li> <li class=md-nav__item> <a href=#create-database class=md-nav__link> Create Database </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#terraform class=md-nav__link> Terraform </a> <nav class=md-nav aria-label=Terraform> <ul class=md-nav__list> <li class=md-nav__item> <a href=#process class=md-nav__link> Process </a> </li> <li class=md-nav__item> <a href=#terraform-files class=md-nav__link> Terraform Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-to-connect-to-the-database class=md-nav__link> How To Connect To The Database </a> <nav class=md-nav aria-label="How To Connect To The Database"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-service-account class=md-nav__link> Create Service Account </a> </li> <li class=md-nav__item> <a href=#generate-json-key class=md-nav__link> Generate JSON Key </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/jenkinsx/java-native-prod/02-cloud-sql.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=google-cloud-sql>Google Cloud SQL<a class=headerlink href=#google-cloud-sql title="Permanent link">&para;</a></h1> <p>As with any public cloud, Google Cloud has classic Relation Database Management System offering. In GCP this is called CloudSQL, and supports several flavors such a MySQL and Postgres.</p> <p>We will explore the different ways you can create a CloudSQL database, so it should work for everyone.</p> <h2 id=requirements>Requirements<a class=headerlink href=#requirements title="Permanent link">&para;</a></h2> <p>For this guide we need a MySQL Database.</p> <p>Personally, I don't like managing databases. I know enough to use them, and I while I know that I can get one in Kubernetes with ease, I still rather not manage it over time. With storage, upgrades, backups &amp; restore and so on. Which are definitely concerns you need to take care off, with a Database in Production.</p> <p>So, while it is not a hard requirement I strongly encourage you to use a managed database. And when in Google Cloud, the initial step is Cloud SQL.</p> <p>Staying true to the classics - at least for me - I want it to be like MySQL. No real reason, if you want Postgres or something else, go ahead. Most of this guide will be exactly the same.</p> <h2 id=ui>UI<a class=headerlink href=#ui title="Permanent link">&para;</a></h2> <p>If you do not want to automate the database creation, or you at least want to have a UI while exploring the options, Google offers a <a href=https://cloud.google.com/sql/docs/mysql/quickstart>clean UI with a guide</a> to get you started. Or even more handson, a <a href=https://codelabs.developers.google.com/codelabs/cloud-create-cloud-sql-db/index.html#0>Create a Managed MySQL Database with Cloud SQL Lab</a>!</p> <p>The guide is very intuitive, so I'll leave you to it. If you prefer a CLI or Terraform, read on!</p> <h2 id=gcloud-cli>Gcloud CLI<a class=headerlink href=#gcloud-cli title="Permanent link">&para;</a></h2> <p><code>gcloud</code> Is Google Cloud's CLI for interacting with Google Cloud API's.</p> <p>If you don't have it installed yet, <a href=https://cloud.google.com/sdk/install>read the installation guide</a>, and after, the <a href=https://cloud.google.com/sdk/docs/initializing>initialization guide</a> for setting up access.</p> <p>Ensure you have a working <code>gcloud</code> with a default project configured. Use <code>gcloud config list</code>, to verify this is the case. From there, creating the MySQL database we need is straightforward.</p> <p>We're going to execute to steps:</p> <ol> <li>enable the API</li> <li>we create the Database Instace, <a href=https://cloud.google.com/sdk/gcloud/reference/sql/instances/create>read here for more info on this command</a></li> <li>we create the Database in the Instance, so please do remember the name! <a href=https://cloud.google.com/sdk/gcloud/reference/sql/databases/create>read here for more info on that command</a></li> </ol> <h3 id=enable-cloud-sql-api>Enable Cloud SQL API<a class=headerlink href=#enable-cloud-sql-api title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>gcloud services <span class=nb>enable</span> sqladmin.googleapis.com
</code></pre></div> <h3 id=create-database-instance>Create Database Instance<a class=headerlink href=#create-database-instance title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>gcloud sql instances create quarkus-fruits <span class=se>\</span>
      --database-version<span class=o>=</span>MYSQL_5_7 --tier<span class=o>=</span>db-n1-standard-1 <span class=se>\</span>
      --region<span class=o>=</span>europe-west4 --root-password<span class=o>=</span>password123
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Do change the root-password!</p> </div> <h3 id=create-database>Create Database<a class=headerlink href=#create-database title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>gcloud sql databases create fruits --instance quarkus-fruits
</code></pre></div> <h2 id=terraform>Terraform<a class=headerlink href=#terraform title="Permanent link">&para;</a></h2> <p>I'm a big fan of Configuration-as-Code, and <a href=https://www.terraform.io/ >Terraform</a> is the absolute poster child of this concept. This is not a guide on Terraform, so we do dive further into the best practices. I do suggest you read about <a href=https://www.terraform.io/docs/backends/index.html>Terraform Backends</a>.</p> <p>We won't use one in this guide - for brevity - but do read it and think about using it.</p> <p>In general, we use three files with Terraform:</p> <ol> <li><strong>maint.tf</strong>: the main file with Module definitions and, if possible, the bulk of the configuration</li> <li><strong>variables.tf</strong>: input variables, so we can more easily re-use or share our files</li> <li><strong>outputs.tf</strong>: in the event you have output from the created resources, we have no outputs, so no file</li> </ol> <h3 id=process>Process<a class=headerlink href=#process title="Permanent link">&para;</a></h3> <p>First we initialize our configuration. This ensures Terraform has the right modules available to talk to this particular cloud API.</p> <div class=highlight><pre><span></span><code>terraform init
</code></pre></div> <p>Then we let Terraform plan what needs to be done. Terraform is declarative, meaning, we state our end-result Terraform will make it happen. Terraform plan, lets Terraform tell us how it wants to do so.</p> <p>We let Terraform output the plan to disk, so we can apply the plan, rather than letting Terraform figure it out again.</p> <div class=highlight><pre><span></span><code>terraform plan --out plan.out
</code></pre></div> <p>If the plan is valid and looks correct, we can apply it. Now terraform will create our resources.</p> <div class=highlight><pre><span></span><code>terraform apply <span class=s2>&quot;plan.out&quot;</span>
</code></pre></div> <h3 id=terraform-files>Terraform Files<a class=headerlink href=#terraform-files title="Permanent link">&para;</a></h3> <div class="admonition example"> <p class=admonition-title>main.tf<div class=highlight><pre><span></span><code><span class=nb>terraform</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>required_version</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;~&gt; 0.12&quot;</span><span class=w></span>
<span class=p>}</span><span class=c1></span>

<span class=c1># https://www.terraform.io/docs/providers/google/index.html</span>
<span class=kr>provider</span><span class=w> </span><span class=nv>&quot;google&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>version</span><span class=w>   </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;~&gt; 2.18.1&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>project</span><span class=w>   </span><span class=o>=</span><span class=w> </span><span class=nv>var.project</span><span class=w></span>
<span class=w>        </span><span class=na>region</span><span class=w>    </span><span class=o>=</span><span class=w> </span><span class=nv>var.region</span><span class=w></span>
<span class=w>        </span><span class=na>zone</span><span class=w>      </span><span class=o>=</span><span class=w> </span><span class=nv>var.zone</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>resource</span><span class=w> </span><span class=nc>&quot;google_sql_database_instance&quot;</span><span class=w> </span><span class=nv>&quot;master&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>name</span><span class=w>             </span><span class=o>=</span><span class=w> </span><span class=nv>var.database_instance_name</span><span class=w></span>
<span class=w>        </span><span class=na>database_version</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;MYSQL_5_7&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>region</span><span class=w>           </span><span class=o>=</span><span class=w> </span><span class=nv>var.region</span><span class=w></span>

<span class=w>        </span><span class=nb>settings</span><span class=w> </span><span class=p>{</span><span class=c1></span>
<span class=c1>                # Second-generation instance tiers are based on the machine</span>
<span class=c1>                # type. See argument reference below.</span>
<span class=w>                </span><span class=na>tier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nv>var.database_instance_tier</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>resource</span><span class=w> </span><span class=nc>&quot;google_sql_database&quot;</span><span class=w> </span><span class=nv>&quot;database&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>name</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=nv>var.database_name</span><span class=w></span>
<span class=w>        </span><span class=na>instance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nv>google_sql_database_instance.master.name</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> </p> </div> <div class="admonition example"> <p class=admonition-title>variables.tf<div class=highlight><pre><span></span><code><span class=kr>variable</span><span class=w> </span><span class=nv>&quot;project&quot;</span><span class=w> </span><span class=p>{</span><span class=w> </span>
<span class=w>        </span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;GCP Project ID&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>variable</span><span class=w> </span><span class=nv>&quot;region&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>default</span><span class=w> </span><span class=o>=</span><span class=s2>&quot;europe-west4&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;GCP Region&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>variable</span><span class=w> </span><span class=nv>&quot;zone&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>default</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;europe-west4-a&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;GCP Zone, should be within the Region&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>variable</span><span class=w> </span><span class=nv>&quot;database_instance_name&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;The name of the database instance&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>default</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;quarkus-fruits&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=kr>variable</span><span class=w> </span><span class=nv>&quot;database_instance_tier&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>default</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;db-n1-standard-1&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kr>variable</span><span class=w> </span><span class=nv>&quot;database_name&quot;</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;The name of the database&quot;</span><span class=w></span>
<span class=w>        </span><span class=na>default</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;fruits&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> </p> </div> <h2 id=how-to-connect-to-the-database>How To Connect To The Database<a class=headerlink href=#how-to-connect-to-the-database title="Permanent link">&para;</a></h2> <blockquote> <p>To access a Cloud SQL instance from an application running in Google Kubernetes Engine, you can use either the Cloud SQL Proxy (with public or private IP), or connect directly using a private IP address. The Cloud SQL Proxy is the recommended way to connect to Cloud SQL, even when using private IP. This is because the proxy provides strong encryption and authentication using IAM, which can help keep your database secure. <a href="https://cloud.google.com/sql/docs/mysql/connect-kubernetes-engine?hl=en_US">MySQL Connect From Kubernetes Guide</a></p> </blockquote> <p>Our appliction runs in Kubernetes, so the above guide is perfect for us. It is recommened to use the <code>Cloud SQL Proxy</code> and I tend to listen to such advise. So in this guide, we're going to use the proxy.</p> <p>We won't configure the proxy until later in the guide, but lets make sure we have the pre-requisites in place.</p> <p>We need:</p> <ol> <li>a Google Cloud Service Account with access to Cloud SQL</li> <li>a JSON key for this Service Account, which the proxy can use as credentials</li> </ol> <h3 id=create-service-account>Create Service Account<a class=headerlink href=#create-service-account title="Permanent link">&para;</a></h3> <p>To create the Service Account, you can either the <a href=https://cloud.google.com/iam/docs/creating-managing-service-accounts#creating_a_service_account>UI</a> or the <code>gcloud</code> CLI.</p> <p>Step one, create the Service Account:</p> <div class=highlight><pre><span></span><code>gcloud iam service-accounts create my-sa-123 <span class=se>\</span>
    --description<span class=o>=</span><span class=s2>&quot;sa-description&quot;</span> <span class=se>\</span>
    --display-name<span class=o>=</span><span class=s2>&quot;sa-display-name&quot;</span>
</code></pre></div> <p>Step two, give it the required permissions for Cloud SQL.</p> <div class=highlight><pre><span></span><code>gcloud projects add-iam-policy-binding my-project-123 <span class=se>\</span>
  --member serviceAccount:my-sa-123@my-project-123.iam.gserviceaccount.com <span class=se>\</span>
  --role roles/cloudsql.admin
</code></pre></div> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Do make sure you change the values such as <code>my-sa-123</code> and <code>my-project-123</code> to your values.</p> </div> <h3 id=generate-json-key>Generate JSON Key<a class=headerlink href=#generate-json-key title="Permanent link">&para;</a></h3> <p>To create the Service Account <strong><em>key</em></strong> you can either use the UI, or the <code>gcloud</code> CLI.</p> <div class=highlight><pre><span></span><code>gcloud iam service-accounts keys create ~key.json <span class=se>\</span>
  --iam-account &lt;YOUR-SA-NAME&gt;&gt;@project-id.iam.gserviceaccount.com
</code></pre></div> <p>And make sure you save the key.json, we will use it later.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2020-06-02 16:25:30</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../01-intro/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Intro" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Intro </div> </div> </a> <a href=../03-quarkus/ class="md-footer__link md-footer__link--next" aria-label="Next: Quarkus" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Quarkus </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 Joost van der Griendt </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/joostvdg target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/joost_vdg target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://linkedin.com/in/joostvdg target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "content.code.annotate", "toc.follow"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.d6c3db9e.min.js></script> </body> </html>