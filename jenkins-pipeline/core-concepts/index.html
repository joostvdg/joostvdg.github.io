<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link href=https://joostvdg.github.io/jenkins-pipeline/core-concepts/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.0"><title>Core Concepts - Joostvdg's Software Engineering Page</title><link rel=stylesheet href=../../assets/stylesheets/application.0284f74d.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.01803549.css><meta name=theme-color content=#fb8c00><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-145385967-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=red> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#core-concepts tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://joostvdg.github.io title="Joostvdg's Software Engineering Page" class="md-header-nav__button md-logo"> <i class=md-icon>public</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Joostvdg's Software Engineering Page </span> <span class=md-header-nav__topic> Core Concepts </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../blogs/docker-graceful-shutdown/ title=Blogs class=md-tabs__link> Blogs </a> </li> <li class=md-tabs__item> <a href=../../cloudbees/cbc-eks/ title=CICD class=md-tabs__link> CICD </a> </li> <li class=md-tabs__item> <a href=../../docker/multi-stage-builds/ title=Containers class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../certificates/lets-encrypt-k8s/ title=SWE class=md-tabs__link> SWE </a> </li> <li class=md-tabs__item> <a href=../../java/ title=Java class=md-tabs__link> Java </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://joostvdg.github.io title="Joostvdg's Software Engineering Page" class="md-nav__button md-logo"> <i class=md-icon>public</i> </a> Joostvdg's Software Engineering Page </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Blogs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blogs/docker-graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../blogs/gitops-pipeline/ title="GitOps Pipeline" class=md-nav__link> GitOps Pipeline </a> </li> <li class=md-nav__item> <a href=../../blogs/jenkins-pipeline-docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../blogs/k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../../blogs/k8s-controller/ title="Create your own k8s controller" class=md-nav__link> Create your own k8s controller </a> </li> <li class=md-nav__item> <a href=../../blogs/k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../../blogs/jenkins-pipeline-support-tool/ title="Jenkins Pipeline Support Tools" class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1-8 type=checkbox id=nav-1-8> <label class=md-nav__link for=nav-1-8> Jenkins Monitoring Kubernetes </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-1-8> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/install/ title="Install Tools" class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/alerts/ title=Alerts class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../../blogs/monitor-jenkins-on-k8s/cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../blogs/dockercon-eu-2018/ title="DockerCon EU 2018" class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-1 type=checkbox id=nav-2-1> <label class=md-nav__link for=nav-2-1> CloudBees </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-1> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-post-install-tips/ title="CloudBees Core Post Install" class=md-nav__link> CloudBees Core Post Install </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-2 type=checkbox id=nav-2-2> <label class=md-nav__link for=nav-2-2> JX </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-2> JX </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/intro/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/workshop/ title=Workshop class=md-nav__link> Workshop </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/buildpack/ title=BuildPack class=md-nav__link> BuildPack </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../jenkins/ title=Jenkins class=md-nav__link> Jenkins </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4> <label class=md-nav__link for=nav-2-4> Jenkins Job Management </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-4> Jenkins Job Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-5 type=checkbox id=nav-2-5 checked> <label class=md-nav__link for=nav-2-5> Jenkins Pipelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-5> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Core Concepts </label> <a href=./ title="Core Concepts" class="md-nav__link md-nav__link--active"> Core Concepts </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#terminology title=Terminology class=md-nav__link> Terminology </a> </li> <li class=md-nav__item> <a href=#pipeline-as-code title="Pipeline as Code" class=md-nav__link> Pipeline as Code </a> </li> <li class=md-nav__item> <a href=#step title=Step class=md-nav__link> Step </a> </li> <li class=md-nav__item> <a href=#master-vs-nodes title="Master vs Nodes" class=md-nav__link> Master vs Nodes </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#node title=Node class=md-nav__link> Node </a> </li> <li class=md-nav__item> <a href=#master title=Master class=md-nav__link> Master </a> </li> <li class=md-nav__item> <a href=#what-to-do title="What to do?" class=md-nav__link> What to do? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#workspace title=Workspace class=md-nav__link> Workspace </a> </li> <li class=md-nav__item> <a href=#checkout title=Checkout class=md-nav__link> Checkout </a> </li> <li class=md-nav__item> <a href=#stage title=Stage class=md-nav__link> Stage </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stages-in-classic-view title="Stages in classic view" class=md-nav__link> Stages in classic view </a> </li> <li class=md-nav__item> <a href=#stages-in-blue-ocean-view title="Stages in Blue Ocean view" class=md-nav__link> Stages in Blue Ocean view </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sandbox-and-script-security title="Sandbox and Script Security" class=md-nav__link> Sandbox and Script Security </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-error title="Example error" class=md-nav__link> Example error </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#java-vs-groovy title="Java vs. Groovy" class=md-nav__link> Java vs. Groovy </a> </li> <li class=md-nav__item> <a href=#env-object title="Env (object)" class=md-nav__link> Env (object) </a> </li> <li class=md-nav__item> <a href=#stash-archive title="Stash & archive" class=md-nav__link> Stash &amp; archive </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stash title=Stash class=md-nav__link> Stash </a> </li> <li class=md-nav__item> <a href=#archive-archiveartifacts title="Archive & archiveArtifacts" class=md-nav__link> Archive &amp; archiveArtifacts </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#credentials title=Credentials class=md-nav__link> Credentials </a> </li> <li class=md-nav__item> <a href=#tools-build-environment title="Tools & Build Environment" class=md-nav__link> Tools &amp; Build Environment </a> </li> <li class=md-nav__item> <a href=#pipeline-syntax-page title="Pipeline Syntax Page" class=md-nav__link> Pipeline Syntax Page </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../jenkins-parallel-pipeline/ title=Parallel class=md-nav__link> Parallel </a> </li> <li class=md-nav__item> <a href=../input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-6 type=checkbox id=nav-2-6> <label class=md-nav__link for=nav-2-6> Jenkins Pipeline Examples </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-6> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-shared-library/ title="Maven Shared Library" class=md-nav__link> Maven Shared Library </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Containers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> Docker </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker/multi-stage-builds/ title="Multi-Stage Builds" class=md-nav__link> Multi-Stage Builds </a> </li> <li class=md-nav__item> <a href=../../docker/graceful-shutdown/ title="Graceful shutdown" class=md-nav__link> Graceful shutdown </a> </li> <li class=md-nav__item> <a href=../../docker/swarm/ title="Swarm (mode)" class=md-nav__link> Swarm (mode) </a> </li> <li class=md-nav__item> <a href=../../docker/kubernetes/ title=Kubernetes class=md-nav__link> Kubernetes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../linux/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> <li class=md-nav__item> <a href=../../linux/networking/ title=Networking class=md-nav__link> Networking </a> </li> <li class=md-nav__item> <a href=../../linux/iptables/ title=iptables class=md-nav__link> iptables </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Kubernetes (K8S) </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam/ title="CKA Exam details" class=md-nav__link> CKA Exam details </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> K8S CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-4> K8S CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/cicd/cdp-jenkins-helm/ title="CD Pipeline Jenkins & Helm" class=md-nav__link> CD Pipeline Jenkins & Helm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> K8S Distribution </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-5> K8S Distribution </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aws-eks/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-6 type=checkbox id=nav-3-6> <label class=md-nav__link for=nav-3-6> K8S Hard Way - GCE </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-6> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> SWE </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> SWE </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1> <label class=md-nav__link for=nav-4-1> Other </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> Other </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> <li class=md-nav__item> <a href=../../other/mkdocs/ title="MKDocs (Static Website Generator)" class=md-nav__link> MKDocs (Static Website Generator) </a> </li> <li class=md-nav__item> <a href=../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class=md-nav__link for=nav-4-2> Software Engineering </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-2> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../swe/ddd/ title="Domain Driven Design" class=md-nav__link> Domain Driven Design </a> </li> <li class=md-nav__item> <a href=../../swe/microservices/ title=Microservices class=md-nav__link> Microservices </a> </li> <li class=md-nav__item> <a href=../../swe/algorithms/ title=Algorithms class=md-nav__link> Algorithms </a> </li> <li class=md-nav__item> <a href=../../swe/observability/ title=Observability class=md-nav__link> Observability </a> </li> <li class=md-nav__item> <a href=../../swe/others/ title=Others class=md-nav__link> Others </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> Productivity </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../productivity/tools/ title=Tools class=md-nav__link> Tools </a> </li> <li class=md-nav__item> <a href=../../productivity/intellij/ title="Intelli J" class=md-nav__link> Intelli J </a> </li> <li class=md-nav__item> <a href=../../productivity/paradigms/ title=Paradigms class=md-nav__link> Paradigms </a> </li> <li class=md-nav__item> <a href=../../productivity/studies/ title=Studies class=md-nav__link> Studies </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../java/spring/boot/ title="Spring Boot" class=md-nav__link> Spring Boot </a> </li> <li class=md-nav__item> <a href=../../java/java9/ title="Java 9" class=md-nav__link> Java 9 </a> </li> <li class=md-nav__item> <a href=../../java/ecosystem/ title="Java Ecosystem" class=md-nav__link> Java Ecosystem </a> </li> <li class=md-nav__item> <a href=../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../java/streams/ title="Java Streams" class=md-nav__link> Java Streams </a> </li> <li class=md-nav__item> <a href=../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#terminology title=Terminology class=md-nav__link> Terminology </a> </li> <li class=md-nav__item> <a href=#pipeline-as-code title="Pipeline as Code" class=md-nav__link> Pipeline as Code </a> </li> <li class=md-nav__item> <a href=#step title=Step class=md-nav__link> Step </a> </li> <li class=md-nav__item> <a href=#master-vs-nodes title="Master vs Nodes" class=md-nav__link> Master vs Nodes </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#node title=Node class=md-nav__link> Node </a> </li> <li class=md-nav__item> <a href=#master title=Master class=md-nav__link> Master </a> </li> <li class=md-nav__item> <a href=#what-to-do title="What to do?" class=md-nav__link> What to do? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#workspace title=Workspace class=md-nav__link> Workspace </a> </li> <li class=md-nav__item> <a href=#checkout title=Checkout class=md-nav__link> Checkout </a> </li> <li class=md-nav__item> <a href=#stage title=Stage class=md-nav__link> Stage </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stages-in-classic-view title="Stages in classic view" class=md-nav__link> Stages in classic view </a> </li> <li class=md-nav__item> <a href=#stages-in-blue-ocean-view title="Stages in Blue Ocean view" class=md-nav__link> Stages in Blue Ocean view </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sandbox-and-script-security title="Sandbox and Script Security" class=md-nav__link> Sandbox and Script Security </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-error title="Example error" class=md-nav__link> Example error </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#java-vs-groovy title="Java vs. Groovy" class=md-nav__link> Java vs. Groovy </a> </li> <li class=md-nav__item> <a href=#env-object title="Env (object)" class=md-nav__link> Env (object) </a> </li> <li class=md-nav__item> <a href=#stash-archive title="Stash & archive" class=md-nav__link> Stash &amp; archive </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stash title=Stash class=md-nav__link> Stash </a> </li> <li class=md-nav__item> <a href=#archive-archiveartifacts title="Archive & archiveArtifacts" class=md-nav__link> Archive &amp; archiveArtifacts </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#credentials title=Credentials class=md-nav__link> Credentials </a> </li> <li class=md-nav__item> <a href=#tools-build-environment title="Tools & Build Environment" class=md-nav__link> Tools &amp; Build Environment </a> </li> <li class=md-nav__item> <a href=#pipeline-syntax-page title="Pipeline Syntax Page" class=md-nav__link> Pipeline Syntax Page </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/jenkins-pipeline/core-concepts.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=core-concepts>Core Concepts<a class=headerlink href=#core-concepts title="Permanent link">&para;</a></h1> <p>Below are some core concepts to understand before building pipelines in Jenkins.</p> <ul> <li>Pipeline as Code</li> <li>Step</li> <li>Master vs Nodes</li> <li>Checkout</li> <li>Workspace</li> <li>Stage</li> <li>Sandbox and Script Security</li> <li>Java vs. Groovy</li> <li>Env (object)</li> <li>Stash &amp; archive</li> <li>Credentials</li> <li>Tools &amp; Build Environment</li> <li>Pipeline Syntax Page</li> </ul> <h2 id=terminology>Terminology<a class=headerlink href=#terminology title="Permanent link">&para;</a></h2> <p>The terminology used in this page is based upon the terms used by Cloudbees as related to Jenkins.</p> <p>If in doubt, please consult the <a href=https://jenkins.io/doc/book/glossary/ >Jenkins Glossary</a>. </p> <h2 id=pipeline-as-code>Pipeline as Code<a class=headerlink href=#pipeline-as-code title="Permanent link">&para;</a></h2> <h2 id=step>Step<a class=headerlink href=#step title="Permanent link">&para;</a></h2> <blockquote> <p>A single task; fundamentally steps tell Jenkins what to do inside of a Pipeline or Project.</p> </blockquote> <p>Consider the following piece of pipeline code:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>timestamps</span> <span class=o>{</span>
        <span class=n>stage</span> <span class=o>(</span><span class=err>&#39;</span><span class=n>My</span> <span class=n>FIrst</span> <span class=n>Stage</span><span class=err>&#39;</span><span class=o>)</span> <span class=o>{</span>
<span class=hll>            <span class=k>if</span> <span class=o>(</span><span class=n>isUnix</span><span class=o>())</span> <span class=o>{</span>
</span><span class=hll>                <span class=n>sh</span> <span class=err>&#39;</span><span class=n>echo</span> <span class=s>&quot;this is Unix!&quot;</span><span class=err>&#39;</span>
</span>            <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
<span class=hll>                <span class=n>bat</span> <span class=err>&#39;</span><span class=n>echo</span> <span class=s>&quot;this is windows&quot;</span><span class=err>&#39;</span>
</span>            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <p>The only execution that happens (almost) exclusively on the node (or build slave) are the <strong>isUnix()</strong>, <strong>sh</strong> and <strong>bat</strong> shell commands.</p> <p>Those specific tasks are the steps in pipeline code.</p> <h2 id=master-vs-nodes>Master vs Nodes<a class=headerlink href=#master-vs-nodes title="Permanent link">&para;</a></h2> <p>There are many things to keep in mind about Pipelines in Jenkins. By far the most important are those related to the distinction between Masters and Nodes.</p> <p>Aside from the points below, the key thing to keep in mind: Nodes (build slaves) are designed to executes task, Masters are not.</p> <ol> <li> <p>Except for the steps themselves, <strong>all</strong> of the Pipeline logic, the Groovy conditionals, loops, etc <strong>execute on the master</strong>. Whether simple or complex! Even <strong>inside a node block</strong>!</p> </li> <li> <p>Steps may use executors to do work where appropriate, but each step has a small on-master overhead too.</p> </li> <li> <p>Pipeline code is written as Groovy but the execution model is radically transformed at compile-time to Continuation Passing Style (CPS).</p> </li> <li> <p>This transformation provides valuable safety and durability guarantees for Pipelines, but it comes with trade-offs:</p> <ul> <li>Steps can invoke Java and execute fast and efficiently, but Groovy is much slower to run than normal.</li> <li>Groovy logic requires far more memory, because an object-based syntax/block tree is kept in memory.</li> </ul> </li> <li> <p>Pipelines persist the program and its state frequently to be able to survive failure of the master.</p> </li> </ol> <p>Source: <a href=https://jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/ >Sam van Oort</a>, Cloudbees Engineer</p> <h4 id=node>Node<a class=headerlink href=#node title="Permanent link">&para;</a></h4> <blockquote> <p>A machine which is part of the Jenkins environment and capable of executing Pipelines or Projects. Both the Master and Agents are considered to be Nodes.</p> </blockquote> <h4 id=master>Master<a class=headerlink href=#master title="Permanent link">&para;</a></h4> <blockquote> <p>The central, coordinating process which stores configuration, loads plugins, and renders the various user interfaces for Jenkins.</p> </blockquote> <h3 id=what-to-do>What to do?<a class=headerlink href=#what-to-do title="Permanent link">&para;</a></h3> <p>So, if Pipeline code can cause big loads on Master, what should we do than?</p> <ul> <li>Try to limit the use of logic in your groovy code</li> <li>Avoid blocking or I/O calls unless explicitly done on a slave via a Step</li> <li>If you need heavy processing, and there isn't a Step, create either a <ul> <li><a href=https://github.com/joostvdg/hello-world-jenkins-pipeline-plugin>plugin</a> </li> <li><a href=../jenkins-pipeline/global-shared-library/ >Shared Library</a></li> <li>Or use a CLI tool via a platform independent language, such as Java or Go</li> </ul> </li> </ul> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If need to do any I/O, use a plugin or anything related to a workspace, you <strong>need</strong> a node. If you only need to interact with variables, for example for an input form, do this <strong>outside</strong> of a node block. See <a href=../jenkins-pipeline/input>Pipeline Input</a> for how that works.</p> </div> <h2 id=workspace>Workspace<a class=headerlink href=#workspace title="Permanent link">&para;</a></h2> <blockquote> <p>A disposable directory on the file system of a Node where work can be done by a Pipeline or Project. Workspaces are typically left in place after a Build or Pipeline run completes unless specific Workspace cleanup policies have been put in place on the Jenkins Master.</p> </blockquote> <p>The key part of the glossary entry there is <em>disposable directory</em>. There are absolutely no guarantees about Workspaces in pipeline jobs.</p> <p>That said, what you should take care of:</p> <ul> <li>always clean your workspace before you start, you don't know the state of the folder you get</li> <li>always clean your workspace after you finish, this way you're less likely to run into problems in subsequent builds</li> <li>a workspace is a temporary folder on a single node's filesystem: so every time you use <code class=codehilite><span class=n>node</span><span class=err>{}</span></code> you have a new workspace</li> <li>after your build is finish or leaving the node otherwise, your workspace should be considered gone: need something from? stash or archive it!</li> </ul> <h2 id=checkout>Checkout<a class=headerlink href=#checkout title="Permanent link">&para;</a></h2> <p>There are several ways to do a checkout in the Jenkins pipeline code.</p> <p>In the groovy DSL you can use the <strong>Checkout</strong> dsl command, <strong>svn</strong> shorthand or the <strong>git</strong> shorthand.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;scm&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>git</span> <span class=s1>&#39;https://github.com/joostvdg/jishi&#39;</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <div class="admonition danger"> <p class=admonition-title>Danger</p> <p>If you use a pipeline from SCM, multi-branch pipeline or a derived job type, beware! Only the Jenkinsfile gets checked out. You still need to checkout the rest of your files yourself!</p> </div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>However, when using pipeline from SCM, multi-branch pipeline or a derived job type. You can use a shorthand: <strong>checkout scm</strong>. This checks out the scm defined in your job (where the Jenkinsfile came from). <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;scm&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>checkout</span> <span class=n>scm</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table></p> </div> <h2 id=stage>Stage<a class=headerlink href=#stage title="Permanent link">&para;</a></h2> <blockquote> <p>Stage is a step for defining a conceptually distinct subset of the entire Pipeline, for example: "Build", "Test", and "Deploy", which is used by many plugins to visualize or present Jenkins Pipeline status/progress.</p> </blockquote> <p>The stage "step" has a primary function and a secondary function.</p> <ul> <li>Its primary function is to define the <strong>visual boundaries</strong> between logically separable parts of the pipeline.<ul> <li>For example, you can define SCM, Build, QA, Deploy as stages to tell you where the build currently is or where it failed.</li> </ul> </li> <li>The secondary function is to provided a scope for variables.<ul> <li>Just like most programming languages, code <em>blocks</em> are a more than just syntactic sugar, they also limit the scope of variables.</li> </ul> </li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=err>&#39;</span><span class=n>SCM</span><span class=err>&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>def</span> <span class=n>myVar</span> <span class=o>=</span> <span class=err>&#39;</span><span class=n>abc</span><span class=err>&#39;</span>
        <span class=n>checkout</span> <span class=n>scm</span>
    <span class=o>}</span>
    <span class=n>stage</span><span class=o>(</span><span class=err>&#39;</span><span class=n>Build</span><span class=err>&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>sh</span> <span class=err>&#39;</span><span class=n>mvn</span> <span class=n>clean</span> <span class=n>install</span><span class=err>&#39;</span>
<span class=hll>        <span class=n>echo</span> <span class=n>myVar</span> <span class=err>#</span> <span class=n>will</span> <span class=n>fail</span> <span class=n>because</span> <span class=n>the</span> <span class=n>variable</span> <span class=n>doesn</span><span class=err>&#39;</span><span class=n>t</span> <span class=n>exist</span> <span class=n>here</span>
</span>    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h4 id=stages-in-classic-view>Stages in classic view<a class=headerlink href=#stages-in-classic-view title="Permanent link">&para;</a></h4> <p><img alt=ClassicViewStages src=../../images/stages-classic.png></p> <h4 id=stages-in-blue-ocean-view>Stages in Blue Ocean view<a class=headerlink href=#stages-in-blue-ocean-view title="Permanent link">&para;</a></h4> <p><img alt=ClassicViewStages src=../../images/stages-blue-ocean.png></p> <h2 id=sandbox-and-script-security>Sandbox and Script Security<a class=headerlink href=#sandbox-and-script-security title="Permanent link">&para;</a></h2> <p>In Jenkins some plugins - such as the pipeline plugin - allow you to write groovy code that gets executed on the master.</p> <p>This means you could run code on the master that accesses the host machine with the same rights as Jenkins. As is unsafe, Jenkins has some guards against this in the form the <strong>sandbox mode</strong> and the <strong>script security</strong>.</p> <p>When you create a pipeline job, you get a inline code editor by default. If you're an administrator you get the option to turn the "sandbox" mode of.</p> <p>If you use a pipeline from SCM or any of the higher abstraction pipeline job types (Multibranch Pipeline, BitBucket Team) you are always running in sandbox mode.</p> <p>When you're in sandbox mode, your script will run past the script security. This uses a whitelisting technique to block dangerous or undesired methods, but is does so in a very restrictive manner.</p> <p>It could be you're doing something that is safe but still gets blocked. An administrator can then go to the script approval page (under Jenkins Administration) and approve your script.</p> <p>For more details, please consult <a href=https://wiki.jenkins-ci.org/display/jenkins/script+security+plugin>Script Security plugin</a> page.</p> <h3 id=example-error>Example error<a class=headerlink href=#example-error title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>org</span><span class=o>.</span><span class=na>jenkinsci</span><span class=o>.</span><span class=na>plugins</span><span class=o>.</span><span class=na>scriptsecurity</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>RejectedAccessException</span><span class=o>:</span> <span class=n>unclassified</span> <span class=n>staticMethod</span> <span class=n>org</span><span class=o>.</span><span class=na>tmatesoft</span><span class=o>.</span><span class=na>svn</span><span class=o>.</span><span class=na>core</span><span class=o>.</span><span class=na>internal</span><span class=o>.</span><span class=na>io</span><span class=o>.</span><span class=na>dav</span><span class=o>.</span><span class=na>DAVRepositoryFactory</span> <span class=n>create</span> <span class=n>org</span><span class=o>.</span><span class=na>tmatesoft</span><span class=o>.</span><span class=na>svn</span><span class=o>.</span><span class=na>core</span><span class=o>.</span><span class=na>SVNURL</span>
    <span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>jenkinsci</span><span class=o>.</span><span class=na>plugins</span><span class=o>.</span><span class=na>scriptsecurity</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>groovy</span><span class=o>.</span><span class=na>SandboxInterceptor</span><span class=o>.</span><span class=na>onStaticCall</span><span class=o>(</span><span class=n>SandboxInterceptor</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=mi>138</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>kohsuke</span><span class=o>.</span><span class=na>groovy</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>impl</span><span class=o>.</span><span class=na>Checker$2</span><span class=o>.</span><span class=na>call</span><span class=o>(</span><span class=n>Checker</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=mi>180</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>kohsuke</span><span class=o>.</span><span class=na>groovy</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>impl</span><span class=o>.</span><span class=na>Checker</span><span class=o>.</span><span class=na>checkedStaticCall</span><span class=o>(</span><span class=n>Checker</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=mi>177</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>kohsuke</span><span class=o>.</span><span class=na>groovy</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>impl</span><span class=o>.</span><span class=na>Checker</span><span class=o>.</span><span class=na>checkedCall</span><span class=o>(</span><span class=n>Checker</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=mi>91</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>cloudbees</span><span class=o>.</span><span class=na>groovy</span><span class=o>.</span><span class=na>cps</span><span class=o>.</span><span class=na>sandbox</span><span class=o>.</span><span class=na>SandboxInvoker</span><span class=o>.</span><span class=na>methodCall</span><span class=o>(</span><span class=n>SandboxInvoker</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=mi>16</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>WorkflowScript</span><span class=o>.</span><span class=na>run</span><span class=o>(</span><span class=n>WorkflowScript</span><span class=o>:</span><span class=mi>12</span><span class=o>)</span>
    <span class=n>at</span> <span class=n>___cps</span><span class=o>.</span><span class=na>transform___</span><span class=o>(</span><span class=n>Native</span> <span class=n>Method</span><span class=o>)</span>
</pre></div> </td></tr></table> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>There are three ways to deal with these errors.</p> <ul> <li>go to manage jenkins &rarr; script approval and approve the script</li> <li>use a <a href=../jenkins-pipeline/global-shared-library>Shared Library</a></li> <li>use a CLI tool/script via a shell command to do what you need to do</li> </ul> </div> <h2 id=java-vs-groovy>Java vs. Groovy<a class=headerlink href=#java-vs-groovy title="Permanent link">&para;</a></h2> <p>The pipeline code has to be written in groovy and therefor can also use java code. Two big difference to note: </p> <ul> <li>the usage of double quoted string (gstring, interpreted) and single quoted strings (literal)<ul> <li><code class=codehilite><span class=n>def</span> <span class=n>abc</span> <span class=o>=</span> <span class=s1>&#39;xyz&#39;</span> <span class=o>#</span> <span class=k>is</span> <span class=n>a</span> <span class=n>literal</span></code></li> <li><code class=codehilite><span class=n>echo</span> <span class=s1>&#39;$abc&#39;</span> <span class=o>#</span> <span class=n>prints</span> <span class=err>$</span><span class=n>abc</span></code></li> <li><code class=codehilite><span class=n>echo</span> <span class=ss>&quot;$abc&quot;</span> <span class=o>#</span> <span class=n>prints</span> <span class=n>xyz</span></code></li> </ul> </li> <li>no use of <strong>;</strong></li> </ul> <p>Unfortunately, due to the way the Pipeline code is processed, many of the groovy features don't work or don't work as expected.</p> <p>Things like the lambda's and for-each loops don't work well and are best avoided. In these situations, it is best to keep to the standard syntax of Java.</p> <p>For more information on how the groovy is being processed, it is best to read the <a href=https://github.com/jenkinsci/workflow-cps-plugin/#technical-design>technical-design</a>.</p> <h2 id=env-object>Env (object)<a class=headerlink href=#env-object title="Permanent link">&para;</a></h2> <p>The env object is an object that is available to use in any pipeline script.</p> <p>The env object allows you to store objects and variables to be used anywhere during the script. So things can be shared between nodes, the master and nodes and code blocks.</p> <p>Why would you want to use it? As in general, global variables are a bad practice. But if you need to have variables to be available through the execution on different machines (master, nodes) it is good to use this.</p> <p>Also the env object contains context variables, such as BRANCH_NAME, JOB_NAME and so one. For a complete overview, view the pipeline syntax page.</p> <p>Don't use the env object in functions, always feed them the parameters directly. Only use it in the "pipeline flow" and use it for the parameters of the methods. </p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;SCM&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>checkout</span> <span class=n>scm</span> 
    <span class=o>}</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Echo&#39;</span><span class=o>){</span>
        <span class=n>echo</span> <span class=s2>&quot;Branch=$env.BRANCH_NAME&quot;</span> <span class=c1>// will print Branch=master</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h2 id=stash-archive>Stash &amp; archive<a class=headerlink href=#stash-archive title="Permanent link">&para;</a></h2> <p>If you need to store files for keeping for later, there are two options available <strong>stash</strong> and <strong>archive</strong>.</p> <p>Both should be avoided as they cause heavy I/O traffic, usually between the Node and Master.</p> <p>For more specific information, please consult the Pipeline Syntax Page.</p> <h3 id=stash>Stash<a class=headerlink href=#stash title="Permanent link">&para;</a></h3> <p>Stash allows you to copy files from the current workspace to a temp folder in the workspace in the master. If you're currently on a different machine it will copy them one by one over the network, keep this in mind.</p> <p>The files can only be retrieved during the pipeline execution and you can do so via the <em>unstash</em> command.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span><span class=o>(</span><span class=s1>&#39;Machine1&#39;</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;A&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=c1>// generate some files</span>
        <span class=n>stash</span> <span class=nl>excludes:</span> <span class=s1>&#39;secret.txt&#39;</span><span class=o>,</span> <span class=nl>includes:</span> <span class=s1>&#39;*.txt&#39;</span><span class=o>,</span> <span class=nl>name:</span> <span class=s1>&#39;abc&#39;</span>
    <span class=o>}</span>
<span class=o>}</span>
<span class=n>node</span><span class=o>(</span><span class=s1>&#39;Machine2&#39;</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;B&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>unstash</span> <span class=s1>&#39;abc&#39;</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <blockquote> <p>Saves a set of files for use later in the same build, generally on another node/workspace. Stashed files are not otherwise available and are generally discarded at the end of the build. Note that the stash and unstash steps are designed for use with small files. For large data transfers, use the External Workspace Manager plugin, or use an external repository manager such as Nexus or Artifactory.</p> </blockquote> <h3 id=archive-archiveartifacts>Archive &amp; archiveArtifacts<a class=headerlink href=#archive-archiveartifacts title="Permanent link">&para;</a></h3> <blockquote> <p>Archives build output artifacts for later use. As of Jenkins 2.x, you may use the more configurable archiveArtifacts.</p> </blockquote> <p>With archive you can store a file semi-permanently in your job. Semi as the files will be overridden by the latest build.</p> <p>The files you archive will be stored in the Job folder on the master. </p> <p>One usecase is to save a log file from a build tool.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;A&#39;</span><span class=o>)</span> <span class=o>{</span>

        <span class=k>try</span> <span class=o>{</span>
            <span class=c1>// do some build</span>
        <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
            <span class=c1>// This step should not normally be used in your script. Consult the inline help for details.</span>
            <span class=n>archive</span> <span class=nl>excludes:</span> <span class=s1>&#39;useless.log&#39;</span><span class=o>,</span> <span class=nl>includes:</span> <span class=s1>&#39;*.log&#39;</span>

            <span class=c1>// Use this instead, but only for permanent files, or external logfiles</span>
            <span class=n>archiveArtifacts</span> <span class=nl>allowEmptyArchive:</span> <span class=kc>true</span><span class=o>,</span> <span class=nl>artifacts:</span> <span class=s1>&#39;*.log&#39;</span><span class=o>,</span> <span class=nl>excludes:</span> <span class=s1>&#39;useless.log&#39;</span><span class=o>,</span> <span class=nl>fingerprint:</span> <span class=kc>true</span><span class=o>,</span> <span class=nl>onlyIfSuccessful:</span> <span class=kc>true</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h2 id=credentials>Credentials<a class=headerlink href=#credentials title="Permanent link">&para;</a></h2> <p>In many pipelines you will have to deal with external systems, requiring credentials.</p> <p>Jenkins has the <a href=https://www.cloudbees.com/blog/credentials-api-jenkins>Credentials API</a> which you can also utilize in the pipeline.</p> <p>You can use do this via the <a href=https://wiki.jenkins.io/display/JENKINS/Credentials+Plugin>Credentials</a> and <a href=https://wiki.jenkins.io/display/JENKINS/Credentials+Binding+Plugin>Credentials Binding</a> plugins, the first is the core plugin the second provides the integration for the pipeline.</p> <p>The best way to generate the required code snippet, is to go to the pipeline syntax page, select <strong>withCredentials</strong> and configure what you need.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;someRemoteCall&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>withCredentials</span><span class=o>([</span><span class=n>usernameColonPassword</span><span class=o>(</span><span class=nl>credentialsId:</span> <span class=s1>&#39;someCredentialsId&#39;</span><span class=o>,</span> <span class=nl>variable:</span> <span class=s1>&#39;USRPASS&#39;</span><span class=o>)])</span> <span class=o>{</span>
            <span class=n>sh</span> <span class=s2>&quot;curl -u $env.USRPASS $URL&quot;</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <p>For more examples, please consult Cloudbees' <a href=https://support.cloudbees.com/hc/en-us/articles/203802500-Injecting-Secrets-into-Jenkins-Build-Jobs>Injecting-Secrets-into-Jenkins-Build-Jobs</a> blog post.</p> <h2 id=tools-build-environment>Tools &amp; Build Environment<a class=headerlink href=#tools-build-environment title="Permanent link">&para;</a></h2> <p>Jenkins would not be Jenkins without the direct support for the build tools, such as JDK's, SDK's, Maven, Ant what have you not.</p> <p>So, how do you use them in the pipeline?</p> <p>Unfortunately, this is a bit more cumbersome than it is in a freestyle (or <strong>legacy</strong>) job.</p> <p>You have to do two things:</p> <ol> <li>retrieve the tool's location via the <strong>tool</strong> DSL method</li> <li>set the environment variables to suit the tool</li> </ol> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Maven&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>String</span> <span class=n>jdk</span> <span class=o>=</span> <span class=n>tool</span> <span class=nl>name:</span> <span class=s1>&#39;jdk_8&#39;</span><span class=o>,</span> <span class=nl>type:</span> <span class=s1>&#39;jdk&#39;</span>
        <span class=n>String</span> <span class=n>maven</span> <span class=o>=</span> <span class=n>tool</span> <span class=nl>name:</span> <span class=s1>&#39;maven_3.5.0&#39;</span><span class=o>,</span> <span class=nl>type:</span> <span class=s1>&#39;maven&#39;</span>
        <span class=n>withEnv</span><span class=o>([</span><span class=s2>&quot;JAVA_HOME=$jdk&quot;</span><span class=o>,</span> <span class=s2>&quot;PATH+MAVEN=${jdk}/bin:${maven}/bin&quot;</span><span class=o>])</span> <span class=o>{</span>
            <span class=n>sh</span> <span class=s1>&#39;mvn clean install&#39;</span> 
        <span class=o>}</span>

        <span class=c1>// or in one go</span>
        <span class=n>withEnv</span><span class=o>([</span><span class=s2>&quot;JAVA_HOME=${ tool &#39;jdk_8&#39; }&quot;</span><span class=o>,</span> <span class=s2>&quot;PATH+MAVEN=${tool &#39;maven_3.5.0&#39;}/bin:${env.JAVA_HOME}/bin&quot;</span><span class=o>])</span> <span class=o>{</span>
            <span class=n>sh</span> <span class=s1>&#39;mvn clean install&#39;</span> 
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h2 id=pipeline-syntax-page>Pipeline Syntax Page<a class=headerlink href=#pipeline-syntax-page title="Permanent link">&para;</a></h2> <p>Soooo, do I always have to figure out how to write these code snippets?</p> <p>No, don't worry. You don't have to.</p> <p>At every pipeline job type there is a link called "Pipeline Syntax".</p> <p>This gives you a page with a drop down menu, from where you can select all the available steps.</p> <p>Once you select a step, you can use the UI to setup the step and then use the <em>generate</em> button to give you the correct syntax. </p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> JenkinsJobsBuilder </span> </div> </a> <a href=../declarative-pipeline/ title="Pipeline (declarative)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Pipeline (declarative) </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Joost van der Griendt </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=https://github.com/joostvdg class="md-footer-social__link fa fa-github"></a> <a href=https://twitter.com/joost_vdg class="md-footer-social__link fa fa-twitter"></a> <a href=https://linkedin.com/in/joostvdg class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.245445c6.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>