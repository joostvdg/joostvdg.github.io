<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How To Create Better Jenkins Pipelines With Compact CLI's"><link href=https://joostvdg.github.io/blogs/jenkins-pipeline-support-tool/ rel=canonical><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.1.7"><title>Jenkins Pipeline Support Tools</title><link rel=stylesheet href=../../assets/stylesheets/main.4c7052ca.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.b79bcd20.min.css><meta name=theme-color content=#ffa726><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700%7CCutive+Mono&display=fallback"><style>body,input{font-family:"Lato",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Cutive Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel="preconnect dns-prefetch" href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-145385967-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#jenkins-pipeline-support-tools class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-header-nav__button md-logo" aria-label="J's Software Development Pages"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> J's Software Development Pages </span> <span class="md-header-nav__topic md-ellipsis"> Jenkins Pipeline Support Tools </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=./ class="md-tabs__link md-tabs__link--active"> Blogs </a> </li> <li class=md-tabs__item> <a href=../../cloudbees/sso-azure-ad/ class=md-tabs__link> Jenkins & CloudBees </a> </li> <li class=md-tabs__item> <a href=../../jenkinsx/build-packs/ class=md-tabs__link> Jenkins X </a> </li> <li class=md-tabs__item> <a href=../../openshift/rhos311-gcp-minimal/ class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../cloud/automation-pulumi/ class=md-tabs__link> Software Eng. </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-nav__button md-logo" aria-label="J's Software Development Pages"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Me class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../other/mkdocs/ title="MKDocs (This Static Website)" class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../other/shell/ title=Shell class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Blogs <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Blogs data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Jenkins Pipeline Support Tools <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="Jenkins Pipeline Support Tools" class="md-nav__link md-nav__link--active"> Jenkins Pipeline Support Tools </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#ideal-pipeline class=md-nav__link> Ideal Pipeline </a> </li> <li class=md-nav__item> <a href=#kubernetes-pods class=md-nav__link> Kubernetes Pods </a> <nav class=md-nav aria-label="Kubernetes Pods"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#podtemplate-example class=md-nav__link> PodTemplate example </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#java-example class=md-nav__link> Java Example </a> <nav class=md-nav aria-label="Java Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-jdk-image class=md-nav__link> Custom JDK Image </a> <nav class=md-nav aria-label="Custom JDK Image"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile class=md-nav__link> Dockerfile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#image-disk-size class=md-nav__link> Image disk size </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#graal class=md-nav__link> Graal </a> <nav class=md-nav aria-label=Graal> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_1 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_1 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_1 class=md-nav__link> Dockerfile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#image-disk-size_1 class=md-nav__link> Image disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#go-example class=md-nav__link> Go Example </a> <nav class=md-nav aria-label="Go Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_2 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_2 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_2 class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#image-disk-size_2 class=md-nav__link> Image Disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#python-example class=md-nav__link> Python Example </a> <nav class=md-nav aria-label="Python Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_3 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_3 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_3 class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#image-disk-size_3 class=md-nav__link> Image Disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#container-footprint class=md-nav__link> Container footprint </a> </li> <li class=md-nav__item> <a href=#pipeline class=md-nav__link> Pipeline </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../sso-azure-ad/ title="CloudBees SSO Azure AD" class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../kubernetes-sso-keycloak/ title="Kubernetes SSO Keycloak" class=md-nav__link> Kubernetes SSO Keycloak </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-8 type=checkbox id=nav-2-8> <label class=md-nav__link for=nav-2-8> Jenkins X Java Native Image Prod <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins X Java Native Image Prod" data-md-level=2> <label class=md-nav__title for=nav-2-8> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins X Java Native Image Prod </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/01-intro/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/02-cloud-sql/ title="Cloud SQL" class=md-nav__link> Cloud SQL </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/03-quarkus/ title=Quarkus class=md-nav__link> Quarkus </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/04-jx-import/ title="Import Into Jenkins X" class=md-nav__link> Import Into Jenkins X </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/05-jx-secrets/ title="Database Connection And Secrets" class=md-nav__link> Database Connection And Secrets </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/06-native-image/ title="Native Image" class=md-nav__link> Native Image </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/07-pipeline-improvements/ title="Pipeline Improvements" class=md-nav__link> Pipeline Improvements </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/08-preview-int-test/ title="Previews & Integration Tests" class=md-nav__link> Previews & Integration Tests </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/09-production-improvements/ title="Production Improvements" class=md-nav__link> Production Improvements </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-9 type=checkbox id=nav-2-9> <label class=md-nav__link for=nav-2-9> Jenkins Monitoring Kubernetes <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins Monitoring Kubernetes" data-md-level=2> <label class=md-nav__title for=nav-2-9> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/install/ title="Install Tools" class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/alerts/ title=Alerts class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../dockercon-eu-2018/ title="DockerCon EU 2018" class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Jenkins & CloudBees <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins & CloudBees" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins & CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> CloudBees <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=CloudBees data-md-level=2> <label class=md-nav__title for=nav-3-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../cloudbees/teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-gke-helm/ title="CloudBees Core on GKE" class=md-nav__link> CloudBees Core on GKE </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-team-namespace/ title="Team Master Namespace" class=md-nav__link> Team Master Namespace </a> </li> <li class=md-nav__item> <a href=../../cloudbees/multi-cluster/ title=Multi-Cluster class=md-nav__link> Multi-Cluster </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Jenkins <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Jenkins data-md-level=2> <label class=md-nav__title for=nav-3-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Jenkins Pipelines <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins Pipelines" data-md-level=2> <label class=md-nav__title for=nav-3-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline/job-types/ title="Job Types" class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/kaniko-pipelines/ title="Build Docker Image Kaniko" class=md-nav__link> Build Docker Image Kaniko </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/podtemplate-dind/ title="PodTemplate With Docker-In-Docker" class=md-nav__link> PodTemplate With Docker-In-Docker </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/jenkins-parallel-pipeline/ title="Parallel Pipelines" class=md-nav__link> Parallel Pipelines </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/core-concepts/ title="Core Concepts" class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/artifactory-integration/ title="Artifactory Integration" class=md-nav__link> Artifactory Integration </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> Jenkins Pipeline Examples <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins Pipeline Examples" data-md-level=2> <label class=md-nav__title for=nav-3-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Jenkins X <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Jenkins X" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/build-packs/ title="Build Packs" class=md-nav__link> Build Packs </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/jx-pipelines/ title="Jenkins X Pipelines" class=md-nav__link> Jenkins X Pipelines </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> Java Native Image Prod <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Java Native Image Prod" data-md-level=2> <label class=md-nav__title for=nav-4-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Java Native Image Prod </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/01-intro/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/02-cloud-sql/ title="Cloud SQL" class=md-nav__link> Cloud SQL </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/03-quarkus/ title=Quarkus class=md-nav__link> Quarkus </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/04-jx-import/ title="Import Into Jenkins X" class=md-nav__link> Import Into Jenkins X </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/05-jx-secrets/ title="Database Connection And Secrets" class=md-nav__link> Database Connection And Secrets </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/06-native-image/ title="Native Image" class=md-nav__link> Native Image </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/07-pipeline-improvements/ title="Pipeline Improvements" class=md-nav__link> Pipeline Improvements </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/08-preview-int-test/ title="Previews & Integration Tests" class=md-nav__link> Previews & Integration Tests </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/java-native-prod/09-production-improvements/ title="Production Improvements" class=md-nav__link> Production Improvements </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../jenkinsx/builder-image/ title="Create Builder Image" class=md-nav__link> Create Builder Image </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/jxboot/ title="JX Boot GKE" class=md-nav__link> JX Boot GKE </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/jxboot-aks/ title="JX Boot AKS" class=md-nav__link> JX Boot AKS </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/aks-boot-core/ title="JX Boot & CloudBees Core" class=md-nav__link> JX Boot & CloudBees Core </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/rhos-311-minimal/ title="OpenShift 3.11" class=md-nav__link> OpenShift 3.11 </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/rhos-311-restricted/ title="OpenShift 3.11 - Restricted" class=md-nav__link> OpenShift 3.11 - Restricted </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/lighthouse-bitbucket/ title="Lighthouse & Bitbucket" class=md-nav__link> Lighthouse & Bitbucket </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/kubernetes-days/ title="Example For Console Reel" class=md-nav__link> Example For Console Reel </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Containers <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Containers data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> OpenShift <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=OpenShift data-md-level=2> <label class=md-nav__title for=nav-5-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> OpenShift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../openshift/rhos311-gcp-minimal/ title="OpenShift 3.11 GCP(minimal)" class=md-nav__link> OpenShift 3.11 GCP(minimal) </a> </li> <li class=md-nav__item> <a href=../../openshift/rhos311-gcp-medium/ title="OpenShift 3.11 GCP(medium)" class=md-nav__link> OpenShift 3.11 GCP(medium) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> Kubernetes (K8S) <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Kubernetes (K8S)" data-md-level=2> <label class=md-nav__title for=nav-5-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Managed Kubernetes (cloud) <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Managed Kubernetes (cloud)" data-md-level=2> <label class=md-nav__title for=nav-5-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Managed Kubernetes (cloud) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/gke-terraform/ title="GKE Terraform" class=md-nav__link> GKE Terraform </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/eks-eksctl/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aks-cli/ title="AKS CLI" class=md-nav__link> AKS CLI </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aks-terraform/ title="AKS Terraform" class=md-nav__link> AKS Terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-4 type=checkbox id=nav-5-4> <label class=md-nav__link for=nav-5-4> K8S Hard Way - GCE <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="K8S Hard Way - GCE" data-md-level=2> <label class=md-nav__title for=nav-5-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-5 type=checkbox id=nav-5-5> <label class=md-nav__link for=nav-5-5> Docker <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=nav-5-5> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker/graceful-shutdown/ title="Graceful Shutdown" class=md-nav__link> Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../docker/build-kit/ title=BuildKit class=md-nav__link> BuildKit </a> </li> <li class=md-nav__item> <a href=../../docker/multi-stage-builds/ title="Multi-Stage Builds(TBD)" class=md-nav__link> Multi-Stage Builds(TBD) </a> </li> <li class=md-nav__item> <a href=../../docker/swarm/ title="Swarm (mode) (TBD)" class=md-nav__link> Swarm (mode) (TBD) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-6 type=checkbox id=nav-5-6> <label class=md-nav__link for=nav-5-6> Linux <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=nav-5-6> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Software Eng. <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Software Eng." data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Software Eng. </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-1 type=checkbox id=nav-6-1> <label class=md-nav__link for=nav-6-1> Automation <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Automation data-md-level=2> <label class=md-nav__title for=nav-6-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloud/automation-pulumi/ title=Pulumi class=md-nav__link> Pulumi </a> </li> <li class=md-nav__item> <a href=../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Software Engineering <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Software Engineering" data-md-level=2> <label class=md-nav__title for=nav-6-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../swe/important-concepts/ title="Important Concepts" class=md-nav__link> Important Concepts </a> </li> <li class=md-nav__item> <a href=../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../swe/distributed/ title="Distributed Computing" class=md-nav__link> Distributed Computing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-3 type=checkbox id=nav-6-3> <label class=md-nav__link for=nav-6-3> Productivity <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Productivity data-md-level=2> <label class=md-nav__title for=nav-6-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../productivity/incidents/ title=Incidents class=md-nav__link> Incidents </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-4 type=checkbox id=nav-6-4> <label class=md-nav__link for=nav-6-4> Java <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Java data-md-level=2> <label class=md-nav__title for=nav-6-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../keep-watching/ title="Spring Boot App" class=md-nav__link> Spring Boot App </a> </li> <li class=md-nav__item> <a href=../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#ideal-pipeline class=md-nav__link> Ideal Pipeline </a> </li> <li class=md-nav__item> <a href=#kubernetes-pods class=md-nav__link> Kubernetes Pods </a> <nav class=md-nav aria-label="Kubernetes Pods"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#podtemplate-example class=md-nav__link> PodTemplate example </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#java-example class=md-nav__link> Java Example </a> <nav class=md-nav aria-label="Java Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-jdk-image class=md-nav__link> Custom JDK Image </a> <nav class=md-nav aria-label="Custom JDK Image"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile class=md-nav__link> Dockerfile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#image-disk-size class=md-nav__link> Image disk size </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#graal class=md-nav__link> Graal </a> <nav class=md-nav aria-label=Graal> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_1 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_1 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_1 class=md-nav__link> Dockerfile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#image-disk-size_1 class=md-nav__link> Image disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#go-example class=md-nav__link> Go Example </a> <nav class=md-nav aria-label="Go Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_2 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_2 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_2 class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#image-disk-size_2 class=md-nav__link> Image Disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#python-example class=md-nav__link> Python Example </a> <nav class=md-nav aria-label="Python Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#application-model_3 class=md-nav__link> Application Model </a> </li> <li class=md-nav__item> <a href=#build_3 class=md-nav__link> Build </a> <nav class=md-nav aria-label=Build> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dockerfile_3 class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#image-disk-size_3 class=md-nav__link> Image Disk size </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#container-footprint class=md-nav__link> Container footprint </a> </li> <li class=md-nav__item> <a href=#pipeline class=md-nav__link> Pipeline </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/blogs/jenkins-pipeline-support-tool.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=jenkins-pipeline-support-tools>Jenkins Pipeline Support Tools<a class=headerlink href=#jenkins-pipeline-support-tools title="Permanent link">&para;</a></h1> <p>With Jenkins now becoming Cloud Native and a first class citizen of Kubernetes, it is time to review how we use build tools.</p> <p>This content assumes you're using Jenkins in a Kubernetes cluster, but most of it should also work in other Docker-based environments.</p> <h2 id=ideal-pipeline>Ideal Pipeline<a class=headerlink href=#ideal-pipeline title="Permanent link">&para;</a></h2> <p>Anyway, one thing we often see people do wrong with Jenkins pipelines is to use the Groovy Scripts as a general-purpose programming language. This creates many problems, bloated &amp; complicated pipelines, much more stress on the master instead of on the build agent and generally making things unreliable.</p> <p>A much better way is to use Jenkins pipelines only as orchestration and lean heavily on your build tools - e.g., Maven, Gradle, Yarn, Bazel - and shell scripts. Alas, if you created complicated pipelines in Groovy scripts, it is likely you'll end up the same with Bash scripts. An even better solution would be to create custom CLI applications that take care of large operations and convoluted logic. You can test and reuse them.</p> <div class=highlight><pre><span></span><code><span class=n>pipeline</span> <span class=o>{</span>
    <span class=n>agent</span> <span class=n>any</span>
    <span class=n>stages</span> <span class=o>{</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Build&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>sh</span> <span class=s1>&#39;./build.sh&#39;</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Test&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>sh</span> <span class=s1>&#39;./test.sh&#39;</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Deploy&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>sh</span> <span class=s1>&#39;./deploy.sh&#39;</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
    <span class=n>post</span>  <span class=o>{</span>
        <span class=n>success</span> <span class=o>{</span>
            <span class=n>sh</span> <span class=s1>&#39;./successNotification.sh&#39;</span>
        <span class=o>}</span>
        <span class=n>failure</span> <span class=o>{</span>
          <span class=n>sh</span> <span class=s1>&#39;./failureNotification.sh&#39;</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div> <p>Now, this might look a bit like a pipe dream, but it illustrates how you should use Jenkins Pipeline. The groovy script engine allows for a lot of freedom, but only rarely is its use justified. To create robust, modular and generic pipelines, it is recommended to use build tools, shell scripts, <a href=https://jenkins.io/doc/book/pipeline/shared-libraries/ >Shared Libraries</a> and <strong>custom CLI's</strong>.</p> <p>It was always a bit difficult to manage generic scripts and tools across instances of Jenkins, pipelines, and teams. But with Pod Templates we have an excellent mechanism for using, versioning and distributing them with ease.</p> <h2 id=kubernetes-pods>Kubernetes Pods<a class=headerlink href=#kubernetes-pods title="Permanent link">&para;</a></h2> <p>When Jenkins runs in Kubernetes, it can leverage it via the <a href=https://github.com/jenkinsci/kubernetes-plugin>Kubernetes Plugin</a>. I realize Jenkins conjures up mixed emotions when it comes to plugins, but this setup might replace most of them.</p> <p>How so? By using a <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod/ >Kubernetes Pod</a> as the agent where instead of putting all your tools into a single VM you can use multiple small scoped containers.</p> <p>You can specify Pod Templates in multiple ways, where my personal favorite is to define it as yaml inside a <strong>declarative pipeline</strong> - see example below. For each tool you need, you specify the container and its configuration - if required. By default, you will always get a container with a <a href=https://hub.docker.com/r/jenkinsci/jnlp-slave/ >Jenkins JNLP client</a> and the workspace mounted as a volume in the pod.</p> <p>This allows you to create several tiny containers, each containing only the tools you need for a specific job. Now, it could happen you use two or more tools together a lot - let's say npm and maven - so it is ok to sometimes deviate from this to lower the overall memory of the pod.</p> <p>When you need custom logic, you will have to create a script or tool. This is where PodTemplate, Docker images and our desire for small narrow focus tools come together.</p> <h3 id=podtemplate-example>PodTemplate example<a class=headerlink href=#podtemplate-example title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=n>pipeline</span> <span class=o>{</span>
    <span class=n>agent</span> <span class=o>{</span>
        <span class=n>kubernetes</span> <span class=o>{</span>
        <span class=n>label</span> <span class=s1>&#39;mypod&#39;</span>
        <span class=n>defaultContainer</span> <span class=s1>&#39;jnlp&#39;</span>
        <span class=n>yaml</span> <span class=s2>&quot;&quot;&quot;</span>
<span class=s2>apiVersion: v1</span>
<span class=s2>kind: Pod</span>
<span class=s2>metadata:</span>
<span class=s2>  labels:</span>
<span class=s2>    some-label: some-label-value</span>
<span class=s2>spec:</span>
<span class=s2>  containers:</span>
<span class=s2>  - name: maven</span>
<span class=s2>    image: maven:alpine</span>
<span class=s2>    command:</span>
<span class=s2>    - cat</span>
<span class=s2>    tty: true</span>
<span class=s2>  - name: busybox</span>
<span class=s2>    image: busybox</span>
<span class=s2>    command:</span>
<span class=s2>    - cat</span>
<span class=s2>    tty: true</span>
<span class=s2>        &quot;&quot;&quot;</span>
        <span class=o>}</span>
    <span class=o>}</span>
    <span class=n>stages</span> <span class=o>{</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Run maven&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;maven&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>sh</span> <span class=s1>&#39;mvn -version&#39;</span>
                <span class=o>}</span>
                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;busybox&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>sh</span> <span class=s1>&#39;/bin/busybox&#39;</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div> <h2 id=java-example>Java Example<a class=headerlink href=#java-example title="Permanent link">&para;</a></h2> <p>I bet most people do not think about Java when it comes lightweight CLI applications, but I think that is a shame. Java has excellent tooling to help you build well-tested applications which can be understood and maintained by a vast majority of developers.</p> <p>To make the images small, we will use some of the new tools available in Java land. We will first dive into using Java Modularity and JLink to create a compact and strict binary package, and then we move onto Graal for creating a Native image.</p> <h3 id=custom-jdk-image>Custom JDK Image<a class=headerlink href=#custom-jdk-image title="Permanent link">&para;</a></h3> <p>All the source code of this example application is at <a href=https://github.com/joostvdg/jpb>github.com/joostvdg/jpb</a>.</p> <p>It is a small CLI which does only one thing; it parses a git commit log to see which folders changed. Quite a useful tool for Monorepo's or other repositories containing more than one changeable resource.</p> <p>Such a CLI should have specific characteristics: * testable * small memory footprint * small disk footprint * quick start * easy to setup * easy to maintain</p> <p>These points sound like an excellent use case for Java Modules and JLink. For those who don't know, <a href=https://www.baeldung.com/java-9-modularity>read up on Java Modules here</a> and <a href=https://dzone.com/articles/jlink-in-java-9>read up on JLink here</a>. JLink will create a binary image that we can use with Alpine Linux to form a minimal Java (Docker) Image.</p> <p>Unfortunately, the plugins for Maven (JMod and JLink) seem to have died. The support on Gradle side is not much better.</p> <p>So I created a solution myself with a multi-stage Docker build. Which does detract a bit from the ease of setup. But overall, it hits the other characteristics spot on. </p> <h4 id=application-model>Application Model<a class=headerlink href=#application-model title="Permanent link">&para;</a></h4> <p>For ease of maintenance and testing, we separate the parts of the CLI into Java Modules, as you can see in the model below. For using JLink, we need to be a module ourselves. So I figured to expand the exercise to use it to not only create boundaries via packages but also with Modules.</p> <p><img alt=Model src=../../images/jpb.png></p> <h4 id=build>Build<a class=headerlink href=#build title="Permanent link">&para;</a></h4> <p>The current LTS version of Java is 11, which means we need at least that if we want to be up-to-date. As we want to run the application in Alpine Linux, we need to build it with Alpine Linux - if you create a custom JDK image its OS specific. To my surprise, the official LTS release is not released for Alpine, so we use OpenJDK 12.</p> <p>Everything is built via a Multi-Stage Docker Build. This Dockerfile can be divided into five segments.</p> <ol> <li>creation of the base with a JDK 11+ on Alpine Linux</li> <li>compiling our Java Modules in into Module Jars</li> <li>test our code</li> <li>create our custom JDK image with just our code and whatever we need from the JDK</li> <li>create the runtime Docker image</li> </ol> <p>The Dockerfile looks a bit complicated, but we did get a Java runtime that is about 44MB in size and can run as a direct binary with no startup time. The Dockerfile can be much short if we use only a single module, but as our logic grows it is a thoughtful way to separate different concerns.</p> <p>Still, I'm not too happy with this for creating many small CLI's. To much handwork goes into creating the images like this. Relying on unmaintained Maven or Gradle Plugins doesn't seem a better choice.</p> <p>Luckily, there's a new game in town, <a href=https://github.com/oracle/graal>GraalVM</a>. We'll make an image with Graal next, stay tuned.</p> <h5 id=dockerfile>Dockerfile<a class=headerlink href=#dockerfile title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><span class=c>###############################################################</span>
<span class=c>###############################################################</span>
<span class=c>##### 1. CREATE ALPINE BASE WITH JDK11+</span>
<span class=c>#### OpenJDK image produces weird results with JLink (400mb + sizes)</span>
<span class=k>FROM</span> <span class=s>alpine:3.8</span> <span class=k>AS</span> <span class=s>build</span>
<span class=k>ENV</span> <span class=nv>JAVA_HOME</span><span class=o>=</span>/opt/jdk <span class=se>\</span>
    <span class=nv>PATH</span><span class=o>=</span><span class=si>${</span><span class=nv>PATH</span><span class=si>}</span>:/opt/jdk/bin <span class=se>\</span>
    <span class=nv>LANG</span><span class=o>=</span>C.UTF-8

<span class=k>RUN</span> <span class=nb>set</span> -ex <span class=o>&amp;&amp;</span> <span class=se>\</span>
    apk add --no-cache bash <span class=o>&amp;&amp;</span> <span class=se>\</span>
    wget https://download.java.net/java/early_access/alpine/18/binaries/openjdk-12-ea+18_linux-x64-musl_bin.tar.gz -O jdk.tar.gz <span class=o>&amp;&amp;</span> <span class=se>\</span>
    mkdir -p /opt/jdk <span class=o>&amp;&amp;</span> <span class=se>\</span>
    tar zxvf jdk.tar.gz -C /opt/jdk --strip-components<span class=o>=</span><span class=m>1</span> <span class=o>&amp;&amp;</span> <span class=se>\</span>
    rm jdk.tar.gz <span class=o>&amp;&amp;</span> <span class=se>\</span>
    rm /opt/jdk/lib/src.zip
<span class=c>####################################</span>
<span class=c>## 2.a PREPARE COMPILE PHASE</span>
<span class=k>RUN</span> mkdir -p /usr/src/mods/jars
<span class=k>RUN</span> mkdir -p /usr/src/mods/compiled
<span class=k>COPY</span> . /usr/src
<span class=k>WORKDIR</span><span class=s> /usr/src</span>

<span class=c>## 2.b COMPILE ALL JAVA FILES</span>
<span class=k>RUN</span> javac -Xlint:unchecked -d /usr/src/mods/compiled --module-source-path /usr/src/src <span class=k>$(</span>find src -name <span class=s2>&quot;*.java&quot;</span><span class=k>)</span>
<span class=c>## 2.c CREATE ALL JAVA MODULE JARS</span>
<span class=k>RUN</span> jar --create --file /usr/src/mods/jars/joostvdg.jpb.api.jar --module-version <span class=m>1</span>.0 -C /usr/src/mods/compiled/joostvdg.jpb.api .
<span class=k>RUN</span> jar --create --file /usr/src/mods/jars/joostvdg.jpb.core.jar --module-version <span class=m>1</span>.0 -C /usr/src/mods/compiled/joostvdg.jpb.core .
<span class=k>RUN</span> jar --create --file /usr/src/mods/jars/joostvdg.jpb.cli.jar --module-version <span class=m>1</span>.0  -e com.github.joostvdg.jpb.cli.JpbApp<span class=se>\</span>
    -C /usr/src/mods/compiled/joostvdg.jpb.cli .
<span class=k>RUN</span> jar --create --file /usr/src/mods/jars/joostvdg.jpb.core.test.jar --module-version <span class=m>1</span>.0  -e com.github.joostvdg.jpb.core.test.ParseChangeListTest <span class=se>\</span>
    -C /usr/src/mods/compiled/joostvdg.jpb.core.test .
<span class=c>####################################</span>
<span class=c>## 3 RUN TESTS</span>
<span class=k>RUN</span> rm -rf /usr/bin/jpb-test-image
<span class=k>RUN</span> jlink <span class=se>\</span>
    --verbose <span class=se>\</span>
    --compress <span class=m>2</span> <span class=se>\</span>
    --no-header-files <span class=se>\</span>
    --no-man-pages <span class=se>\</span>
    --strip-debug <span class=se>\</span>
    --limit-modules java.base <span class=se>\</span>
    --launcher jpb-test<span class=o>=</span>joostvdg.jpb.core.test <span class=se>\</span>
    --module-path /usr/src/mods/jars/:<span class=nv>$JAVA_HOME</span>/jmods <span class=se>\</span>
    --add-modules joostvdg.jpb.core.test <span class=se>\</span>
    --add-modules joostvdg.jpb.core <span class=se>\</span>
    --add-modules joostvdg.jpb.api <span class=se>\</span>
     --output /usr/bin/jpb-test-image
<span class=k>RUN</span> /usr/bin/jpb-test-image/bin/java --list-modules
<span class=k>RUN</span> /usr/bin/jpb-test-image/bin/jpb-test
<span class=c>####################################</span>
<span class=c>## 4 BUILD RUNTIME - CUSTOM JDK IMAGE</span>
<span class=k>RUN</span> rm -rf /usr/bin/jpb-image
<span class=k>RUN</span> jlink <span class=se>\</span>
    --verbose <span class=se>\</span>
    --compress <span class=m>2</span> <span class=se>\</span>
    --no-header-files <span class=se>\</span>
    --no-man-pages <span class=se>\</span>
    --strip-debug <span class=se>\</span>
    --limit-modules java.base <span class=se>\</span>
    --launcher <span class=nv>jpb</span><span class=o>=</span>joostvdg.jpb.cli <span class=se>\</span>
    --module-path /usr/src/mods/jars/:<span class=nv>$JAVA_HOME</span>/jmods <span class=se>\</span>
    --add-modules joostvdg.jpb.cli <span class=se>\</span>
    --add-modules joostvdg.jpb.api <span class=se>\</span>
    --add-modules joostvdg.jpb.core <span class=se>\</span>
     --output /usr/bin/jpb-image
<span class=k>RUN</span> /usr/bin/jpb-image/bin/java --list-modules
<span class=c>####################################</span>
<span class=c>##### 5. RUNTIME IMAGE - ALPINE</span>
<span class=k>FROM</span> <span class=s>panga/alpine:3.8-glibc2.27</span>
<span class=k>LABEL</span> <span class=nv>authors</span><span class=o>=</span><span class=s2>&quot;Joost van der Griendt &lt;joostvdg@gmail.com&gt;&quot;</span>
<span class=k>LABEL</span> <span class=nv>version</span><span class=o>=</span><span class=s2>&quot;0.1.0&quot;</span>
<span class=k>LABEL</span> <span class=nv>description</span><span class=o>=</span><span class=s2>&quot;Docker image for running Jenkins Pipeline Binary&quot;</span>
<span class=k>ENV</span> <span class=nv>DATE_CHANGED</span><span class=o>=</span><span class=s2>&quot;20181014-2035&quot;</span>
<span class=k>ENV</span> <span class=nv>JAVA_OPTS</span><span class=o>=</span><span class=s2>&quot;-XX:+UseCGroupMemoryLimitForHeap -XX:+UnlockExperimentalVMOptions&quot;</span>
<span class=k>COPY</span> --from<span class=o>=</span>build /usr/bin/jpb-image/ /usr/bin/jpb
<span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&quot;/usr/bin/jpb/bin/jpb&quot;</span><span class=p>]</span>
</code></pre></div> <h4 id=image-disk-size>Image disk size<a class=headerlink href=#image-disk-size title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>REPOSITORY                                   TAG                 IMAGE ID            CREATED              SIZE
jpb                                          latest              af7dda45732a        About a minute ago   <span class=m>43</span>.8MB
</code></pre></div> <h3 id=graal>Graal<a class=headerlink href=#graal title="Permanent link">&para;</a></h3> <blockquote> <p>GraalVM is a universal virtual machine for running applications written in JavaScript, Python, Ruby, R, JVM-based languages like Java, Scala, Kotlin, Clojure, and LLVM-based languages such as C and C++. - <a href=https://www.graalvm.org>graalvm.org</a></p> </blockquote> <p>Ok, that doesn't tell you why using GraalVM is excellent for creating small CLI docker images. Maybe this quote helps:</p> <blockquote> <p>Native images compiled with GraalVM ahead-of-time improve the startup time and reduce the memory footprint of JVM-based applications. </p> </blockquote> <p>Where JLink allows you to create a custom JDK image and embed your application as a runtime binary, Graal goes one step further. It replaces the VM altogether and uses <a href=https://github.com/oracle/graal/tree/master/substratevm>Substrate VM</a> to run your binary. It can't do a lot of the fantastic things the JVM can do and isn't suited for long running applications or those with a large memory footprint and so on. Well, our CLI applications are single shot executions with low memory footprint, the perfect fit for Graal/Substrate!</p> <p>All the code from this example can is on GitHub at <a href=https://github.com/demomon/jpc-graal--maven>github.com/demomon/jpc-graal--maven</a>.</p> <h4 id=application-model_1>Application Model<a class=headerlink href=#application-model_1 title="Permanent link">&para;</a></h4> <p>While building modular Java applications is excellent, the current tooling support terrible. So this time the application is a single Jar - Graal can create images from classes or jars - where packages do the separation.</p> <div class=highlight><pre><span></span><code>.
 Dockerfile
 LICENSE
 README.md
 docker-graal-build.sh
 pom.xml
 src
     main
      java
          com
              github
                  joostvdg
                      demo
                          App.java
                          Hello.java
</code></pre></div> <h4 id=build_1>Build<a class=headerlink href=#build_1 title="Permanent link">&para;</a></h4> <p>Graal can build a native image based on a Jar file. This allows us to use any standard Java build tool such as Maven or Gradle to build the jar. The actual Graal build will be done in a Dockerfile.</p> <p>The people over at Oracle have created an <a href=https://hub.docker.com/r/oracle/graalvm-ce/ >official Docker image</a> reducing effort spend on our side.</p> <p>The Dockerfile has three segments:</p> <ul> <li>build the jar with Maven</li> <li>build the native image with Graal</li> <li>assembly the runtime Docker image based on Alpine</li> </ul> <p>As you can see below, the Graal image is only half the size of the JLink image! Let's see how that stacks up to other languages such as Go and Python.</p> <h5 id=dockerfile_1>Dockerfile<a class=headerlink href=#dockerfile_1 title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><span class=c>#######################################</span>
<span class=c>## 1. BUILD JAR WITH MAVEN</span>
<span class=k>FROM</span> <span class=s>maven:3.6-jdk-8</span> <span class=k>as</span> <span class=s>BUILD</span>
<span class=k>WORKDIR</span><span class=s> /usr/src</span>
<span class=k>COPY</span> . /usr/src
<span class=k>RUN</span> mvn clean package -e
<span class=c>#######################################</span>
<span class=c>## 2. BUILD NATIVE IMAGE WITH GRAAL</span>
<span class=k>FROM</span> <span class=s>oracle/graalvm-ce:1.0.0-rc9</span> <span class=k>as</span> <span class=s>NATIVE_BUILD</span>
<span class=k>WORKDIR</span><span class=s> /usr/src</span>
<span class=k>COPY</span> --from<span class=o>=</span>BUILD /usr/src/ /usr/src
<span class=k>RUN</span> ls -lath /usr/src/target/
<span class=k>COPY</span> /docker-graal-build.sh /usr/src
<span class=k>RUN</span> ./docker-graal-build.sh
<span class=k>RUN</span> ls -lath
<span class=c>#######################################</span>
<span class=c>## 3. BUILD DOCKER RUNTIME IMAGE</span>
<span class=k>FROM</span> <span class=s>alpine:3.8</span>
<span class=k>CMD</span> <span class=p>[</span><span class=s2>&quot;jpc-graal&quot;</span><span class=p>]</span>
<span class=k>COPY</span> --from<span class=o>=</span>NATIVE_BUILD /usr/src/jpc-graal /usr/local/bin/
<span class=k>RUN</span> chmod +x /usr/local/bin/jpc-graal
<span class=c>#######################################</span>
</code></pre></div> <h4 id=image-disk-size_1>Image disk size<a class=headerlink href=#image-disk-size_1 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>REPOSITORY                                   TAG                 IMAGE ID            CREATED             SIZE
jpc-graal-maven                              latest              dc33ebb10813        About an hour ago   <span class=m>19</span>.6MB
</code></pre></div> <h2 id=go-example>Go Example<a class=headerlink href=#go-example title="Permanent link">&para;</a></h2> <h3 id=application-model_2>Application Model<a class=headerlink href=#application-model_2 title="Permanent link">&para;</a></h3> <h3 id=build_2>Build<a class=headerlink href=#build_2 title="Permanent link">&para;</a></h3> <h4 id=dockerfile_2>Dockerfile<a class=headerlink href=#dockerfile_2 title="Permanent link">&para;</a></h4> <h4 id=image-disk-size_2>Image Disk size<a class=headerlink href=#image-disk-size_2 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>REPOSITORY                                   TAG                 IMAGE ID            CREATED             SIZE
jpc-go                                       latest              bb4a8e546601        <span class=m>6</span> minutes ago       <span class=m>12</span>.3MB
</code></pre></div> <h2 id=python-example>Python Example<a class=headerlink href=#python-example title="Permanent link">&para;</a></h2> <h3 id=application-model_3>Application Model<a class=headerlink href=#application-model_3 title="Permanent link">&para;</a></h3> <h3 id=build_3>Build<a class=headerlink href=#build_3 title="Permanent link">&para;</a></h3> <h4 id=dockerfile_3>Dockerfile<a class=headerlink href=#dockerfile_3 title="Permanent link">&para;</a></h4> <h4 id=image-disk-size_3>Image Disk size<a class=headerlink href=#image-disk-size_3 title="Permanent link">&para;</a></h4> <h2 id=container-footprint>Container footprint<a class=headerlink href=#container-footprint title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code>kubectl top pods mypod-s4wpb-7dz4q --containers
POD                 NAME         CPU<span class=o>(</span>cores<span class=o>)</span>   MEMORY<span class=o>(</span>bytes<span class=o>)</span>
mypod-7lxnk-gw1sj   jpc-go       0m           0Mi
mypod-7lxnk-gw1sj   java-jlink   0m           0Mi
mypod-7lxnk-gw1sj   java-graal   0m           0Mi
mypod-7lxnk-gw1sj   jnlp         150m         96Mi
</code></pre></div> <p>So, the 0Mi memory seems wrong. So I decided to dive into the Google Cloud Console, to see if there's any information in there. What I found there, is the data you can see below. The memory is indeed 0Mi, as they're using between 329 and 815 Kilobytes and not hitting the MB threshold (and thus get listed as 0Mi).</p> <p>We do see that graal uses more CPU and slightly less memory than the JLink setup. Both are still significantly larger than the Go CLI tool, but as long as the JNLP container takes ~100MB, I don't think we should worry about 400-500KB.</p> <div class=highlight><pre><span></span><code>CPU 
container/cpu/usage_time:gke_container:REDUCE_SUM<span class=o>(</span>, ps-dev-201405<span class=o>)</span>: <span class=m>0</span>.24
 java-graal: 5e-4
 java-jlink: 3e-3
 jnlp: <span class=m>0</span>.23
 jpc-go: 2e-4
Memory 
 java-graal: <span class=m>729</span>,088.00
 java-jlink: <span class=m>815</span>,104.00
 jnlp: <span class=m>101</span>.507M
 jpc-go: <span class=m>327</span>,680.00
Disk 
 java-graal: <span class=m>49</span>,152.00
 java-jlink: <span class=m>49</span>,152.00
 jnlp: <span class=m>94</span>,208.00
 jpc-go: <span class=m>49</span>,152.00
</code></pre></div> <h2 id=pipeline>Pipeline<a class=headerlink href=#pipeline title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><span class=n>pipeline</span> <span class=o>{</span>
    <span class=n>agent</span> <span class=o>{</span>
        <span class=n>kubernetes</span> <span class=o>{</span>
        <span class=n>label</span> <span class=s1>&#39;mypod&#39;</span>
        <span class=n>defaultContainer</span> <span class=s1>&#39;jnlp&#39;</span>
        <span class=n>yaml</span> <span class=s2>&quot;&quot;&quot;</span>
<span class=s2>apiVersion: v1</span>
<span class=s2>kind: Pod</span>
<span class=s2>metadata:</span>
<span class=s2>  labels:</span>
<span class=s2>    some-label: some-label-value</span>
<span class=s2>spec:</span>
<span class=s2>  containers:</span>
<span class=s2>  - name: java-graal</span>
<span class=s2>    image: caladreas/jpc-graal:0.1.0-maven-b1</span>
<span class=s2>    command:</span>
<span class=s2>    - cat</span>
<span class=s2>    tty: true</span>
<span class=s2>  - name: java-jlink</span>
<span class=s2>    image: caladreas/jpc-jlink:0.1.0-b1</span>
<span class=s2>    command:</span>
<span class=s2>    - cat</span>
<span class=s2>    tty: true</span>
<span class=s2>  - name: jpc-go</span>
<span class=s2>    image: caladreas/jpc-go:0.1.0-b1</span>
<span class=s2>    command:</span>
<span class=s2>    - cat</span>
<span class=s2>    tty: true</span>
<span class=s2>        &quot;&quot;&quot;</span>
        <span class=o>}</span>
    <span class=o>}</span>
    <span class=n>stages</span> <span class=o>{</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Test Versions&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;java-graal&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>echo</span> <span class=s2>&quot;java-graal&quot;</span>
                    <span class=n>sh</span> <span class=s1>&#39;/usr/local/bin/jpc-graal&#39;</span>
                    <span class=n>sleep</span> <span class=mi>5</span>
                <span class=o>}</span>

                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;java-jlink&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>echo</span> <span class=s2>&quot;java-jlink&quot;</span>
                    <span class=n>sh</span> <span class=s1>&#39;/usr/bin/jpb/bin/jpb GitChangeListToFolder abc abc&#39;</span>
                    <span class=n>sleep</span> <span class=mi>5</span>
                <span class=o>}</span>

                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;jpc-go&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>sh</span> <span class=s1>&#39;jpc-go sayHello -n joost&#39;</span>
                    <span class=n>sleep</span> <span class=mi>5</span>
                <span class=o>}</span>
                <span class=n>sleep</span> <span class=mi>60</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div> <hr> <div class=md-source-date> <small> Last update: 2019-08-31 13:12:00 </small> </div> <h2 id=__comments>Comments</h2> <div id=disqus_thread></div> <script>var disqus_config=function(){this.page.url="https://joostvdg.github.io/blogs/jenkins-pipeline-support-tool/",this.page.identifier="/blogs/jenkins-pipeline-support-tool/"};!function(){var e=document,i=e.createElement("script");i.src="//joostvdg-github-io.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(i)}()</script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../../other/shell/ title=Shell class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Shell </div> </div> </a> <a href=../graceful-shutdown/ title="Docker Graceful Shutdown" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Docker Graceful Shutdown </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Joost van der Griendt </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/joostvdg target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/joost_vdg target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://linkedin.com/in/joostvdg target=_blank rel=noopener title=linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.22b62ea4.min.js></script> <script src=../../assets/javascripts/bundle.5f27aba8.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: ["tabs", "instant"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.f6ebf1dc.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>