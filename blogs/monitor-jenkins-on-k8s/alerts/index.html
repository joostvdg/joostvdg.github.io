<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link href=https://joostvdg.github.io/blogs/monitor-jenkins-on-k8s/alerts/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.0"><title>Alerts - J's Software Development Pages</title><link rel=stylesheet href=../../../assets/stylesheets/application.0284f74d.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.01803549.css><meta name=theme-color content=#fb8c00><script src=../../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-145385967-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=red> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#alerts tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-header-nav__button md-logo"> <i class=md-icon>public</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> J's Software Development Pages </span> <span class=md-header-nav__topic> Alerts </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. title=Home class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../docker-graceful-shutdown/ title=Blogs class="md-tabs__link md-tabs__link--active"> Blogs </a> </li> <li class=md-tabs__item> <a href=../../../cloudbees/sso-azure-ad/ title=CICD class=md-tabs__link> CICD </a> </li> <li class=md-tabs__item> <a href=../../../kubernetes/ title=Containers class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../../certificates/lets-encrypt-k8s/ title=SWE class=md-tabs__link> SWE </a> </li> <li class=md-tabs__item> <a href=../../../java/ title=Java class=md-tabs__link> Java </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-nav__button md-logo"> <i class=md-icon>public</i> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=Me class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../../other/mkdocs/ title="MKDocs (This Static Website)" class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../../other/shell/ title=Shell class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Blogs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker-graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/sso-azure-ad/ title="CloudBees SSO Azure AD" class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-support-tool/ title="Jenkins Pipeline Support Tools" class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-7 type=checkbox id=nav-2-7 checked> <label class=md-nav__link for=nav-2-7> Jenkins Monitoring Kubernetes </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-7> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../install/ title="Install Tools" class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Alerts </label> <a href=./ title=Alerts class="md-nav__link md-nav__link--active"> Alerts </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#potential-alerts title="Potential Alerts" class=md-nav__link> Potential Alerts </a> </li> <li class=md-nav__item> <a href=#alert-manager-configuration title="Alert Manager Configuration" class=md-nav__link> Alert Manager Configuration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-slack-endpoint title="Get Slack Endpoint" class=md-nav__link> Get Slack Endpoint </a> </li> <li class=md-nav__item> <a href=#base-configuration title="Base Configuration" class=md-nav__link> Base Configuration </a> </li> <li class=md-nav__item> <a href=#group-alerts title="Group Alerts" class=md-nav__link> Group Alerts </a> </li> <li class=md-nav__item> <a href=#too-many-jobs-queued title="Too Many Jobs Queued" class=md-nav__link> Too Many Jobs Queued </a> </li> <li class=md-nav__item> <a href=#jobs-stuck-in-queue title="Jobs Stuck In Queue" class=md-nav__link> Jobs Stuck In Queue </a> </li> <li class=md-nav__item> <a href=#jobs-waiting-too-long-to-start title="Jobs Waiting Too Long To Start" class=md-nav__link> Jobs Waiting Too Long To Start </a> </li> <li class=md-nav__item> <a href=#health-score-1 title="health score < 1" class=md-nav__link> health score &lt; 1 </a> </li> <li class=md-nav__item> <a href=#ingress-too-slow title="Ingress Too Slow" class=md-nav__link> Ingress Too Slow </a> </li> <li class=md-nav__item> <a href=#http-requests-too-slow title="Http Requests Too Slow" class=md-nav__link> Http Requests Too Slow </a> </li> <li class=md-nav__item> <a href=#too-many-plugin-updates title="Too Many Plugin Updates" class=md-nav__link> Too Many Plugin Updates </a> </li> <li class=md-nav__item> <a href=#file-descriptor-ratio-40 title="File Descriptor Ratio > 40%" class=md-nav__link> File Descriptor Ratio &gt; 40% </a> </li> <li class=md-nav__item> <a href=#job-success-ratio-50 title="Job Success Ratio < 50%" class=md-nav__link> Job Success Ratio &lt; 50% </a> </li> <li class=md-nav__item> <a href=#job-wait-duration title="Job Wait Duration" class=md-nav__link> Job Wait Duration </a> </li> <li class=md-nav__item> <a href=#offline-nodes-5-over-10-minutes title="Offline nodes > 5 over 10 minutes" class=md-nav__link> Offline nodes &gt; 5 over 10 minutes </a> </li> <li class=md-nav__item> <a href=#healtcheck-duration-0002 title="healtcheck duration > 0.002" class=md-nav__link> healtcheck duration &gt; 0.002 </a> </li> <li class=md-nav__item> <a href=#plugin-updates-available-10 title="plugin updates available > 10" class=md-nav__link> plugin updates available &gt; 10 </a> </li> <li class=md-nav__item> <a href=#gcp-throughput-too-low title="GCP ThroughPut Too Low" class=md-nav__link> GCP ThroughPut Too Low </a> </li> <li class=md-nav__item> <a href=#vm-heap-usage-ratio-70 title="vm heap usage ratio > 70%" class=md-nav__link> vm heap usage ratio &gt; 70% </a> </li> <li class=md-nav__item> <a href=#uptime-2 title="Uptime < 2" class=md-nav__link> Uptime &lt; 2 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#full-example title="Full Example" class=md-nav__link> Full Example </a> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../../dockercon-eu-2018/ title="DockerCon EU 2018" class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> CloudBees </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-gke-helm/ title="CloudBees Core on GKE" class=md-nav__link> CloudBees Core on GKE </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-post-install-tips/ title="CloudBees Core Post Install" class=md-nav__link> CloudBees Core Post Install </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Jenkins X </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkinsx/intro/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/workshop/ title=Workshop class=md-nav__link> Workshop </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/buildpack/ title=BuildPack class=md-nav__link> BuildPack </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Jenkins </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> Jenkins Pipelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-4> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline/job-types/ title="Job Types" class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/core-concepts/ title="Core Concepts" class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/jenkins-parallel-pipeline/ title=Parallel class=md-nav__link> Parallel </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Jenkins Pipeline Examples </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-5> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/maven-shared-library/ title="Maven Shared Library" class=md-nav__link> Maven Shared Library </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Containers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1> <label class=md-nav__link for=nav-4-1> Kubernetes (K8S) </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class=md-nav__link for=nav-4-2> K8S CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-2> K8S CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/cicd/cdp-jenkins-helm/ title="CD Pipeline Jenkins & Helm" class=md-nav__link> CD Pipeline Jenkins & Helm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> K8S Public Services </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> K8S Public Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/eks-eksctl/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-cli/ title="AKS CLI" class=md-nav__link> AKS CLI </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-terraform/ title="AKS Terraform" class=md-nav__link> AKS Terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class=md-nav__link for=nav-4-4> K8S Hard Way - GCE </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-4> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> Docker </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-5> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docker/multi-stage-builds/ title="Multi-Stage Builds(TBD)" class=md-nav__link> Multi-Stage Builds(TBD) </a> </li> <li class=md-nav__item> <a href=../../../docker/swarm/ title="Swarm (mode) (TBD)" class=md-nav__link> Swarm (mode) (TBD) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-6 type=checkbox id=nav-4-6> <label class=md-nav__link for=nav-4-6> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-6> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> SWE </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> SWE </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> Other </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-1> Other </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> Software Engineering </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../../swe/ddd/ title="Domain Driven Design" class=md-nav__link> Domain Driven Design </a> </li> <li class=md-nav__item> <a href=../../../swe/microservices/ title=Microservices class=md-nav__link> Microservices </a> </li> <li class=md-nav__item> <a href=../../../swe/algorithms/ title=Algorithms class=md-nav__link> Algorithms </a> </li> <li class=md-nav__item> <a href=../../../swe/observability/ title=Observability class=md-nav__link> Observability </a> </li> <li class=md-nav__item> <a href=../../../swe/others/ title=Others class=md-nav__link> Others </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Productivity </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../productivity/tools/ title=Tools class=md-nav__link> Tools </a> </li> <li class=md-nav__item> <a href=../../../productivity/intellij/ title="Intelli J" class=md-nav__link> Intelli J </a> </li> <li class=md-nav__item> <a href=../../../productivity/paradigms/ title=Paradigms class=md-nav__link> Paradigms </a> </li> <li class=md-nav__item> <a href=../../../productivity/studies/ title=Studies class=md-nav__link> Studies </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../java/spring/boot/ title="Spring Boot" class=md-nav__link> Spring Boot </a> </li> <li class=md-nav__item> <a href=../../../java/java9/ title="Java 9" class=md-nav__link> Java 9 </a> </li> <li class=md-nav__item> <a href=../../../java/ecosystem/ title="Java Ecosystem" class=md-nav__link> Java Ecosystem </a> </li> <li class=md-nav__item> <a href=../../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../../java/streams/ title="Java Streams" class=md-nav__link> Java Streams </a> </li> <li class=md-nav__item> <a href=../../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#potential-alerts title="Potential Alerts" class=md-nav__link> Potential Alerts </a> </li> <li class=md-nav__item> <a href=#alert-manager-configuration title="Alert Manager Configuration" class=md-nav__link> Alert Manager Configuration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-slack-endpoint title="Get Slack Endpoint" class=md-nav__link> Get Slack Endpoint </a> </li> <li class=md-nav__item> <a href=#base-configuration title="Base Configuration" class=md-nav__link> Base Configuration </a> </li> <li class=md-nav__item> <a href=#group-alerts title="Group Alerts" class=md-nav__link> Group Alerts </a> </li> <li class=md-nav__item> <a href=#too-many-jobs-queued title="Too Many Jobs Queued" class=md-nav__link> Too Many Jobs Queued </a> </li> <li class=md-nav__item> <a href=#jobs-stuck-in-queue title="Jobs Stuck In Queue" class=md-nav__link> Jobs Stuck In Queue </a> </li> <li class=md-nav__item> <a href=#jobs-waiting-too-long-to-start title="Jobs Waiting Too Long To Start" class=md-nav__link> Jobs Waiting Too Long To Start </a> </li> <li class=md-nav__item> <a href=#health-score-1 title="health score < 1" class=md-nav__link> health score &lt; 1 </a> </li> <li class=md-nav__item> <a href=#ingress-too-slow title="Ingress Too Slow" class=md-nav__link> Ingress Too Slow </a> </li> <li class=md-nav__item> <a href=#http-requests-too-slow title="Http Requests Too Slow" class=md-nav__link> Http Requests Too Slow </a> </li> <li class=md-nav__item> <a href=#too-many-plugin-updates title="Too Many Plugin Updates" class=md-nav__link> Too Many Plugin Updates </a> </li> <li class=md-nav__item> <a href=#file-descriptor-ratio-40 title="File Descriptor Ratio > 40%" class=md-nav__link> File Descriptor Ratio &gt; 40% </a> </li> <li class=md-nav__item> <a href=#job-success-ratio-50 title="Job Success Ratio < 50%" class=md-nav__link> Job Success Ratio &lt; 50% </a> </li> <li class=md-nav__item> <a href=#job-wait-duration title="Job Wait Duration" class=md-nav__link> Job Wait Duration </a> </li> <li class=md-nav__item> <a href=#offline-nodes-5-over-10-minutes title="Offline nodes > 5 over 10 minutes" class=md-nav__link> Offline nodes &gt; 5 over 10 minutes </a> </li> <li class=md-nav__item> <a href=#healtcheck-duration-0002 title="healtcheck duration > 0.002" class=md-nav__link> healtcheck duration &gt; 0.002 </a> </li> <li class=md-nav__item> <a href=#plugin-updates-available-10 title="plugin updates available > 10" class=md-nav__link> plugin updates available &gt; 10 </a> </li> <li class=md-nav__item> <a href=#gcp-throughput-too-low title="GCP ThroughPut Too Low" class=md-nav__link> GCP ThroughPut Too Low </a> </li> <li class=md-nav__item> <a href=#vm-heap-usage-ratio-70 title="vm heap usage ratio > 70%" class=md-nav__link> vm heap usage ratio &gt; 70% </a> </li> <li class=md-nav__item> <a href=#uptime-2 title="Uptime < 2" class=md-nav__link> Uptime &lt; 2 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#full-example title="Full Example" class=md-nav__link> Full Example </a> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/blogs/monitor-jenkins-on-k8s/alerts.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=alerts>Alerts<a class=headerlink href=#alerts title="Permanent link">&para;</a></h1> <h2 id=potential-alerts>Potential Alerts<a class=headerlink href=#potential-alerts title="Permanent link">&para;</a></h2> <ul> <li>health score &lt; 0.95</li> <li>ingress performance </li> <li>vm heap usage ratio &gt; 80%</li> <li>file descriptor &gt; 75%</li> <li>job queue &gt; 10 over x minutes</li> <li>job success ratio &lt; 50%</li> <li>master executor count &gt; 0</li> <li>good http request ratio &lt; 90%</li> <li>offline nodes &gt; 5 over 30 minutes</li> <li>healtcheck duration &gt; 0.002</li> <li> <p>plugin updates available &gt; 10</p> </li> <li> <p>An alert that triggers if any of the health reports are failing</p> </li> <li>An alert that triggers if the file descriptor usage on the master goes above 80%<ul> <li><code class=codehilite><span class=n>vm</span><span class=p>.</span><span class=n>file</span><span class=p>.</span><span class=k>descriptor</span><span class=p>.</span><span class=n>ratio</span></code> -&gt; <code class=codehilite><span class=n>vm_file_descriptor_ratio</span></code></li> </ul> </li> <li>An alert that triggers if the JVM heap memory usage is over 80% for more than a minute<ul> <li><code class=codehilite><span class=n>vm</span><span class=p>.</span><span class=n>memory</span><span class=p>.</span><span class=n>heap</span><span class=p>.</span><span class=k>usage</span></code> -&gt; <code class=codehilite><span class=n>vm_memory_heap_usage</span></code></li> </ul> </li> <li>An alert that triggers if the 5 minute average of HTTP/404 responses goes above 10 per minute for more than five minutes<ul> <li><code class=codehilite><span class=n>http</span><span class=p>.</span><span class=n>responseCodes</span><span class=p>.</span><span class=n>badRequest</span></code> -&gt; <code class=codehilite><span class=n>http_responseCodes_badRequest</span></code></li> </ul> </li> </ul> <h2 id=alert-manager-configuration>Alert Manager Configuration<a class=headerlink href=#alert-manager-configuration title="Permanent link">&para;</a></h2> <p>We can configure Alert Manager via the Prometheus Helm Chart.</p> <p>All the configuration elements below, are part of the <code class=codehilite><span class=n>prom</span><span class=o>-</span><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code> we used to when installing Prometheus via Helm.</p> <h3 id=get-slack-endpoint>Get Slack Endpoint<a class=headerlink href=#get-slack-endpoint title="Permanent link">&para;</a></h3> <p>TODO</p> <h3 id=base-configuration>Base Configuration<a class=headerlink href=#base-configuration title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>serverFiles</span><span class=p>:</span>
  <span class=nt>alerts</span><span class=p>:</span>
    <span class=nt>groups</span><span class=p>:</span>
    <span class=c1># alerts come here</span>
<span class=nt>alertmanagerFiles</span><span class=p>:</span>
  <span class=nt>alertmanager.yml</span><span class=p>:</span>
    <span class=nt>global</span><span class=p>:</span> <span class="p p-Indicator">{}</span>
    <span class=nt>route</span><span class=p>:</span>
      <span class=nt>group_by</span><span class=p>:</span> <span class="p p-Indicator">[</span><span class=nv>alertname</span><span class="p p-Indicator">,</span> <span class=nv>app_kubernetes_io_instance</span><span class="p p-Indicator">]</span>
      <span class=nt>receiver</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
    <span class=nt>receivers</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
      <span class=nt>slack_configs</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>api_url</span><span class=p>:</span> <span class=s>&#39;&lt;REPLACE_WITH_YOUR_SLACK_API_ENDPOINT&gt;&#39;</span>
        <span class=nt>username</span><span class=p>:</span> <span class=s>&#39;Alertmanager&#39;</span>
        <span class=nt>channel</span><span class=p>:</span> <span class=s>&#39;#notify&#39;</span>
        <span class=nt>send_resolved</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class=nt>title</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.summary</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>&quot;</span> 
        <span class=nt>text</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.description</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>.CommonLabels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>&quot;</span>
        <span class=nt>title_link</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">http://my-prometheus.com/alerts</span>
</pre></div> </td></tr></table> <h3 id=group-alerts>Group Alerts<a class=headerlink href=#group-alerts title="Permanent link">&para;</a></h3> <p>You can group alerts if they are similar or the same with different trigger values (warning vs critical).</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>serverFiles</span><span class=p>:</span>
  <span class=nt>alerts</span><span class=p>:</span>
    <span class=nt>groups</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">healthcheck</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsHealthScoreToLow</span>
        <span class=c1># alert info</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooSlowHealthCheck</span>
        <span class=c1># alert info</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jobs</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsQueued</span>
        <span class=c1># alert info</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsStuckInQueue</span>
        <span class=c1># alert info</span>
</pre></div> </td></tr></table> <h3 id=too-many-jobs-queued>Too Many Jobs Queued<a class=headerlink href=#too-many-jobs-queued title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsQueued</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_queue_size_value) &gt; 5</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>queued&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>stuck</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>the</span><span class=nv> </span><span class=s>queue&quot;</span>
</pre></div> </td></tr></table> <h3 id=jobs-stuck-in-queue>Jobs Stuck In Queue<a class=headerlink href=#jobs-stuck-in-queue title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsStuckInQueue</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_queue_stuck_value) by (app_kubernetes_io_instance) &gt; 5</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>queued&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>queue&quot;</span>
</pre></div> </td></tr></table> <h3 id=jobs-waiting-too-long-to-start>Jobs Waiting Too Long To Start<a class=headerlink href=#jobs-waiting-too-long-to-start title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsWaitingTooMuchOnJobStart</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum (jenkins_job_waiting_duration) by (app_kubernetes_io_instance) &gt; 0.05</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>waits</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>long</span><span class=nv> </span><span class=s>for</span><span class=nv> </span><span class=s>jobs&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>waiting</span><span class=nv> </span><span class=s>on</span><span class=nv> </span><span class=s>average</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>seconds</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>start</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>job&quot;</span>
</pre></div> </td></tr></table> <h3 id=health-score-1>health score &lt; 1<a class=headerlink href=#health-score-1 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsHealthScoreToLow</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_health_check_score) by (app_kubernetes_io_instance) &lt; 1</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>score&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>score</span><span class=nv> </span><span class=s>lower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>100%&quot;</span>
</pre></div> </td></tr></table> <h3 id=ingress-too-slow>Ingress Too Slow<a class=headerlink href=#ingress-too-slow title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">AppTooSlow</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(rate(nginx_ingress_controller_request_duration_seconds_bucket{le=&quot;0.25&quot;}[5m])) by (ingress) / sum(rate(nginx_ingress_controller_request_duration_seconds_count[5m])) by (ingress) &lt; 0.95</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;Application</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.ingress</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.ingress</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>More</span><span class=nv> </span><span class=s>then</span><span class=nv> </span><span class=s>5%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>requests</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>slower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>0.25s&quot;</span>
</pre></div> </td></tr></table> <h3 id=http-requests-too-slow>Http Requests Too Slow<a class=headerlink href=#http-requests-too-slow title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooSlow</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(http_requests{quantile=&quot;0.99&quot;} ) by (app_kubernetes_io_instance) &gt; 1</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv>  </span><span class=s>More</span><span class=nv> </span><span class=s>then</span><span class=nv> </span><span class=s>1%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>requests</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>slower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>1s</span><span class=nv> </span><span class=s>(request</span><span class=nv> </span><span class=s>time:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}})&quot;</span>
</pre></div> </td></tr></table> <h3 id=too-many-plugin-updates>Too Many Plugin Updates<a class=headerlink href=#too-many-plugin-updates title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyPluginsNeedUpate</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_plugins_withUpdate) by (app_kubernetes_io_instance) &gt; 3</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>updates&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>that</span><span class=nv> </span><span class=s>require</span><span class=nv> </span><span class=s>an</span><span class=nv> </span><span class=s>update&quot;</span>
</pre></div> </td></tr></table> <h3 id=file-descriptor-ratio-40>File Descriptor Ratio &gt; 40%<a class=headerlink href=#file-descriptor-ratio-40 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsToManyOpenFiles</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_file_descriptor_ratio) by (app_kubernetes_io_instance) &gt; 0.040</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>open</span><span class=nv> </span><span class=s>files&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>used</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>available</span><span class=nv> </span><span class=s>open</span><span class=nv> </span><span class=s>files&quot;</span>
</pre></div> </td></tr></table> <h3 id=job-success-ratio-50>Job Success Ratio &lt; 50%<a class=headerlink href=#job-success-ratio-50 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooLowJobSuccessRate</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_runs_success_total) by (app_kubernetes_io_instance) / sum(jenkins_runs_total_total) by (app_kubernetes_io_instance) &lt; 0.5</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>job</span><span class=nv> </span><span class=s>success</span><span class=nv> </span><span class=s>rate&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>less</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>50%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>being</span><span class=nv> </span><span class=s>successful&quot;</span>
</pre></div> </td></tr></table> <h3 id=job-wait-duration>Job Wait Duration<a class=headerlink href=#job-wait-duration title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooLowJobSuccessRate</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_runs_success_total) by (app_kubernetes_io_instance) / sum(jenkins_runs_total_total) by (app_kubernetes_io_instance) &lt; 0.60</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>job</span><span class=nv> </span><span class=s>success</span><span class=nv> </span><span class=s>rate&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>being</span><span class=nv> </span><span class=s>successful&quot;</span>
</pre></div> </td></tr></table> <h3 id=offline-nodes-5-over-10-minutes>Offline nodes &gt; 5 over 10 minutes<a class=headerlink href=#offline-nodes-5-over-10-minutes title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyOfflineNodes</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_node_offline_value) by (app_kubernetes_io_instance) &gt; 5</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>offline</span><span class=nv> </span><span class=s>nodes&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>nodes</span><span class=nv> </span><span class=s>that</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>offline</span><span class=nv> </span><span class=s>for</span><span class=nv> </span><span class=s>some</span><span class=nv> </span><span class=s>time</span><span class=nv> </span><span class=s>(5</span><span class=nv> </span><span class=s>minutes)&quot;</span> 
</pre></div> </td></tr></table> <h3 id=healtcheck-duration-0002>healtcheck duration &gt; 0.002<a class=headerlink href=#healtcheck-duration-0002 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooSlowHealthCheck</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_health_check_duration{quantile=&quot;0.999&quot;})</span>
    <span class="l l-Scalar l-Scalar-Plain">by (app_kubernetes_io_instance) &gt; 0.001</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>responds</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>check&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>responding</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>the</span><span class=nv> </span><span class=s>regular</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>check&quot;</span>
</pre></div> </td></tr></table> <h3 id=plugin-updates-available-10>plugin updates available &gt; 10<a class=headerlink href=#plugin-updates-available-10 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyPluginsNeedUpate</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_plugins_withUpdate) by (app_kubernetes_io_instance) &gt; 10</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">72h</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>updates&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>that</span><span class=nv> </span><span class=s>require</span><span class=nv> </span><span class=s>an</span><span class=nv> </span><span class=s>update&quot;</span>
</pre></div> </td></tr></table> <h3 id=gcp-throughput-too-low>GCP ThroughPut Too Low<a class=headerlink href=#gcp-throughput-too-low title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyPluginsNeedUpate</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1 - sum(vm_gc_G1_Young_Generation_time)by (app_kubernetes_io_instance)  /  sum (vm_uptime_milliseconds) by (app_kubernetes_io_instance) &lt; 0.99</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">30m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>GC</span><span class=nv> </span><span class=s>throughput&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>Garbage</span><span class=nv> </span><span class=s>Collection</span><span class=nv> </span><span class=s>throughput&quot;</span>
</pre></div> </td></tr></table> <h3 id=vm-heap-usage-ratio-70>vm heap usage ratio &gt; 70%<a class=headerlink href=#vm-heap-usage-ratio-70 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsVMMemoryRationTooHigh</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_memory_heap_usage) by (app_kubernetes_io_instance) &gt; 0.70</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>high</span><span class=nv> </span><span class=s>memory</span><span class=nv> </span><span class=s>ration&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>high</span><span class=nv> </span><span class=s>VM</span><span class=nv> </span><span class=s>memory</span><span class=nv> </span><span class=s>ration&quot;</span>
</pre></div> </td></tr></table> <h3 id=uptime-2>Uptime &lt; 2<a class=headerlink href=#uptime-2 title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsNewOrRestarted</span>
  <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_uptime_milliseconds) by (app_kubernetes_io_instance) / 3600000 &lt; 2</span>
  <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
  <span class=nt>annotations</span><span class=p>:</span>
    <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>uptime&quot;</span>
    <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>uptime</span><span class=nv> </span><span class=s>and</span><span class=nv> </span><span class=s>was</span><span class=nv> </span><span class=s>either</span><span class=nv> </span><span class=s>restarted</span><span class=nv> </span><span class=s>or</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>new</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>(uptime:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>hours)&quot;</span>
</pre></div> </td></tr></table> <h2 id=full-example>Full Example<a class=headerlink href=#full-example title="Permanent link">&para;</a></h2> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>server</span><span class=p>:</span>
  <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>annotations</span><span class=p>:</span>
      <span class=nt>ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
      <span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1000Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">500Mi</span>
<span class=nt>alertmanager</span><span class=p>:</span>
  <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>annotations</span><span class=p>:</span>
      <span class=nt>ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
      <span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>
<span class=nt>kubeStateMetrics</span><span class=p>:</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">50Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">25Mi</span>
<span class=nt>nodeExporter</span><span class=p>:</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>
<span class=nt>pushgateway</span><span class=p>:</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
      <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>

<span class=nt>serverFiles</span><span class=p>:</span>
  <span class=nt>alerts</span><span class=p>:</span>
    <span class=nt>groups</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jobs</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsQueued</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_queue_size_value) &gt; 5</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>queued&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>stuck</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>the</span><span class=nv> </span><span class=s>queue&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyJobsStuckInQueue</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_queue_stuck_value) by (app_kubernetes_io_instance) &gt; 5</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>queued&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>in</span><span class=nv> </span><span class=s>queue&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsWaitingTooMuchOnJobStart</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum (jenkins_job_waiting_duration) by (app_kubernetes_io_instance) &gt; 0.05</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>waits</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>long</span><span class=nv> </span><span class=s>for</span><span class=nv> </span><span class=s>jobs&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>waiting</span><span class=nv> </span><span class=s>on</span><span class=nv> </span><span class=s>average</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>seconds</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>start</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>job&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooLowJobSuccessRate</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_runs_success_total) by (app_kubernetes_io_instance) / sum(jenkins_runs_total_total) by (app_kubernetes_io_instance) &lt; 0.60</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>job</span><span class=nv> </span><span class=s>success</span><span class=nv> </span><span class=s>rate&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>jobs</span><span class=nv> </span><span class=s>being</span><span class=nv> </span><span class=s>successful&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">uptime</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsNewOrRestarted</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_uptime_milliseconds) by (app_kubernetes_io_instance) / 3600000 &lt; 2</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>uptime&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>uptime</span><span class=nv> </span><span class=s>and</span><span class=nv> </span><span class=s>was</span><span class=nv> </span><span class=s>either</span><span class=nv> </span><span class=s>restarted</span><span class=nv> </span><span class=s>or</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>new</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>(uptime:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>hours)&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">plugins</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyPluginsNeedUpate</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_plugins_withUpdate) by (app_kubernetes_io_instance) &gt; 3</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>updates&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>plugins</span><span class=nv> </span><span class=s>that</span><span class=nv> </span><span class=s>require</span><span class=nv> </span><span class=s>an</span><span class=nv> </span><span class=s>update&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jvm</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsToManyOpenFiles</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_file_descriptor_ratio) by (app_kubernetes_io_instance) &gt; 0.040</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>open</span><span class=nv> </span><span class=s>files&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>instance</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>used</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>available</span><span class=nv> </span><span class=s>open</span><span class=nv> </span><span class=s>files&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsVMMemoryRationTooHigh</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(vm_memory_heap_usage) by (app_kubernetes_io_instance) &gt; 0.70</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>high</span><span class=nv> </span><span class=s>memory</span><span class=nv> </span><span class=s>ration&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{$labels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>high</span><span class=nv> </span><span class=s>VM</span><span class=nv> </span><span class=s>memory</span><span class=nv> </span><span class=s>ration&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyPluginsNeedUpate</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1 - sum(vm_gc_G1_Young_Generation_time)by (app_kubernetes_io_instance)  /  sum (vm_uptime_milliseconds) by (app_kubernetes_io_instance) &lt; 0.99</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">30m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>GC</span><span class=nv> </span><span class=s>throughput&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>Garbage</span><span class=nv> </span><span class=s>Collection</span><span class=nv> </span><span class=s>throughput&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">web</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooSlow</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(http_requests{quantile=&quot;0.99&quot;} ) by (app_kubernetes_io_instance) &gt; 1</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv>  </span><span class=s>More</span><span class=nv> </span><span class=s>then</span><span class=nv> </span><span class=s>1%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>requests</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>slower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>1s</span><span class=nv> </span><span class=s>(request</span><span class=nv> </span><span class=s>time:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}})&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">AppTooSlow</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(rate(nginx_ingress_controller_request_duration_seconds_bucket{le=&quot;0.25&quot;}[5m])) by (ingress) / sum(rate(nginx_ingress_controller_request_duration_seconds_count[5m])) by (ingress) &lt; 0.95</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;Application</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.ingress</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.ingress</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>-</span><span class=nv> </span><span class=s>More</span><span class=nv> </span><span class=s>then</span><span class=nv> </span><span class=s>5%</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>requests</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>slower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>0.25s&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">healthcheck</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsHealthScoreToLow</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_health_check_score) by (app_kubernetes_io_instance) &lt; 1</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>low</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>score&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>score</span><span class=nv> </span><span class=s>lower</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>100%&quot;</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooSlowHealthCheck</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_health_check_duration{quantile=&quot;0.999&quot;})</span>
          <span class="l l-Scalar l-Scalar-Plain">by (app_kubernetes_io_instance) &gt; 0.001</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>responds</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>check&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>is</span><span class=nv> </span><span class=s>responding</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>slow</span><span class=nv> </span><span class=s>to</span><span class=nv> </span><span class=s>the</span><span class=nv> </span><span class=s>regular</span><span class=nv> </span><span class=s>health</span><span class=nv> </span><span class=s>check&quot;</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nodes</span>
      <span class=nt>rules</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsTooManyOfflineNodes</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_node_offline_value) by (app_kubernetes_io_instance) &gt; 3</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
        <span class=nt>labels</span><span class=p>:</span>
          <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
          <span class=nt>summary</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>too</span><span class=nv> </span><span class=s>many</span><span class=nv> </span><span class=s>offline</span><span class=nv> </span><span class=s>nodes&quot;</span>
          <span class=nt>description</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>$labels.app_kubernetes_io_instance</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>has</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>nodes</span><span class=nv> </span><span class=s>that</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>offline</span><span class=nv> </span><span class=s>for</span><span class=nv> </span><span class=s>some</span><span class=nv> </span><span class=s>time</span><span class=nv> </span><span class=s>(5</span><span class=nv> </span><span class=s>minutes)&quot;</span>
<span class=nt>alertmanagerFiles</span><span class=p>:</span>
  <span class=nt>alertmanager.yml</span><span class=p>:</span>
    <span class=nt>global</span><span class=p>:</span> <span class="p p-Indicator">{}</span>
    <span class=nt>route</span><span class=p>:</span>
      <span class=nt>group_by</span><span class=p>:</span> <span class="p p-Indicator">[</span><span class=nv>alertname</span><span class="p p-Indicator">,</span> <span class=nv>app_kubernetes_io_instance</span><span class="p p-Indicator">]</span>
      <span class=nt>receiver</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
    <span class=nt>receivers</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
      <span class=nt>slack_configs</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>api_url</span><span class=p>:</span> <span class=s>&#39;&lt;REPLACE_WITH_YOUR_SLACK_API_URL&gt;&#39;</span>
        <span class=nt>username</span><span class=p>:</span> <span class=s>&#39;Alertmanager&#39;</span>
        <span class=nt>channel</span><span class=p>:</span> <span class=s>&#39;#notify&#39;</span>
        <span class=nt>send_resolved</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class=nt>title</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.summary</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>&quot;</span> 
        <span class=nt>text</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.description</span><span class=nv> </span><span class=s>}}</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>.CommonLabels.app_kubernetes_io_instance}}</span><span class=nv> </span><span class=s>&quot;</span>
        <span class=nt>title_link</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">http://my-prometheus.com/alerts</span>
</pre></div> </td></tr></table> <h2 id=__comments>Comments</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://joostvdg.github.io/blogs/monitor-jenkins-on-k8s/alerts/";
      this.page.identifier =
        "/blogs/monitor-jenkins-on-k8s/alerts/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//joostvdg-github-io.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../metrics/ title=Metrics class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Metrics </span> </div> </a> <a href=../pipeline/ title=Pipeline class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Pipeline </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Joost van der Griendt </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/joostvdg class="md-footer-social__link fa fa-github"></a> <a href=https://twitter.com/joost_vdg class="md-footer-social__link fa fa-twitter"></a> <a href=https://linkedin.com/in/joostvdg class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.245445c6.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> </body> </html>