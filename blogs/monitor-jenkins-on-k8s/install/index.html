<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Monitoring Jenkins On Kubernetes - Install Tools - 3/8"><link href=https://joostvdg.github.io/blogs/monitor-jenkins-on-k8s/install/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>Jenkins Kubernetes Monitoring</title><link rel=stylesheet href=../../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#fb8c00><script src=../../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-145385967-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=red> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#install-components-for-monitoring tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-header-nav__button md-logo"> <i class=md-icon>public</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> J's Software Development Pages </span> <span class=md-header-nav__topic> Jenkins Kubernetes Monitoring </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <div class=md-hero data-md-component=hero> <div class="md-hero__inner md-grid"> Install Tools - 3/8 </div> </div> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../jenkins-pipeline-support-tool/ class="md-tabs__link md-tabs__link--active"> Blogs </a> </li> <li class=md-tabs__item> <a href=../../../cloudbees/sso-azure-ad/ class=md-tabs__link> CICD </a> </li> <li class=md-tabs__item> <a href=../../../kubernetes/ class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../../cloud/automation-pulumi/ class=md-tabs__link> Cloud </a> </li> <li class=md-tabs__item> <a href=../../../certificates/lets-encrypt-k8s/ class=md-tabs__link> SWE </a> </li> <li class=md-tabs__item> <a href=../../../java/ class=md-tabs__link> Java </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-nav__button md-logo"> <i class=md-icon>public</i> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=Me class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../../other/mkdocs/ title="MKDocs (This Static Website)" class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../../other/shell/ title=Shell class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Blogs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline-support-tool/ title="Jenkins Pipeline Support Tools" class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class=md-nav__item> <a href=../../graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../../sso-azure-ad/ title="CloudBees SSO Azure AD" class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../../teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../kubernetes-sso-keycloak/ title="Kubernetes SSO Keycloak" class=md-nav__link> Kubernetes SSO Keycloak </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-8 type=checkbox id=nav-2-8 checked> <label class=md-nav__link for=nav-2-8> Jenkins Monitoring Kubernetes </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-8> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Install Tools </label> <a href=./ title="Install Tools" class="md-nav__link md-nav__link--active"> Install Tools </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prepare class=md-nav__link> Prepare </a> </li> <li class=md-nav__item> <a href=#install-prometheus-alertmanager class=md-nav__link> Install Prometheus &amp; Alertmanager </a> </li> <li class=md-nav__item> <a href=#install-grafana class=md-nav__link> Install Grafana </a> </li> <li class=md-nav__item> <a href=#install-jenkins class=md-nav__link> Install Jenkins </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#helm-values-explained class=md-nav__link> Helm Values Explained </a> </li> <li class=md-nav__item> <a href=#master-one class=md-nav__link> Master One </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apply-certificate class=md-nav__link> Apply Certificate </a> </li> <li class=md-nav__item> <a href=#wait-for-rollout class=md-nav__link> Wait for rollout </a> </li> <li class=md-nav__item> <a href=#retrieve-password class=md-nav__link> Retrieve Password </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#master-two class=md-nav__link> Master Two </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#wait-for-rollout_1 class=md-nav__link> Wait for rollout </a> </li> <li class=md-nav__item> <a href=#apply-certificate_1 class=md-nav__link> Apply Certificate </a> </li> <li class=md-nav__item> <a href=#retrieve-password_1 class=md-nav__link> Retrieve Password </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../alerts/ title=Alerts class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../../dockercon-eu-2018/ title="DockerCon EU 2018" class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> CloudBees </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-gke-helm/ title="CloudBees Core on GKE" class=md-nav__link> CloudBees Core on GKE </a> </li> <li class=md-nav__item> <a href=../../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Jenkins X </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkinsx/jxboot/ title="JX Boot GKE" class=md-nav__link> JX Boot GKE </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/jxboot-aks/ title="JX Boot AKS" class=md-nav__link> JX Boot AKS </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/aks-boot-core/ title="JX Boot & CloudBees Core" class=md-nav__link> JX Boot & CloudBees Core </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/buildpack/ title=BuildPack class=md-nav__link> BuildPack </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> <li class=md-nav__item> <a href=../../../jenkinsx/kubernetes-days/ title="Example For Console Reel" class=md-nav__link> Example For Console Reel </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Jenkins </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> Jenkins Pipelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-4> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline/job-types/ title="Job Types" class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/kaniko-pipelines/ title="Build Docker Image Kaniko" class=md-nav__link> Build Docker Image Kaniko </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/podtemplate-dind/ title="PodTemplate With Docker-In-Docker" class=md-nav__link> PodTemplate With Docker-In-Docker </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/jenkins-parallel-pipeline/ title="Parallel Pipelines" class=md-nav__link> Parallel Pipelines </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/core-concepts/ title="Core Concepts" class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/artifactory-integration/ title="Artifactory Integration" class=md-nav__link> Artifactory Integration </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline/input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Jenkins Pipeline Examples </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-5> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Containers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1> <label class=md-nav__link for=nav-4-1> Kubernetes (K8S) </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class=md-nav__link for=nav-4-2> K8S Public Services </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-2> K8S Public Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/gke-terraform/ title="GKE Terraform" class=md-nav__link> GKE Terraform </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/eks-eksctl/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-cli/ title="AKS CLI" class=md-nav__link> AKS CLI </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/distributions/aks-terraform/ title="AKS Terraform" class=md-nav__link> AKS Terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> K8S Hard Way - GCE </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class=md-nav__link for=nav-4-4> Docker </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-4> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docker/graceful-shutdown/ title="Graceful Shutdown" class=md-nav__link> Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../../docker/build-kit/ title=BuildKit class=md-nav__link> BuildKit </a> </li> <li class=md-nav__item> <a href=../../../docker/multi-stage-builds/ title="Multi-Stage Builds(TBD)" class=md-nav__link> Multi-Stage Builds(TBD) </a> </li> <li class=md-nav__item> <a href=../../../docker/swarm/ title="Swarm (mode) (TBD)" class=md-nav__link> Swarm (mode) (TBD) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-5> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Cloud </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cloud/automation-pulumi/ title="Automation - Pulumi" class=md-nav__link> Automation - Pulumi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> SWE </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> SWE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Software Engineering </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-2> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../swe/important-concepts/ title="Important Concepts" class=md-nav__link> Important Concepts </a> </li> <li class=md-nav__item> <a href=../../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../../swe/distributed/ title="Distributed Computing" class=md-nav__link> Distributed Computing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-3 type=checkbox id=nav-6-3> <label class=md-nav__link for=nav-6-3> Productivity </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-3> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../productivity/incidents/ title=Incidents class=md-nav__link> Incidents </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../../keep-watching/ title="Spring Boot App" class=md-nav__link> Spring Boot App </a> </li> <li class=md-nav__item> <a href=../../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#prepare class=md-nav__link> Prepare </a> </li> <li class=md-nav__item> <a href=#install-prometheus-alertmanager class=md-nav__link> Install Prometheus &amp; Alertmanager </a> </li> <li class=md-nav__item> <a href=#install-grafana class=md-nav__link> Install Grafana </a> </li> <li class=md-nav__item> <a href=#install-jenkins class=md-nav__link> Install Jenkins </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#helm-values-explained class=md-nav__link> Helm Values Explained </a> </li> <li class=md-nav__item> <a href=#master-one class=md-nav__link> Master One </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apply-certificate class=md-nav__link> Apply Certificate </a> </li> <li class=md-nav__item> <a href=#wait-for-rollout class=md-nav__link> Wait for rollout </a> </li> <li class=md-nav__item> <a href=#retrieve-password class=md-nav__link> Retrieve Password </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#master-two class=md-nav__link> Master Two </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#wait-for-rollout_1 class=md-nav__link> Wait for rollout </a> </li> <li class=md-nav__item> <a href=#apply-certificate_1 class=md-nav__link> Apply Certificate </a> </li> <li class=md-nav__item> <a href=#retrieve-password_1 class=md-nav__link> Retrieve Password </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/blogs/monitor-jenkins-on-k8s/install.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=install-components-for-monitoring>Install Components for Monitoring<a class=headerlink href=#install-components-for-monitoring title="Permanent link">&para;</a></h1> <p>This chapter is about installing all the tools we need for completing this guide. If you already have these tools installed, feel free to skip the actual installations. However, do make sure to confirm you have a compatible configuration.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>This guide is written during August/September 2019, during which Helm 3 entered Beta. This guide assumes Helm 2, be mindful of the Helm version you are running!</p> </div> <h2 id=prepare>Prepare<a class=headerlink href=#prepare title="Permanent link">&para;</a></h2> <p>First, we make sure we have hostnames for our services, including Prometheus, Alertmanager, and Grafana.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>export</span> <span class=nv>DOMAIN</span><span class=o>=</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>export</span> <span class=nv>PROM_ADDR</span><span class=o>=</span>mon.<span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span>
<span class=nb>export</span> <span class=nv>AM_ADDR</span><span class=o>=</span>alertmanager.<span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span>
<span class=nb>export</span> <span class=nv>GRAFANA_ADDR</span><span class=o>=</span><span class=s2>&quot;grafana.</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&quot;</span>
</pre></div> </td></tr></table> <p>Then we create a namespace to host the monitoring tools.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl create namespace mon
kubens mon
</pre></div> </td></tr></table> <h2 id=install-prometheus-alertmanager>Install Prometheus &amp; Alertmanager<a class=headerlink href=#install-prometheus-alertmanager title="Permanent link">&para;</a></h2> <p>By default, the Helm chart of Prometheus installs Alertmanager as well. To access the UI of Alertmanager, we also set its Ingress' hostname.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm upgrade -i prometheus <span class=se>\</span>
 stable/prometheus <span class=se>\</span>
 --namespace mon <span class=se>\</span>
 --version <span class=m>7</span>.1.3 <span class=se>\</span>
 --set server.ingress.hosts<span class=o>={</span><span class=nv>$PROM_ADDR</span><span class=o>}</span> <span class=se>\</span>
 --set alertmanager.ingress.hosts<span class=o>={</span><span class=nv>$AM_ADDR</span><span class=o>}</span> <span class=se>\</span>
 -f prom-values.yaml
</pre></div> </td></tr></table> <p>Use the below command to wait for the deployment of Prometheus to be completed.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl -n mon <span class=se>\</span>
 rollout status <span class=se>\</span>
 deploy prometheus-server
</pre></div> </td></tr></table> <details class=example><summary>prom-values.yaml</summary><p>Below is an example helm <code class=codehilite><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code> for Prometheus. It shows how to set resources limits and request, some alerts, and how to configure sending these alerts to Slack.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>server</span><span class=p>:</span>
    <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>annotations</span><span class=p>:</span>
        <span class=nt>ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
        <span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
    <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1000Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">500Mi</span>
<span class=nt>alertmanager</span><span class=p>:</span>
    <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>annotations</span><span class=p>:</span>
        <span class=nt>ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
        <span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
    <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>
<span class=nt>kubeStateMetrics</span><span class=p>:</span>
    <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">50Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">25Mi</span>
<span class=nt>nodeExporter</span><span class=p>:</span>
    <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>
<span class=nt>pushgateway</span><span class=p>:</span>
    <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>limits</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
    <span class=nt>requests</span><span class=p>:</span>
        <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10Mi</span>
<span class=nt>serverFiles</span><span class=p>:</span>
    <span class=nt>alerts</span><span class=p>:</span>
    <span class=nt>groups</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nodes</span>
        <span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class=nt>alert</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">JenkinsToManyJobsQueued</span>
        <span class=nt>expr</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">sum(jenkins_queue_size_value) &gt; 5</span>
        <span class=nt>for</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3m</span>
        <span class=nt>labels</span><span class=p>:</span>
            <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
        <span class=nt>annotations</span><span class=p>:</span>
            <span class=nt>summary</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Jenkins to many jobs queued</span>
            <span class=nt>description</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">A Jenkins instance is failing a health check</span>
<span class=nt>alertmanagerFiles</span><span class=p>:</span>
    <span class=nt>alertmanager.yml</span><span class=p>:</span>
    <span class=nt>global</span><span class=p>:</span> <span class="p p-Indicator">{}</span>
    <span class=nt>route</span><span class=p>:</span>
        <span class=nt>group_wait</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">10s</span>
        <span class=nt>group_interval</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
        <span class=nt>receiver</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">slack</span>
        <span class=nt>repeat_interval</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">3h</span>
        <span class=nt>routes</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class=nt>receiver</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">slack</span>
        <span class=nt>repeat_interval</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5d</span>
        <span class=nt>match</span><span class=p>:</span>
            <span class=nt>severity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
            <span class=nt>frequency</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">low</span>
    <span class=nt>receivers</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">slack</span>
        <span class="l l-Scalar l-Scalar-Plain">slack_configs</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class=nt>api_url</span><span class=p>:</span> <span class=s>&quot;XXXXXXXXXX&quot;</span>
        <span class=nt>send_resolved</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class=nt>title</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.summary</span><span class=nv> </span><span class=s>}}&quot;</span>
        <span class=nt>text</span><span class=p>:</span> <span class=s>&quot;{{</span><span class=nv> </span><span class=s>.CommonAnnotations.description</span><span class=nv> </span><span class=s>}}&quot;</span>
        <span class=nt>title_link</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">http://example.com</span>
</pre></div> </td></tr></table> </details> <h2 id=install-grafana>Install Grafana<a class=headerlink href=#install-grafana title="Permanent link">&para;</a></h2> <p>!!! note At the time of writing (September 2019) we cannot use the latest version of the Grafana helm chart.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=o>*</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>helm</span><span class=o>/</span><span class=n>charts</span><span class=o>/</span><span class=n>pull</span><span class=o>/</span><span class=mi>15702</span>
<span class=o>*</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>helm</span><span class=o>/</span><span class=n>charts</span><span class=o>/</span><span class=n>issues</span><span class=o>/</span><span class=mi>15725</span>
</pre></div> </td></tr></table> <p>We install Grafana in the same namespace as Prometheus and Alertmanager.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm upgrade -i grafana stable/grafana <span class=se>\</span>
 --version <span class=m>3</span>.5.5 <span class=se>\</span>
 --namespace mon <span class=se>\</span>
 --set ingress.hosts<span class=o>=</span><span class=s2>&quot;{</span><span class=nv>$GRAFANA_ADDR</span><span class=s2>}&quot;</span> <span class=se>\</span>
 --values grafana-values.yaml
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl -n mon rollout status deployment grafana
</pre></div> </td></tr></table> <p>Once the deployment is rolled out, we can either directly open the Grafana UI or echo the address and copy &amp; paste it.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>echo</span> <span class=s2>&quot;http://</span><span class=nv>$GRAFANA_ADDR</span><span class=s2>&quot;</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>open <span class=s2>&quot;http://</span><span class=nv>$GRAFANA_ADDR</span><span class=s2>&quot;</span>
</pre></div> </td></tr></table> <p>By default, the Grafana helm chart generates a password for you, with the command below you can retrieve it.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl -n mon <span class=se>\</span>
 get secret grafana <span class=se>\</span>
 -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&quot;{.data.admin-password}&quot;</span> <span class=se>\</span>
 <span class=p>|</span> base64 --decode<span class=p>;</span> <span class=nb>echo</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>open <span class=s2>&quot;https://grafana.com/dashboards&quot;</span>
</pre></div> </td></tr></table> <details class=example><summary>grafana-values.yaml</summary><p>Below is an example configuration for a helm <code class=codehilite><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code>, which also includes some useful dashboards by default. We've also configured a default Datasource, pointing to the Prometheus installed earlier.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>ingress</span><span class=p>:</span>
  <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>persistence</span><span class=p>:</span>
  <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class=nt>accessModes</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
  <span class=nt>size</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class=nt>resources</span><span class=p>:</span>
  <span class=nt>limits</span><span class=p>:</span>
    <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">20m</span>
    <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">50Mi</span>
  <span class=nt>requests</span><span class=p>:</span>
    <span class=nt>cpu</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5m</span>
    <span class=nt>memory</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">25Mi</span>
<span class=nt>datasources</span><span class=p>:</span>
  <span class=nt>datasources.yaml</span><span class=p>:</span>
    <span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>datasources</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
      <span class=nt>type</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">prometheus</span>
      <span class=nt>url</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">http://prometheus-server</span>
      <span class=nt>access</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">proxy</span>
      <span class=nt>isDefault</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>dashboardProviders</span><span class=p>:</span>
  <span class=nt>dashboardproviders.yaml</span><span class=p>:</span>
    <span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class=nt>providers</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class=s>&#39;Default&#39;</span>
      <span class=nt>orgId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>folder</span><span class=p>:</span> <span class=s>&#39;default&#39;</span>
      <span class=nt>type</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">file</span>
      <span class=nt>disableDeletion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class=nt>editable</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class=nt>options</span><span class=p>:</span>
        <span class=nt>path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/var/lib/grafana/dashboards/default</span>
<span class=nt>dashboards</span><span class=p>:</span>
  <span class=nt>default</span><span class=p>:</span>
    <span class=nt>Costs-Pod</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">6879</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
    <span class=nt>Costs</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">8670</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
    <span class=nt>Summary</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">8685</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
    <span class=nt>Capacity</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">5228</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
    <span class=nt>Deployments</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">8588</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
    <span class=nt>Volumes</span><span class=p>:</span>
      <span class=nt>gnetId</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">6739</span>
      <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class=nt>datasource</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Prometheus</span>
</pre></div> </td></tr></table> </details> <h2 id=install-jenkins>Install Jenkins<a class=headerlink href=#install-jenkins title="Permanent link">&para;</a></h2> <p>Now that we've taken care of the monitoring tools, we can install Jenkins. We start by creating a namespace for Jenkins to land in.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl create namespace jenkins
kubens jenkins
</pre></div> </td></tr></table> <p>There are many ways of installing Jenkins. There is a very well maintained Helm chart, which is well suited for what we want to achieve.</p> <p>!!! note It is recommended to spread teams and applications across Jenkins masters rather than put everything into a single instance. So in this guide we create two identical Jenkins Masters, each with a unique hostname, to simulate this and show that the alerts and dashboards work for <strong>one or more</strong> Jenkins masters.</p> <p>Although the Helm chart is a very good starting point, we still need a <code class=codehilite><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code> file to configure a few things.</p> <h3 id=helm-values-explained>Helm Values Explained<a class=headerlink href=#helm-values-explained title="Permanent link">&para;</a></h3> <p>Let's explain some of the values:</p> <ul> <li><code class=codehilite><span class=n>installPlugins</span></code>: we want <code class=codehilite><span class=n>blueocean</span></code> for a more beautiful Pipeline UI and <code class=codehilite><span class=n>prometheus</span></code> to expose the metrics in a Prometheus format</li> <li><code class=codehilite><span class=n>resources</span></code>: always specify your resources, if these are wrong, our monitoring alerts and dashboard should help use tweak these values</li> <li><code class=codehilite><span class=n>javaOpts</span></code>: for some reason, the default configuration doesn't have the recommended JVM and Garbage Collection configuration, so we have to specify this, see <a href=https://go.cloudbees.com/docs/solutions/jvm-troubleshooting/ >CloudBees' JVM Troubleshoot Guide</a> for more details</li> <li><code class=codehilite><span class=n>ingress</span></code>: because I believe every publicly available service should only be accessible via TLS, we have to configure TLS and certmanager annotations (as we're using Certmanager to manage our certificate)</li> <li><code class=codehilite><span class=n>podAnnotations</span></code>: the default metrics endpoint that Prometheus scrapes from is <code class=codehilite><span class=o>/</span><span class=n>metrics</span></code>, unfortunately, the by default included Metrics Plugin exposes the metrics on that endpoint in the wrong format. This means we have to inform Prometheus how to retrieve the metrics</li> </ul> <p>Make sure both <code class=codehilite><span class=n>jenkins</span><span class=o>-</span><span class=k>values</span><span class=p>.</span><span class=n>X</span><span class=p>.</span><span class=n>yaml</span></code> and <code class=codehilite><span class=n>jenkins</span><span class=o>-</span><span class=n>certificate</span><span class=p>.</span><span class=n>X</span><span class=p>.</span><span class=n>yaml</span></code> are created according to the template files below. Replace the X for each master, if you want three, you'll have <code class=codehilite><span class=nf>.1.yaml</span></code>, <code class=codehilite><span class=nf>.2.yaml</span></code> and <code class=codehilite><span class=nf>.3.yaml</span></code> for each of the files. Replace the <code class=codehilite><span class=o>&lt;</span><span class=n>ReplaceWithYourDNS</span><span class=o>&gt;</span></code> with your DNS Host name and the <code class=codehilite><span class=n>X</span></code> with the appropriate number.</p> <p>For example, if your host name is <code class=codehilite><span class=n>example</span><span class=p>.</span><span class=n>com</span></code>, you will have the following:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span> <span class=nt>hostName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jenkins1.example.com</span>
 <span class=nt>tls</span><span class=p>:</span>
 <span class="p p-Indicator">-</span> <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tls-jenkins-1</span>
 <span class=nt>hosts</span><span class=p>:</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jenkins1.example.com</span>
</pre></div> </td></tr></table> <p>Use this file as the starting point for each of the masters. I would recommend making your changes in this file first and then make two copies and update the <code class=codehilite><span class=n>X</span></code> value with <code class=codehilite><span class=mi>1</span></code> and <code class=codehilite><span class=mi>2</span></code> respectively.</p> <details class=example><summary>jenkins-values.X.yaml</summary><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>master</span><span class=p>:</span>
  <span class=nt>serviceType</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
  <span class=nt>installPlugins</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">blueocean:1.17.0</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prometheus:2.0.0</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes:1.17.2</span>
  <span class=nt>resources</span><span class=p>:</span>
    <span class=nt>requests</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class=s>&quot;250m&quot;</span>
      <span class=nt>memory</span><span class=p>:</span> <span class=s>&quot;1024Mi&quot;</span>
    <span class=nt>limits</span><span class=p>:</span>
      <span class=nt>cpu</span><span class=p>:</span> <span class=s>&quot;1000m&quot;</span>
      <span class=nt>memory</span><span class=p>:</span> <span class=s>&quot;2048Mi&quot;</span>
  <span class=nt>javaOpts</span><span class=p>:</span> <span class=s>&quot;-XX:+AlwaysPreTouch</span><span class=nv> </span><span class=s>-XX:+UseG1GC</span><span class=nv> </span><span class=s>-XX:+UseStringDeduplication</span><span class=nv> </span><span class=s>-XX:+ParallelRefProcEnabled</span><span class=nv> </span><span class=s>-XX:+DisableExplicitGC</span><span class=nv> </span><span class=s>-XX:+UnlockDiagnosticVMOptions</span><span class=nv> </span><span class=s>-XX:+UnlockExperimentalVMOptions&quot;</span>
  <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>hostName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jenkinsX.&lt;ReplaceWithYourDNS&gt;</span>
    <span class=nt>tls</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tls-jenkins-X</span>
        <span class=nt>hosts</span><span class=p>:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jenkinsX.&lt;ReplaceWithYourDNS&gt;</span>
    <span class=nt>annotations</span><span class=p>:</span>
      <span class=nt>certmanager.k8s.io/cluster-issuer</span><span class=p>:</span> <span class=s>&quot;letsencrypt-prod&quot;</span>
      <span class=nt>kubernetes.io/ingress.class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
      <span class=nt>kubernetes.io/tls-acme</span><span class=p>:</span> <span class=s>&quot;false&quot;</span>
      <span class=nt>nginx.ingress.kubernetes.io/proxy-body-size</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">50m</span>
      <span class=nt>nginx.ingress.kubernetes.io/proxy-request-buffering</span><span class=p>:</span> <span class=s>&quot;off&quot;</span>
      <span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span> <span class=s>&quot;true&quot;</span>
  <span class=nt>podAnnotations</span><span class=p>:</span>
    <span class=nt>prometheus.io/path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/prometheus</span>
    <span class=nt>prometheus.io/port</span><span class=p>:</span> <span class=s>&quot;8080&quot;</span>
    <span class=nt>prometheus.io/scrape</span><span class=p>:</span> <span class=s>&quot;true&quot;</span>
<span class=nt>agent</span><span class=p>:</span>
  <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>rbac</span><span class=p>:</span>
  <span class=nt>create</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div> </td></tr></table> </details> <p>If you want to use TLS for Jenkins, this is an example Certificate. If you don't already have <code class=codehilite><span class=n>certmanager</span></code> configured, take a look at <a href=/blogs/k8s-lets-encrypt/ >my guide on leveraging Let's Encrypt in Kubernetes</a>.</p> <details class=example><summary>jenkins-certificate.X.yaml</summary><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">certmanager.k8s.io/v1alpha1</span>
<span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Certificate</span>
<span class=nt>metadata</span><span class=p>:</span>
  <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jenkinsX.&lt;ReplaceWithYourDNS&gt;</span>
<span class=nt>spec</span><span class=p>:</span>
  <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tls-jenkins-X</span>
  <span class=nt>dnsNames</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jenkinsX.&lt;ReplaceWithYourDNS&gt;</span>
  <span class=nt>acme</span><span class=p>:</span>
    <span class=nt>config</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>http01</span><span class=p>:</span>
        <span class=nt>ingressClass</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
      <span class=nt>domains</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jenkinsX.&lt;ReplaceWithYourDNS&gt;</span>
  <span class=nt>issuerRef</span><span class=p>:</span>
    <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
    <span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterIssuer</span>
</pre></div> </td></tr></table> </details> <h3 id=master-one>Master One<a class=headerlink href=#master-one title="Permanent link">&para;</a></h3> <p>Assuming you've created unique Helm values files for both Master One and Master Two, we can start with creating the first one.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm upgrade -i jenkins <span class=se>\</span>
 stable/jenkins <span class=se>\</span>
 --namespace jenkins<span class=se>\</span>
 -f jenkins-values.1.yaml
</pre></div> </td></tr></table> <h4 id=apply-certificate>Apply Certificate<a class=headerlink href=#apply-certificate title="Permanent link">&para;</a></h4> <p>If you have the certificate, apply it to the cluster.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl apply -f jenkins-certificate.1.yaml
</pre></div> </td></tr></table> <h4 id=wait-for-rollout>Wait for rollout<a class=headerlink href=#wait-for-rollout title="Permanent link">&para;</a></h4> <p>If you want to wait for the Jenkins deployment to be completed, use the following command.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl -n jenkins rollout status deployment jenkins1
</pre></div> </td></tr></table> <h4 id=retrieve-password>Retrieve Password<a class=headerlink href=#retrieve-password title="Permanent link">&para;</a></h4> <p>The Jenkins Helm chart also generates a admin password for you. See the command below on how to retrieve it.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>printf</span> <span class=k>$(</span>kubectl get secret --namespace jenkins jenkins1 -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&quot;{.data.jenkins-admin-password}&quot;</span> <span class=p>|</span> base64 --decode<span class=k>)</span><span class=p>;</span><span class=nb>echo</span>
</pre></div> </td></tr></table> <h3 id=master-two>Master Two<a class=headerlink href=#master-two title="Permanent link">&para;</a></h3> <p>Let's create Master Two as well, same deal as before. The commands are here for convenience, so you can use the <code class=codehilite><span class=p>[]</span></code> in the top right to copy and paste easily.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm upgrade -i jenkins2 <span class=se>\</span>
 stable/jenkins <span class=se>\</span>
 --namespace jenkins<span class=se>\</span>
 -f jenkins-values.2.yaml
</pre></div> </td></tr></table> <h4 id=wait-for-rollout_1>Wait for rollout<a class=headerlink href=#wait-for-rollout_1 title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl -n jenkins rollout status deployment jenkins2
</pre></div> </td></tr></table> <h4 id=apply-certificate_1>Apply Certificate<a class=headerlink href=#apply-certificate_1 title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl apply -f jenkins-certificate.2.yaml
</pre></div> </td></tr></table> <h4 id=retrieve-password_1>Retrieve Password<a class=headerlink href=#retrieve-password_1 title="Permanent link">&para;</a></h4> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>printf</span> <span class=k>$(</span>kubectl get secret --namespace jenkins jenkins2 -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&quot;{.data.jenkins-admin-password}&quot;</span> <span class=p>|</span> base64 --decode<span class=k>)</span><span class=p>;</span><span class=nb>echo</span>
</pre></div> </td></tr></table> <h2 id=__comments>Comments</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://joostvdg.github.io/blogs/monitor-jenkins-on-k8s/install/";
      this.page.identifier =
        "/blogs/monitor-jenkins-on-k8s/install/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//joostvdg-github-io.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../prepare/ title="Prepare Environment" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Prepare Environment </span> </div> </a> <a href=../metrics/ title=Metrics class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Metrics </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Joost van der Griendt </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/joostvdg class="md-footer-social__link fa fa-github"></a> <a href=https://twitter.com/joost_vdg class="md-footer-social__link fa fa-twitter"></a> <a href=https://linkedin.com/in/joostvdg class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> </body> </html>