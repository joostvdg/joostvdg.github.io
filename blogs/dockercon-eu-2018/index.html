<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link href=https://joostvdg.github.io/blogs/dockercon-eu-2018/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.0"><title>DockerCon EU 2018 - J's Software Development Pages</title><link rel=stylesheet href=../../assets/stylesheets/application.0284f74d.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.01803549.css><meta name=theme-color content=#fb8c00><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-145385967-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=red> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#dockercon-eu-2018-recap tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-header-nav__button md-logo"> <i class=md-icon>public</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> J's Software Development Pages </span> <span class=md-header-nav__topic> DockerCon EU 2018 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../docker-graceful-shutdown/ title=Blogs class="md-tabs__link md-tabs__link--active"> Blogs </a> </li> <li class=md-tabs__item> <a href=../../cloudbees/sso-azure-ad/ title=CICD class=md-tabs__link> CICD </a> </li> <li class=md-tabs__item> <a href=../../docker/multi-stage-builds/ title=Containers class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../certificates/lets-encrypt-k8s/ title=SWE class=md-tabs__link> SWE </a> </li> <li class=md-tabs__item> <a href=../../java/ title=Java class=md-tabs__link> Java </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-nav__button md-logo"> <i class=md-icon>public</i> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Me class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../other/mkdocs/ title="MKDocs (This Static Website)" class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../other/shell/ title=Shell class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Blogs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../docker-graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../gitops-pipeline/ title="GitOps Pipeline" class=md-nav__link> GitOps Pipeline </a> </li> <li class=md-nav__item> <a href=../jenkins-pipeline-docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../../cloudbees/sso-azure-ad/ title="CloudBees SSO Azure AD" class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../jenkins-pipeline-support-tool/ title="Jenkins Pipeline Support Tools" class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-8 type=checkbox id=nav-2-8> <label class=md-nav__link for=nav-2-8> Jenkins Monitoring Kubernetes </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-8> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/install/ title="Install Tools" class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/alerts/ title=Alerts class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> DockerCon EU 2018 </label> <a href=./ title="DockerCon EU 2018" class="md-nav__link md-nav__link--active"> DockerCon EU 2018 </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#generally-outline title="Generally outline" class=md-nav__link> Generally outline </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#security-begins-at-the-developer title="Security begins at the Developer" class=md-nav__link> Security begins at the Developer </a> </li> <li class=md-nav__item> <a href=#broader-automation title="Broader Automation" class=md-nav__link> Broader Automation </a> </li> <li class=md-nav__item> <a href=#containerization-influences-everything title="Containerization Influences Everything" class=md-nav__link> Containerization Influences Everything </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-build-with-build-kit title="Docker Build with Build-Kit" class=md-nav__link> Docker Build with Build-Kit </a> </li> <li class=md-nav__item> <a href=#secure-your-kubernetes title="Secure your Kubernetes" class=md-nav__link> Secure your Kubernetes </a> </li> <li class=md-nav__item> <a href=#broader-cloud-automation title="Broader Cloud Automation" class=md-nav__link> Broader Cloud Automation </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cnab-cloud-native-application-bundle title="CNAB: cloud native application bundle" class=md-nav__link> CNAB: cloud native application bundle </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#install-an-implementation title="Install an implementation" class=md-nav__link> Install an implementation </a> </li> <li class=md-nav__item> <a href=#duffle title=Duffle class=md-nav__link> Duffle </a> </li> <li class=md-nav__item> <a href=#demo title=Demo class=md-nav__link> Demo </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#components title=Components class=md-nav__link> Components </a> </li> <li class=md-nav__item> <a href=#dockerfile title=Dockerfile class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#dufflejson title=duffle.json class=md-nav__link> duffle.json </a> </li> <li class=md-nav__item> <a href=#kgi title=kgi class=md-nav__link> kgi </a> </li> <li class=md-nav__item> <a href=#run-script title="run script" class=md-nav__link> run script </a> </li> <li class=md-nav__item> <a href=#run-the-demo title="Run the demo" class=md-nav__link> Run the demo </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#further-reading title="Further reading" class=md-nav__link> Further reading </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pulumi title=Pulumi class=md-nav__link> Pulumi </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#steps-taken title="Steps taken" class=md-nav__link> Steps taken </a> </li> <li class=md-nav__item> <a href=#artifactory-via-helm title="Artifactory via Helm" class=md-nav__link> Artifactory via Helm </a> </li> <li class=md-nav__item> <a href=#gke-cluster title="GKE Cluster" class=md-nav__link> GKE Cluster </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-config title="GKE Config" class=md-nav__link> GKE Config </a> </li> <li class=md-nav__item> <a href=#kubeconfig title=Kubeconfig class=md-nav__link> Kubeconfig </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pulumi-gcp-config title="Pulumi GCP Config" class=md-nav__link> Pulumi GCP Config </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#post-cluster-creation title="Post Cluster Creation" class=md-nav__link> Post Cluster Creation </a> </li> <li class=md-nav__item> <a href=#install-failed title="Install failed" class=md-nav__link> Install failed </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#helm-charts title="Helm Charts" class=md-nav__link> Helm Charts </a> </li> <li class=md-nav__item> <a href=#deployment-service title="Deployment & Service" class=md-nav__link> Deployment &amp; Service </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#jfrog-jenkins-challenge title="JFrog Jenkins Challenge" class=md-nav__link> JFrog Jenkins Challenge </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#jenkins-challenge title="Jenkins Challenge" class=md-nav__link> Jenkins Challenge </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installing-artifactory title="Installing Artifactory" class=md-nav__link> Installing Artifactory </a> </li> <li class=md-nav__item> <a href=#jenkinsfile title=Jenkinsfile class=md-nav__link> Jenkinsfile </a> </li> <li class=md-nav__item> <a href=#jenkinsfile-without-gradle-wrapper title="Jenkinsfile without Gradle Wrapper" class=md-nav__link> Jenkinsfile without Gradle Wrapper </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-security-standards title="Docker security & standards" class=md-nav__link> Docker security &amp; standards </a> </li> <li class=md-nav__item> <a href=#docker-java-cicd title="Docker & Java & CICD" class=md-nav__link> Docker &amp; Java &amp; CICD </a> </li> <li class=md-nav__item> <a href=#docker-windows title="Docker & Windows" class=md-nav__link> Docker &amp; Windows </a> </li> <li class=md-nav__item> <a href=#other title=Other class=md-nav__link> Other </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-pipeline title="Docker pipeline" class=md-nav__link> Docker pipeline </a> </li> <li class=md-nav__item> <a href=#idea-build-a-dynamic-cicd-platform-with-kubernetes title="Idea: build a dynamic ci/cd platform with kubernetes" class=md-nav__link> Idea: build a dynamic ci/cd platform with kubernetes </a> </li> <li class=md-nav__item> <a href=#apply-diplomacy-to-code-review title="Apply Diplomacy to Code Review" class=md-nav__link> Apply Diplomacy to Code Review </a> </li> <li class=md-nav__item> <a href=#citizens-bank-journey title="Citizens Bank journey" class=md-nav__link> Citizens Bank journey </a> </li> <li class=md-nav__item> <a href=#docker-ee-assemble title="Docker EE - Assemble" class=md-nav__link> Docker EE - Assemble </a> </li> <li class=md-nav__item> <a href=#other_1 title=Other class=md-nav__link> Other </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> CloudBees </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-post-install-tips/ title="CloudBees Core Post Install" class=md-nav__link> CloudBees Core Post Install </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Jenkins X </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/intro/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/workshop/ title=Workshop class=md-nav__link> Workshop </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/buildpack/ title=BuildPack class=md-nav__link> BuildPack </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Jenkins </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> Jenkins Pipelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-4> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline/job-types/ title="Job Types" class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/core-concepts/ title="Core Concepts" class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/jenkins-parallel-pipeline/ title=Parallel class=md-nav__link> Parallel </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Jenkins Pipeline Examples </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-5> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-shared-library/ title="Maven Shared Library" class=md-nav__link> Maven Shared Library </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Containers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1> <label class=md-nav__link for=nav-4-1> Docker </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker/multi-stage-builds/ title="Multi-Stage Builds" class=md-nav__link> Multi-Stage Builds </a> </li> <li class=md-nav__item> <a href=../../docker/graceful-shutdown/ title="Graceful shutdown" class=md-nav__link> Graceful shutdown </a> </li> <li class=md-nav__item> <a href=../../docker/swarm/ title="Swarm (mode)" class=md-nav__link> Swarm (mode) </a> </li> <li class=md-nav__item> <a href=../../docker/kubernetes/ title=Kubernetes class=md-nav__link> Kubernetes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class=md-nav__link for=nav-4-2> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-2> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../linux/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> <li class=md-nav__item> <a href=../../linux/networking/ title=Networking class=md-nav__link> Networking </a> </li> <li class=md-nav__item> <a href=../../linux/iptables/ title=iptables class=md-nav__link> iptables </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> Kubernetes (K8S) </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam/ title="CKA Exam details" class=md-nav__link> CKA Exam details </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class=md-nav__link for=nav-4-4> K8S CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-4> K8S CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/cicd/cdp-jenkins-helm/ title="CD Pipeline Jenkins & Helm" class=md-nav__link> CD Pipeline Jenkins & Helm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> K8S Distribution </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-5> K8S Distribution </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aws-eks/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-6 type=checkbox id=nav-4-6> <label class=md-nav__link for=nav-4-6> K8S Hard Way - GCE </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-6> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> SWE </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> SWE </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> Other </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-1> Other </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> Software Engineering </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../swe/ddd/ title="Domain Driven Design" class=md-nav__link> Domain Driven Design </a> </li> <li class=md-nav__item> <a href=../../swe/microservices/ title=Microservices class=md-nav__link> Microservices </a> </li> <li class=md-nav__item> <a href=../../swe/algorithms/ title=Algorithms class=md-nav__link> Algorithms </a> </li> <li class=md-nav__item> <a href=../../swe/observability/ title=Observability class=md-nav__link> Observability </a> </li> <li class=md-nav__item> <a href=../../swe/others/ title=Others class=md-nav__link> Others </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Productivity </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../productivity/tools/ title=Tools class=md-nav__link> Tools </a> </li> <li class=md-nav__item> <a href=../../productivity/intellij/ title="Intelli J" class=md-nav__link> Intelli J </a> </li> <li class=md-nav__item> <a href=../../productivity/paradigms/ title=Paradigms class=md-nav__link> Paradigms </a> </li> <li class=md-nav__item> <a href=../../productivity/studies/ title=Studies class=md-nav__link> Studies </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../java/spring/boot/ title="Spring Boot" class=md-nav__link> Spring Boot </a> </li> <li class=md-nav__item> <a href=../../java/java9/ title="Java 9" class=md-nav__link> Java 9 </a> </li> <li class=md-nav__item> <a href=../../java/ecosystem/ title="Java Ecosystem" class=md-nav__link> Java Ecosystem </a> </li> <li class=md-nav__item> <a href=../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../java/streams/ title="Java Streams" class=md-nav__link> Java Streams </a> </li> <li class=md-nav__item> <a href=../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#generally-outline title="Generally outline" class=md-nav__link> Generally outline </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#security-begins-at-the-developer title="Security begins at the Developer" class=md-nav__link> Security begins at the Developer </a> </li> <li class=md-nav__item> <a href=#broader-automation title="Broader Automation" class=md-nav__link> Broader Automation </a> </li> <li class=md-nav__item> <a href=#containerization-influences-everything title="Containerization Influences Everything" class=md-nav__link> Containerization Influences Everything </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-build-with-build-kit title="Docker Build with Build-Kit" class=md-nav__link> Docker Build with Build-Kit </a> </li> <li class=md-nav__item> <a href=#secure-your-kubernetes title="Secure your Kubernetes" class=md-nav__link> Secure your Kubernetes </a> </li> <li class=md-nav__item> <a href=#broader-cloud-automation title="Broader Cloud Automation" class=md-nav__link> Broader Cloud Automation </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cnab-cloud-native-application-bundle title="CNAB: cloud native application bundle" class=md-nav__link> CNAB: cloud native application bundle </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#install-an-implementation title="Install an implementation" class=md-nav__link> Install an implementation </a> </li> <li class=md-nav__item> <a href=#duffle title=Duffle class=md-nav__link> Duffle </a> </li> <li class=md-nav__item> <a href=#demo title=Demo class=md-nav__link> Demo </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#components title=Components class=md-nav__link> Components </a> </li> <li class=md-nav__item> <a href=#dockerfile title=Dockerfile class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#dufflejson title=duffle.json class=md-nav__link> duffle.json </a> </li> <li class=md-nav__item> <a href=#kgi title=kgi class=md-nav__link> kgi </a> </li> <li class=md-nav__item> <a href=#run-script title="run script" class=md-nav__link> run script </a> </li> <li class=md-nav__item> <a href=#run-the-demo title="Run the demo" class=md-nav__link> Run the demo </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#further-reading title="Further reading" class=md-nav__link> Further reading </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pulumi title=Pulumi class=md-nav__link> Pulumi </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#steps-taken title="Steps taken" class=md-nav__link> Steps taken </a> </li> <li class=md-nav__item> <a href=#artifactory-via-helm title="Artifactory via Helm" class=md-nav__link> Artifactory via Helm </a> </li> <li class=md-nav__item> <a href=#gke-cluster title="GKE Cluster" class=md-nav__link> GKE Cluster </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gke-config title="GKE Config" class=md-nav__link> GKE Config </a> </li> <li class=md-nav__item> <a href=#kubeconfig title=Kubeconfig class=md-nav__link> Kubeconfig </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pulumi-gcp-config title="Pulumi GCP Config" class=md-nav__link> Pulumi GCP Config </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#post-cluster-creation title="Post Cluster Creation" class=md-nav__link> Post Cluster Creation </a> </li> <li class=md-nav__item> <a href=#install-failed title="Install failed" class=md-nav__link> Install failed </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#helm-charts title="Helm Charts" class=md-nav__link> Helm Charts </a> </li> <li class=md-nav__item> <a href=#deployment-service title="Deployment & Service" class=md-nav__link> Deployment &amp; Service </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#jfrog-jenkins-challenge title="JFrog Jenkins Challenge" class=md-nav__link> JFrog Jenkins Challenge </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#jenkins-challenge title="Jenkins Challenge" class=md-nav__link> Jenkins Challenge </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installing-artifactory title="Installing Artifactory" class=md-nav__link> Installing Artifactory </a> </li> <li class=md-nav__item> <a href=#jenkinsfile title=Jenkinsfile class=md-nav__link> Jenkinsfile </a> </li> <li class=md-nav__item> <a href=#jenkinsfile-without-gradle-wrapper title="Jenkinsfile without Gradle Wrapper" class=md-nav__link> Jenkinsfile without Gradle Wrapper </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-security-standards title="Docker security & standards" class=md-nav__link> Docker security &amp; standards </a> </li> <li class=md-nav__item> <a href=#docker-java-cicd title="Docker & Java & CICD" class=md-nav__link> Docker &amp; Java &amp; CICD </a> </li> <li class=md-nav__item> <a href=#docker-windows title="Docker & Windows" class=md-nav__link> Docker &amp; Windows </a> </li> <li class=md-nav__item> <a href=#other title=Other class=md-nav__link> Other </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-pipeline title="Docker pipeline" class=md-nav__link> Docker pipeline </a> </li> <li class=md-nav__item> <a href=#idea-build-a-dynamic-cicd-platform-with-kubernetes title="Idea: build a dynamic ci/cd platform with kubernetes" class=md-nav__link> Idea: build a dynamic ci/cd platform with kubernetes </a> </li> <li class=md-nav__item> <a href=#apply-diplomacy-to-code-review title="Apply Diplomacy to Code Review" class=md-nav__link> Apply Diplomacy to Code Review </a> </li> <li class=md-nav__item> <a href=#citizens-bank-journey title="Citizens Bank journey" class=md-nav__link> Citizens Bank journey </a> </li> <li class=md-nav__item> <a href=#docker-ee-assemble title="Docker EE - Assemble" class=md-nav__link> Docker EE - Assemble </a> </li> <li class=md-nav__item> <a href=#other_1 title=Other class=md-nav__link> Other </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/blogs/dockercon-eu-2018.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=dockercon-eu-2018-recap>DockerCon EU 2018 - Recap<a class=headerlink href=#dockercon-eu-2018-recap title="Permanent link">&para;</a></h1> <h2 id=generally-outline>Generally outline<a class=headerlink href=#generally-outline title="Permanent link">&para;</a></h2> <p>From my perspective, there were a few red threads throughout the conference.</p> <h3 id=security-begins-at-the-developer>Security begins at the Developer<a class=headerlink href=#security-begins-at-the-developer title="Permanent link">&para;</a></h3> <p>A shift left of security, bringing the responsibility of knowing your dependencies and their quality firmly to the developer. Most of this tooling is still aimed at enterprises though, being part of paid solutions mostly. At least that which was shown at the conference.</p> <ul> <li>docker-assemble, that can build in an image from a Maven pom.xml and will include meta-data of all your dependencies (transitive included)</li> <li>JFrog X-Ray</li> <li>Docker EE tooling such as Docker Trusted Registry (DTR)</li> </ul> <h3 id=broader-automation>Broader Automation<a class=headerlink href=#broader-automation title="Permanent link">&para;</a></h3> <p>More focus on the entire lifecycle of a system and not just an application. It seems people are starting to understand that doing CI/CD and Infrastructure As Code is not a single event for a single application. There is likely to be a few applications belonging together making a whole system which will land on more than one type of infrastructure and possibly more types of clusters.</p> <p>What we see is tools looking at either a broader scope, a higher level abstraction or more developer focussed (more love for the Dev in DevOps) to allow for easier integration with multiple platforms. For example, Pulumi will enable you to create any type of infrastructure - like Hashicorp's Terraform - but then in programming languages, you're used to (TypeScript, Python, Go).</p> <ul> <li>Pulumi</li> <li>Docker App</li> <li>CNAB</li> <li>Build-Kit</li> </ul> <h3 id=containerization-influences-everything>Containerization Influences Everything<a class=headerlink href=#containerization-influences-everything title="Permanent link">&para;</a></h3> <p>Containerization has left deep and easy to spot imprints in our industry from startups building entirely on top of containers to programming languages changing their ways to stay relevant.</p> <p>There are new monitoring kings in the world, DataDog, Sysdig, Honeycomb.io and so on. They live and breathe containers and are not afraid of being thrown around different public clouds, networks and what not. In contrast to traditional monitoring tools, which are often bolting on container support and struggle with the dynamic nature of containerized clusters.</p> <p>Another extraordinary influence is that on the Java language. Declared dead a million times over and deemed obsolete in the container era due to its massive footprint in image size and runtime size. Both are being addressed, and we see a lot of work done on reducing footprint and static linking (JLink, Graal).</p> <p>The most significant influence might be on the software behemoth that has rejuvenated itself. Microsoft has sworn allegiance to open source, Linux and containers. Windows 2019 server can run container workloads natively and work as nodes alongside a Docker EE cluster - which can include Kubernetes workloads. The next step would be support for Kubernetes integration, and as in the case of Java, smaller container footprint.</p> <ul> <li>Java &amp; Docker</li> <li>Windows Container &amp; Windows Server Support</li> <li>Observability tools</li> <li>Kubernetes offerings everywhere...</li> </ul> <h2 id=docker-build-with-build-kit>Docker Build with Build-Kit<a class=headerlink href=#docker-build-with-build-kit title="Permanent link">&para;</a></h2> <p>Instead of investing in improving docker image building via the Docker Client, Docker created a new API and client library.</p> <p>This library called BuildKit, is completely independent. With Docker 18.09, it is included in the Docker Client allowing anyone to use it as easily as the traditional <code class=codehilite><span class=n>docker</span> <span class=n>image</span> <span class=n>build</span></code>.</p> <p>BuildKit is already used by some other tools, such as Buildah and IMG, and allows you to create custom DSL "Frontends". As long as the API of BuikdKit is adhered to, the resulting image will be OCI compliant.</p> <p>So further remarks below and how to use it.</p> <ul> <li><a href=https://github.com/moby/buildkit>BuildKit</a></li> <li>In-Depth session <a href=https://europe-2018.dockercon.com/videos-hub>Supercharged Docker Build with BuildKit</a></li> <li>Usable from Docker <code class=codehilite><span class=mi>18</span><span class=p>.</span><span class=mi>09</span></code></li> <li>HighLights:<ul> <li>allows custom DSL for specifying image (BuildKit) to still be used with Docker client/daemon</li> <li>build cache for your own files during build, think Go, Maven, Gradle...</li> <li>much more optimized, builds less, quicker, with more cache in less time</li> <li>support mounts (cache) such as secrets, during build phase</li> </ul> </li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1># Set env variable to enable</span>
<span class=c1># Or configure docker&#39;s json config</span>
<span class=nb>export</span> <span class=nv>DOCKER_BUILDKIT</span><span class=o>=</span><span class=m>1</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c># syntax=docker/dockerfile:experimental</span>
<span class=c>#######################################</span>
<span class=c>## 1. BUILD JAR WITH MAVEN</span>
<span class=k>FROM</span><span class=s> maven:3.6-jdk-8 as BUILD</span>
<span class=k>WORKDIR</span><span class=s> /usr/src</span>
<span class=k>COPY</span> . /usr/src
! RUN --mount<span class=o>=</span><span class=nv>type</span><span class=o>=</span>cache,target<span class=o>=</span>/root/.m2/  mvn clean package -e
<span class=c>#######################################</span>
<span class=c>## 2. BUILD NATIVE IMAGE WITH GRAAL</span>
<span class=k>FROM</span><span class=s> oracle/graalvm-ce:1.0.0-rc9 as NATIVE_BUILD</span>
<span class=k>WORKDIR</span><span class=s> /usr/src</span>
<span class=k>COPY</span> --from<span class=o>=</span>BUILD /usr/src/ /usr/src
<span class=k>RUN</span> ls -lath /usr/src/target/
<span class=k>COPY</span> /docker-graal-build.sh /usr/src
<span class=k>RUN</span> ./docker-graal-build.sh
<span class=k>RUN</span> ls -lath
<span class=c>#######################################</span>
<span class=c>## 3. BUILD DOCKER RUNTIME IMAGE</span>
<span class=k>FROM</span><span class=s> alpine:3.8</span>
<span class=k>CMD</span> <span class=p>[</span><span class=s2>&quot;jpc-graal&quot;</span><span class=p>]</span>
<span class=k>COPY</span> --from<span class=o>=</span>NATIVE_BUILD /usr/src/jpc-graal /usr/local/bin/
<span class=k>RUN</span> chmod +x /usr/local/bin/jpc-graal
<span class=c>#######################################</span>
</pre></div> </td></tr></table> <p><img alt="BuildKit Slide" src=../../images/dockerconeu2018/buildkit-1.jpg></p> <h2 id=secure-your-kubernetes>Secure your Kubernetes<a class=headerlink href=#secure-your-kubernetes title="Permanent link">&para;</a></h2> <ul> <li><a href=https://www.openpolicyagent.org>https://www.openpolicyagent.org</a> + admission controller</li> <li>Network Policies</li> <li>Service Accounts</li> </ul> <h2 id=broader-cloud-automation>Broader Cloud Automation<a class=headerlink href=#broader-cloud-automation title="Permanent link">&para;</a></h2> <p>Two of the <code class=codehilite><span class=n>broader</span> <span class=n>cloud</span> <span class=n>automation</span></code> initiatives that impressed me at DockerCon were Pulumi and CNAB.</p> <p>Where Pulumi is an attempt to provide a more developer-friendly alternative to Terraform, CNAB is an attempt to create an environment agnostic installer specification.</p> <p>Meaning, you could create a CNAB installer which uses Pulumi to install all required infrastructure, applications and other resources.</p> <h3 id=cnab-cloud-native-application-bundle>CNAB: cloud native application bundle<a class=headerlink href=#cnab-cloud-native-application-bundle title="Permanent link">&para;</a></h3> <ul> <li>Bundle.json</li> <li>invocation image (oci) = installer</li> <li><a href=https://cnab.io>https://cnab.io</a></li> <li>docker app implements it</li> <li>helm support</li> <li><a href=https://github.com/deislabs>https://github.com/deislabs</a></li> </ul> <p><img alt=CNAB src=../../images/dockerconeu2018/cnab-1.jpg></p> <h4 id=install-an-implementation>Install an implementation<a class=headerlink href=#install-an-implementation title="Permanent link">&para;</a></h4> <p>There are currently two implementations - that I found. Duffle from DeisLabs - open source from Azure - and Docker App - From Docker Inc..</p> <h4 id=duffle>Duffle<a class=headerlink href=#duffle title="Permanent link">&para;</a></h4> <ul> <li>create a new repo</li> <li>clone the repo</li> <li>init a duffle bundle</li> <li>copy duffle bundle data to our repo folder</li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>git clone git@github.com:demomon/cnab-duffle-demo-1.git
duffle create cnab-duffle-demo-2
mv cnab-duffle-demo-2/cnab cnab-duffle-demo-1/
mv cnab-duffle-demo-2/duffle.json cnab-duffle-demo-1/
</pre></div> </td></tr></table> <ul> <li>edit our install file (<code class=codehilite><span class=n>cnab</span><span class=o>/</span><span class=n>run</span></code>)</li> <li>build our duffle bundle (<code class=codehilite><span class=n>duffle</span> <span class=n>build</span> <span class=p>.</span></code>)</li> </ul> <p>We can now inspect our bundle with duffle.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class=code><div class=codehilite><pre><span></span>duffle show cnab-duffle-demo-1:0.1.0 -r

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

<span class=o>{</span>
  <span class=s2>&quot;name&quot;</span>: <span class=s2>&quot;cnab-duffle-demo-1&quot;</span>,
  <span class=s2>&quot;version&quot;</span>: <span class=s2>&quot;0.1.0&quot;</span>,
  <span class=s2>&quot;description&quot;</span>: <span class=s2>&quot;A short description of your bundle&quot;</span>,
  <span class=s2>&quot;keywords&quot;</span>: <span class=o>[</span>
    <span class=s2>&quot;cnab-duffle-demo-1&quot;</span>,
    <span class=s2>&quot;cnab&quot;</span>,
    <span class=s2>&quot;demo&quot;</span>,
    <span class=s2>&quot;joostvdg&quot;</span>
  <span class=o>]</span>,
  <span class=s2>&quot;maintainers&quot;</span>: <span class=o>[</span>
    <span class=o>{</span>
      <span class=s2>&quot;name&quot;</span>: <span class=s2>&quot;Joost van der Griendt&quot;</span>,
      <span class=s2>&quot;email&quot;</span>: <span class=s2>&quot;joostvdg@gmail.com&quot;</span>,
      <span class=s2>&quot;url&quot;</span>: <span class=s2>&quot;https://joostvdg.github.io&quot;</span>
    <span class=o>}</span>
  <span class=o>]</span>,
  <span class=s2>&quot;invocationImages&quot;</span>: <span class=o>[</span>
    <span class=o>{</span>
      <span class=s2>&quot;imageType&quot;</span>: <span class=s2>&quot;docker&quot;</span>,
      <span class=s2>&quot;image&quot;</span>: <span class=s2>&quot;deislabs/cnab-duffle-demo-1-cnab:2965aad7406e1b651a98fffe1194fcaaec5e623c&quot;</span>
    <span class=o>}</span>
  <span class=o>]</span>,
  <span class=s2>&quot;images&quot;</span>: null,
  <span class=s2>&quot;parameters&quot;</span>: null,
  <span class=s2>&quot;credentials&quot;</span>: null
<span class=o>}</span>
-----BEGIN PGP SIGNATURE-----

wsDcBAEBCAAQBQJcL3L8CRDgq4YEOipZ/QAAjDYMAJI5o66SteUP2o4HsbVk+Viw
3Fd874vSVmpPKcmN3tRCEDWGdMdvqQiirDpa//ghx4y5oFTahK2ihQ35GbJLlq8S
v9/CK6CKGJtp5g38s2LZrKIvESzEF2lTXwHB03PG8PJ37iWiYkHkxvMpyzded3Rs
4d+VgUnip0Cre7DemaUaz5+fTQjs88WNTIhqPg47YvgqFXV0s1y7yN3RTLr3ohQ1
9mkw87nWfOD+ULpbCUaq9FhNZ+v4dK5IZcWlkyv+yrtguyBBiA3MC54ueVBAdFCl
2OhxXgZjbBHPfQPV1mPqCQudOsWjK/+gqyNb6KTzKrAnyrumVQli/C/8BVk/SRC/
GS2o4EdTS2lfREc2Gl0/VTmMkqzFZZhWd7pwt/iMjl0bICFehSU0N6OqN1d+v6Sq
vWIZ5ppxt1NnCzp05Y+NRfVZOxBc2xjYTquFwIa/+qGPrmXBKamw/irjmCOndvx+
l1tf/g0UVSQI2R2/19svl7dlMkYpDdlth1YGgZi/Hg<span class=o>==</span>
<span class=o>=</span>8Xwi
-----END PGP SIGNATURE-----
</pre></div> </td></tr></table> <h4 id=demo>Demo<a class=headerlink href=#demo title="Permanent link">&para;</a></h4> <p>I've created a demo on GitHub: <a href=https://github.com/demomon/cnab-duffle-demo-1>github.com/demomon/cnab-duffle-demo-1</a></p> <p>Its goal is to install <a href=https://www.cloudbees.com/products/cloudbees-core>CloudBees Core</a> and its prerequisites in a (GKE) Kubernetes cluster.</p> <p>It wraps a Go (lang) binary that will execute the commands, for which you can find the source code <a href=https://github.com/joostvdg/k8s-gitops-installer>on GitHub</a>.</p> <h5 id=components>Components<a class=headerlink href=#components title="Permanent link">&para;</a></h5> <p>A CNAB bundle has some components by default, for this demo we needed the following:</p> <ul> <li><strong>duffle.json</strong>: Duffle configuration file</li> <li><strong>Dockerfile</strong>: the CNAB installer runtime</li> <li><strong>run</strong>(script): the installer script</li> <li><strong>kgi</strong>(binary): the binary executable from my k8s-gitops-installer code, that we will leverage for the installation</li> </ul> <h5 id=dockerfile>Dockerfile<a class=headerlink href=#dockerfile title="Permanent link">&para;</a></h5> <p>The installer tool (<code class=codehilite><span class=n>kgi</span></code>) requires <code class=codehilite><span class=n>Helm</span></code> and <code class=codehilite><span class=n>Kubectl</span></code>, so we a Docker image that has those. As we might end up packaging the entire image as part of the full CNAB package, it should also be based on Alpine (or similar minimal Linux).</p> <p>There seems to be one very well maintained and widely used (according to GitHub and Dockerhub stats): <code class=codehilite><span class=n>dtzar</span><span class=o>/</span><span class=n>helm</span><span class=o>-</span><span class=n>kubect</span></code>. So no need to roll our own.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=k>FROM</span><span class=s> dtzar/helm-kubectl:2.12.1</span>
<span class=k>COPY</span> Dockerfile /cnab/Dockerfile
<span class=k>COPY</span> app /cnab/app
<span class=k>COPY</span> kgi /usr/bin
<span class=k>RUN</span> ls -lath /cnab/app/
<span class=k>RUN</span> kgi --help
<span class=k>CMD</span> <span class=p>[</span><span class=s2>&quot;/cnab/app/run&quot;</span><span class=p>]</span>
</pre></div> </td></tr></table> <h5 id=dufflejson>duffle.json<a class=headerlink href=#dufflejson title="Permanent link">&para;</a></h5> <p>The only thing we need to add beyond the auto-generated file, is the credentials section.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=s2>&quot;credentials&quot;</span><span class=err>:</span> <span class=p>{</span>
    <span class=nt>&quot;kubeconfig&quot;</span><span class=p>:</span> <span class=p>{</span>
        <span class=nt>&quot;path&quot;</span><span class=p>:</span> <span class=s2>&quot;/cnab/app/kube-config&quot;</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <h5 id=kgi>kgi<a class=headerlink href=#kgi title="Permanent link">&para;</a></h5> <p>I pre-build a binary suitable for Linux that works in Alpine and included it in the CNAB folder.</p> <h5 id=run-script>run script<a class=headerlink href=#run-script title="Permanent link">&para;</a></h5> <p>First thing we need to make sure, is to configure the Kubeconfig location.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>export</span> <span class=nv>KUBECONFIG</span><span class=o>=</span><span class=s2>&quot;/cnab/app/kube-config&quot;</span>
</pre></div> </td></tr></table> <p>This should match what we defined in the <code class=codehilite><span class=n>duffle</span><span class=p>.</span><span class=n>json</span></code> configuration - as you might expect - to make sure it gets bound in the right location. The <code class=codehilite><span class=n>kubectl</span></code> command now knows which file to use.</p> <p>For the rest, we can do what we want, but convention tells us we need at least support <code class=codehilite><span class=n>status</span></code>, <code class=codehilite><span class=n>install</span></code> and <code class=codehilite><span class=n>uninstall</span></code>. I'm lazy and only implemented <code class=codehilite><span class=n>install</span></code> at the moment.</p> <p>In the install action, we will use the <code class=codehilite><span class=n>kgi</span></code> executable to install CloudBees Core and it's pre-requisites.</p> <p><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nv>action</span><span class=o>=</span><span class=nv>$CNAB_ACTION</span>

<span class=k>case</span> <span class=nv>$action</span> in
    install<span class=o>)</span>
        <span class=nb>echo</span> <span class=s2>&quot;[Install]&quot;</span>
        kgi validate kubectl
    <span class=p>;;</span>
<span class=k>esac</span>
</pre></div> </td></tr></table> For the rest, I recommend you look at the sources.</p> <h5 id=run-the-demo>Run the demo<a class=headerlink href=#run-the-demo title="Permanent link">&para;</a></h5> <p>First, we have to build the bundle.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>duffle build .
</pre></div> </td></tr></table> <p>Once the build succeeded, we can create a credentials configuration. This will be a separate configuration file managed by Duffle. This configuration config must then be used with any installation that requires it - which makes it reusable as well.</p> <p>We have to populate it with the credential. In this case a path to a kube-config file. If you do not have one that you can export - e.g. based on GCloud - you can create a new user/certificate with a script.</p> <p>This is taken from <a href=https://gravitational.com/blog/kubectl-gke/ >gravitational</a>, which were nice enough to create a script for doing so.</p> <p>You can find the script on <a href=https://github.com/gravitational/teleport/blob/master/examples/gke-auth/get-kubeconfig.sh>GitHub (get-kubeconfig.sh)</a>.</p> <p>Once you have that, store the end result at a decent place and configure it as your credential.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>duffle creds generate demo1 cnab-duffle-demo-1
</pre></div> </td></tr></table> <p>With the above command we can create a credential config object based on the build bundle <code class=codehilite><span class=n>cnab</span><span class=o>-</span><span class=n>duffle</span><span class=o>-</span><span class=n>demo</span><span class=o>-</span><span class=mi>1</span></code>. The credential object will be <code class=codehilite><span class=n>demo</span><span class=o>-</span><span class=mi>1</span></code>, which we can now use for installing.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>duffle install demo1 cnab-duffle-demo-1:1.0.0 -c demo1
</pre></div> </td></tr></table> <h4 id=further-reading>Further reading<a class=headerlink href=#further-reading title="Permanent link">&para;</a></h4> <ul> <li><a href=https://github.com/deislabs/duffle/blob/master/docs/guides/bundle-guide.md>Howto guide on creating a Duffle Bundle</a></li> <li><a href=https://github.com/deislabs/cnab-spec/blob/master/802-credential-sets.md>Howto on handling credentials</a></li> <li><a href=https://github.com/bitnami/cnab-bundles/tree/master/wordpress-k8s-rds>Wordpress with Kubernetes and AWS demo by Bitnami</a></li> <li><a href=https://github.com/deislabs/bundles>Example bundles</a></li> </ul> <h3 id=pulumi>Pulumi<a class=headerlink href=#pulumi title="Permanent link">&para;</a></h3> <p>Just pointing to the documentation and GitHub repository is a bit boring and most of all, lazy. So I've gone through the trouble to create a demo project that shows what Pulumi can do.</p> <p>One of the things to keep in mind is that Pulumi keeps its state in a remote location by default - Pulumi's SaaS service. Much like using an S3 bucket to store your Terraform state.</p> <p>The goal of the demo is to show what you can do with Pulumi. My personal opinion is that Pulumi is excellent for managing entire systems as code. From public cloud infrastructure to public open source resources right down to your applications and their configurations.</p> <p>The system that I've written with Pulumi is a CI/CD system running in a GKE cluster. The system contains Jenkins, Artifactory and a custom LDAP server.</p> <p>To make it interesting, we'll use different aspects of Pulumi to create the system. We will create the GKE cluster via Pulumi's wrapper for the <code class=codehilite><span class=n>gcloud</span></code> cli - in a similar way as JenkinsX does -, install Jenkins and Artifactory via Helm and install the LDAP server via Pulumi's Kubernetes resource classes.</p> <h4 id=steps-taken>Steps taken<a class=headerlink href=#steps-taken title="Permanent link">&para;</a></h4> <ul> <li>For more info <a href=pulumi.io>Pulumi.io</a></li> <li>install: <code class=codehilite><span class=n>brew</span> <span class=n>install</span> <span class=n>pulumi</span></code></li> <li>clone demo: <code class=codehilite><span class=n>git</span> <span class=n>clone</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>demomon</span><span class=o>/</span><span class=n>pulumi</span><span class=o>-</span><span class=n>demo</span><span class=o>-</span><span class=mi>1</span></code></li> <li>init stack: <code class=codehilite><span class=n>pulumi</span> <span class=n>stack</span> <span class=n>init</span> <span class=n>demomon</span><span class=o>-</span><span class=n>pulumi</span><span class=o>-</span><span class=n>demo</span><span class=o>-</span><span class=mi>1</span></code><ul> <li>connect to GitHub</li> </ul> </li> <li>set kubernetes config <code class=codehilite><span class=n>pulumi</span> <span class=n>config</span> <span class=k>set</span> <span class=n>kubernetes</span><span class=p>:</span><span class=n>context</span> <span class=n>gke_ps</span><span class=o>-</span><span class=n>dev</span><span class=o>-</span><span class=mi>201405</span><span class=n>_europe</span><span class=o>-</span><span class=n>west4_joostvdg</span><span class=o>-</span><span class=n>reg</span><span class=o>-</span><span class=n>dec18</span><span class=o>-</span><span class=mi>1</span></code></li> <li><code class=codehilite><span class=n>pulumi</span> <span class=n>config</span> <span class=k>set</span> <span class=n>isMinikube</span> <span class=k>false</span></code></li> <li>install npm resources: <code class=codehilite><span class=n>npm</span> <span class=n>install</span></code> (I've used the TypeScript demo's)</li> <li><code class=codehilite><span class=n>pulumi</span> <span class=n>config</span> <span class=k>set</span> <span class=n>username</span> <span class=n>administrator</span></code></li> <li><code class=codehilite><span class=n>pulumi</span> <span class=n>config</span> <span class=k>set</span> <span class=n>password</span> <span class=mi>3</span><span class=n>OvlgaockdnTsYRU5JAcgM1o</span> <span class=c1>--secret</span></code></li> <li><code class=codehilite><span class=n>pulumi</span> <span class=n>preview</span></code></li> <li>incase pulumi loses your stack: <code class=codehilite><span class=n>pulumi</span> <span class=n>stack</span> <span class=k>select</span> <span class=n>demomon</span><span class=o>-</span><span class=n>pulumi</span><span class=o>-</span><span class=n>demo</span><span class=o>-</span><span class=mi>1</span></code></li> <li><code class=codehilite><span class=n>pulumi</span> <span class=k>destroy</span></code></li> </ul> <p>Based on the following demo's:</p> <ul> <li><a href=https://pulumi.io/quickstart/kubernetes/tutorial-exposed-deployment.html>https://pulumi.io/quickstart/kubernetes/tutorial-exposed-deployment.html</a></li> <li><a href=https://github.com/pulumi/examples/tree/master/kubernetes-ts-jenkins>https://github.com/pulumi/examples/tree/master/kubernetes-ts-jenkins</a></li> </ul> <h4 id=artifactory-via-helm>Artifactory via Helm<a class=headerlink href=#artifactory-via-helm title="Permanent link">&para;</a></h4> <p>To install the helm charts of Artifactory using Helm, we will first need to add JFrog's repository.</p> <ul> <li><code class=codehilite><span class=n>helm</span> <span class=n>repo</span> <span class=k>add</span> <span class=n>jfrog</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>charts</span><span class=p>.</span><span class=n>jfrog</span><span class=p>.</span><span class=n>io</span></code></li> <li><code class=codehilite><span class=n>helm</span> <span class=n>repo</span> <span class=k>update</span></code></li> </ul> <h4 id=gke-cluster>GKE Cluster<a class=headerlink href=#gke-cluster title="Permanent link">&para;</a></h4> <p>Below is the code for the cluster.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>import</span> <span class=o>*</span> <span class=kr>as</span> <span class=nx>gcp</span> <span class=nx>from</span> <span class=s2>&quot;@pulumi/gcp&quot;</span><span class=p>;</span>
<span class=kr>import</span> <span class=o>*</span> <span class=kr>as</span> <span class=nx>k8s</span> <span class=nx>from</span> <span class=s2>&quot;@pulumi/kubernetes&quot;</span><span class=p>;</span>
<span class=kr>import</span> <span class=o>*</span> <span class=kr>as</span> <span class=nx>pulumi</span> <span class=nx>from</span> <span class=s2>&quot;@pulumi/pulumi&quot;</span><span class=p>;</span>
<span class=kr>import</span> <span class=p>{</span> <span class=nx>nodeCount</span><span class=p>,</span> <span class=nx>nodeMachineType</span><span class=p>,</span> <span class=nx>password</span><span class=p>,</span> <span class=nx>username</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&quot;./gke-config&quot;</span><span class=p>;</span>

<span class=kr>export</span> <span class=kr>const</span> <span class=nx>k8sCluster</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>gcp</span><span class=p>.</span><span class=nx>container</span><span class=p>.</span><span class=nx>Cluster</span><span class=p>(</span><span class=s2>&quot;gke-cluster&quot;</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;joostvdg-dec-2018-pulumi&quot;</span><span class=p>,</span>
    <span class=nx>initialNodeCount</span>: <span class=kt>nodeCount</span><span class=p>,</span>
    <span class=nx>nodeVersion</span><span class=o>:</span> <span class=s2>&quot;latest&quot;</span><span class=p>,</span>
    <span class=nx>minMasterVersion</span><span class=o>:</span> <span class=s2>&quot;latest&quot;</span><span class=p>,</span>
    <span class=nx>nodeConfig</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>machineType</span>: <span class=kt>nodeMachineType</span><span class=p>,</span>
        <span class=nx>oauthScopes</span><span class=o>:</span> <span class=p>[</span>
            <span class=s2>&quot;https://www.googleapis.com/auth/compute&quot;</span><span class=p>,</span>
            <span class=s2>&quot;https://www.googleapis.com/auth/devstorage.read_only&quot;</span><span class=p>,</span>
            <span class=s2>&quot;https://www.googleapis.com/auth/logging.write&quot;</span><span class=p>,</span>
            <span class=s2>&quot;https://www.googleapis.com/auth/monitoring&quot;</span>
        <span class=p>],</span>
    <span class=p>},</span>
<span class=p>});</span>
</pre></div> </td></tr></table> <h5 id=gke-config>GKE Config<a class=headerlink href=#gke-config title="Permanent link">&para;</a></h5> <p>As you could see, we import variables from a configuration file <code class=codehilite><span class=n>gke</span><span class=o>-</span><span class=n>config</span></code>.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Config</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&quot;@pulumi/pulumi&quot;</span><span class=p>;</span>
<span class=kr>const</span> <span class=nx>config</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Config</span><span class=p>();</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>nodeCount</span> <span class=o>=</span> <span class=nx>config</span><span class=p>.</span><span class=nx>getNumber</span><span class=p>(</span><span class=s2>&quot;nodeCount&quot;</span><span class=p>)</span> <span class=o>||</span> <span class=mi>3</span><span class=p>;</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>nodeMachineType</span> <span class=o>=</span> <span class=nx>config</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&quot;nodeMachineType&quot;</span><span class=p>)</span> <span class=o>||</span> <span class=s2>&quot;n1-standard-2&quot;</span><span class=p>;</span>
<span class=c1>// username is the admin username for the cluster.</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>username</span> <span class=o>=</span> <span class=nx>config</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&quot;username&quot;</span><span class=p>)</span> <span class=o>||</span> <span class=s2>&quot;admin&quot;</span><span class=p>;</span>
<span class=c1>// password is the password for the admin user in the cluster.</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>password</span> <span class=o>=</span> <span class=nx>config</span><span class=p>.</span><span class=nx>require</span><span class=p>(</span><span class=s2>&quot;password&quot;</span><span class=p>);</span>
</pre></div> </td></tr></table> <h5 id=kubeconfig>Kubeconfig<a class=headerlink href=#kubeconfig title="Permanent link">&para;</a></h5> <p>As you probably will want to install other things (Helm charts, services) inside this cluster, we need to make sure we get the <code class=codehilite><span class=n>kubeconfig</span></code> file of our cluster - which is yet to be created. Below is the code - courtesy of <a href=https://github.com/pulumi/examples/tree/master/gcp-ts-gke>Pulumi's GKE Example</a> - that generates and exports the Kubernetes Client Configuration.</p> <p>This client configuration can then be used by Helm charts or other Kubernetes services. Pulumi will then also understand it depends on the cluster and create/update it first before moving on to the others.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=c1>// Manufacture a GKE-style Kubeconfig. Note that this is slightly &quot;different&quot; because of the way GKE requires</span>
<span class=c1>// gcloud to be in the picture for cluster authentication (rather than using the client cert/key directly).</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>k8sConfig</span> <span class=o>=</span> <span class=nx>pulumi</span><span class=p>.</span>
    <span class=nx>all</span><span class=p>([</span> <span class=nx>k8sCluster</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=nx>k8sCluster</span><span class=p>.</span><span class=nx>endpoint</span><span class=p>,</span> <span class=nx>k8sCluster</span><span class=p>.</span><span class=nx>masterAuth</span> <span class=p>]).</span>
    <span class=nx>apply</span><span class=p>(([</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>endpoint</span><span class=p>,</span> <span class=nx>auth</span> <span class=p>])</span> <span class=o>=&gt;</span> <span class=p>{</span>
        <span class=kr>const</span> <span class=nx>context</span> <span class=o>=</span> <span class=sb>`</span><span class=si>${</span><span class=nx>gcp</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>project</span><span class=si>}</span><span class=sb>_</span><span class=si>${</span><span class=nx>gcp</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>zone</span><span class=si>}</span><span class=sb>_</span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
        <span class=k>return</span> <span class=sb>`apiVersion: v1</span>
<span class=sb>clusters:</span>
<span class=sb>- cluster:</span>
<span class=sb>    certificate-authority-data: </span><span class=si>${</span><span class=nx>auth</span><span class=p>.</span><span class=nx>clusterCaCertificate</span><span class=si>}</span><span class=sb></span>
<span class=sb>    server: https://</span><span class=si>${</span><span class=nx>endpoint</span><span class=si>}</span><span class=sb></span>
<span class=sb>  name: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>contexts:</span>
<span class=sb>- context:</span>
<span class=sb>    cluster: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>    user: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>  name: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>current-context: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>kind: Config</span>
<span class=sb>preferences: {}</span>
<span class=sb>users:</span>
<span class=sb>- name: </span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=sb></span>
<span class=sb>  user:</span>
<span class=sb>    auth-provider:</span>
<span class=sb>      config:</span>
<span class=sb>        cmd-args: config config-helper --format=json</span>
<span class=sb>        cmd-path: gcloud</span>
<span class=sb>        expiry-key: &#39;{.credential.token_expiry}&#39;</span>
<span class=sb>        token-key: &#39;{.credential.access_token}&#39;</span>
<span class=sb>      name: gcp</span>
<span class=sb>`</span><span class=p>;</span>
    <span class=p>});</span>

<span class=c1>// Export a Kubernetes provider instance that uses our cluster from above.</span>
<span class=kr>export</span> <span class=kr>const</span> <span class=nx>k8sProvider</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>k8s</span><span class=p>.</span><span class=nx>Provider</span><span class=p>(</span><span class=s2>&quot;gkeK8s&quot;</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>kubeconfig</span>: <span class=kt>k8sConfig</span><span class=p>,</span>
<span class=p>});</span>
</pre></div> </td></tr></table> <h4 id=pulumi-gcp-config>Pulumi GCP Config<a class=headerlink href=#pulumi-gcp-config title="Permanent link">&para;</a></h4> <ul> <li><a href=https://github.com/pulumi/examples/blob/master/gcp-ts-gke/README.md>https://github.com/pulumi/examples/blob/master/gcp-ts-gke/README.md</a></li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nb>export</span> <span class=nv>GCP_PROJECT</span><span class=o>=</span>...
<span class=nb>export</span> <span class=nv>GCP_ZONE</span><span class=o>=</span>europe-west4-a
<span class=nb>export</span> <span class=nv>CLUSTER_PASSWORD</span><span class=o>=</span>...
<span class=nb>export</span> <span class=nv>GCP_SA_NAME</span><span class=o>=</span>...
</pre></div> </td></tr></table> <p>Make sure you have a Google SA (Service Account) by that name first, as you can <a href=https://pulumi.io/quickstart/gcp/index.html>read here</a>. For me it worked best to NOT set any environment variables mentioned. They invairably caused authentication or authorization issues. Just make sure the SA account and it's credential file (see below) are authorized and the <code class=codehilite><span class=n>gcloud</span></code> cli works.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>gcloud iam service-accounts keys create gcp-credentials.json <span class=se>\</span>
    --iam-account <span class=si>${</span><span class=nv>GCP_SA_NAME</span><span class=si>}</span>@<span class=si>${</span><span class=nv>GCP_PROJECT</span><span class=si>}</span>.iam.gserviceaccount.com
gcloud auth activate-service-account --key-file gcp-credentials.json
gcloud auth application-default login
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span>pulumi config <span class=nb>set</span> gcp:project <span class=si>${</span><span class=nv>GCP_PROJECT</span><span class=si>}</span>
pulumi config <span class=nb>set</span> gcp:zone <span class=si>${</span><span class=nv>GCP_ZONE</span><span class=si>}</span>
pulumi config <span class=nb>set</span> password --secret <span class=si>${</span><span class=nv>CLUSTER_PASSWORD</span><span class=si>}</span>
</pre></div> </td></tr></table> <h5 id=post-cluster-creation>Post Cluster Creation<a class=headerlink href=#post-cluster-creation title="Permanent link">&para;</a></h5> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>gcloud container clusters get-credentials joostvdg-dec-2018-pulumi
kubectl create clusterrolebinding cluster-admin-binding  --clusterrole cluster-admin  --user <span class=k>$(</span>gcloud config get-value account<span class=k>)</span>
</pre></div> </td></tr></table> <h5 id=install-failed>Install failed<a class=headerlink href=#install-failed title="Permanent link">&para;</a></h5> <p>Failed to install <code class=codehilite><span class=n>kubernetes</span><span class=o>:</span><span class=n>rbac</span><span class=o>.</span><span class=na>authorization</span><span class=o>.</span><span class=na>k8s</span><span class=o>.</span><span class=na>io</span><span class=o>:</span><span class=n>Role</span> <span class=n>artifactory</span><span class=o>-</span><span class=n>artifactory</span></code>.</p> <p>Probably due to missing rights, so probably have to execute the admin binding before the helm charts.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>error: Plan apply failed: roles.rbac.authorization.k8s.io <span class=s2>&quot;artifactory-artifactory&quot;</span> is forbidden: attempt to grant extra privileges: ...
</pre></div> </td></tr></table> <h4 id=helm-charts>Helm Charts<a class=headerlink href=#helm-charts title="Permanent link">&para;</a></h4> <p>Using Pulumi to install a Helm Chart feels a bit like adding layers of wrapping upon wrapping. The power of Pulumi becomes visible when using more than one related service on the same cluster - for example a SDLC Tool Chain.</p> <p>This example application installs two helm charts, Jenkins and Artifactory, on a GKE cluster that is also created and managed by Pulumi.</p> <p>Below is an example of installing a Helm chart of Jenkins, where we provide the Kubernetes config from the GKE cluster as Provider. This way, Pulumi knows it must install the helm chart in that GKE cluster and not in the current Kubeconfig.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>k8sProvider</span><span class=p>,</span> <span class=nx>k8sConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&quot;./gke-cluster&quot;</span><span class=p>;</span>

<span class=kr>const</span> <span class=nx>jenkins</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>k8s</span><span class=p>.</span><span class=nx>helm</span><span class=p>.</span><span class=nx>v2</span><span class=p>.</span><span class=nx>Chart</span><span class=p>(</span><span class=s2>&quot;jenkins&quot;</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>repo</span><span class=o>:</span> <span class=s2>&quot;stable&quot;</span><span class=p>,</span>
    <span class=nx>version</span><span class=o>:</span> <span class=s2>&quot;0.25.1&quot;</span><span class=p>,</span>
    <span class=nx>chart</span><span class=o>:</span> <span class=s2>&quot;jenkins&quot;</span><span class=p>,</span>
    <span class=p>},</span> <span class=p>{</span> 
        <span class=nx>providers</span><span class=o>:</span> <span class=p>{</span> <span class=nx>kubernetes</span>: <span class=kt>k8sProvider</span> <span class=p>}</span>
    <span class=p>}</span>
<span class=p>);</span>
</pre></div> </td></tr></table> <h4 id=deployment-service>Deployment &amp; Service<a class=headerlink href=#deployment-service title="Permanent link">&para;</a></h4> <p>First, make sure you have an interface for the configuration arguments.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>export</span> <span class=kr>interface</span> <span class=nx>LdapArgs</span> <span class=p>{</span>
    <span class=nx>readonly</span> <span class=nx>name</span>: <span class=kt>string</span><span class=p>,</span>
    <span class=nx>readonly</span> <span class=nx>imageName</span>: <span class=kt>string</span><span class=p>,</span>
    <span class=nx>readonly</span> <span class=nx>imageTag</span>: <span class=kt>string</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Then, create a exportable Pulumi resource class that can be reused.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>export</span> <span class=kr>class</span> <span class=nx>LdapInstallation</span> <span class=kr>extends</span> <span class=nx>pulumi</span><span class=p>.</span><span class=nx>ComponentResource</span> <span class=p>{</span>
    <span class=kr>public</span> <span class=nx>readonly</span> <span class=nx>deployment</span>: <span class=kt>k8s.apps.v1.Deployment</span><span class=p>;</span>
    <span class=kr>public</span> <span class=nx>readonly</span> <span class=nx>service</span>: <span class=kt>k8s.core.v1.Service</span><span class=p>;</span>

    <span class=c1>// constructor</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>Inside the constructor placehold we will create a constructor method. It will do all the configuration we need to do for this resource, in this case a Kubernetes Service and Deployment.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>constructor</span><span class=p>(</span><span class=nx>args</span>: <span class=kt>LdapArgs</span><span class=p>)</span> <span class=p>{</span>
    <span class=kr>super</span><span class=p>(</span><span class=s2>&quot;k8stypes:service:LdapInstallation&quot;</span><span class=p>,</span> <span class=nx>args</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=p>{});</span>
    <span class=kr>const</span> <span class=nx>labels</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>app</span>: <span class=kt>args.name</span> <span class=p>};</span>
    <span class=kr>const</span> <span class=nx>name</span> <span class=o>=</span> <span class=nx>args</span><span class=p>.</span><span class=nx>name</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>First Kubernetes resource to create is a container specification for the Deployment.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=nx>container</span>: <span class=kt>k8stypes.core.v1.Container</span> <span class=o>=</span> <span class=p>{</span>
    <span class=nx>name</span><span class=p>,</span>
    <span class=nx>image</span>: <span class=kt>args.imageName</span> <span class=o>+</span> <span class=s2>&quot;:&quot;</span> <span class=o>+</span> <span class=nx>args</span><span class=p>.</span><span class=nx>imageTag</span><span class=p>,</span>
    <span class=nx>resources</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>requests</span><span class=o>:</span> <span class=p>{</span> <span class=nx>cpu</span><span class=o>:</span> <span class=s2>&quot;100m&quot;</span><span class=p>,</span> <span class=nx>memory</span><span class=o>:</span> <span class=s2>&quot;200Mi&quot;</span> <span class=p>},</span>
        <span class=nx>limits</span><span class=o>:</span> <span class=p>{</span> <span class=nx>cpu</span><span class=o>:</span> <span class=s2>&quot;100m&quot;</span><span class=p>,</span> <span class=nx>memory</span><span class=o>:</span> <span class=s2>&quot;200Mi&quot;</span> <span class=p>},</span>
    <span class=p>},</span>
    <span class=nx>ports</span><span class=o>:</span> <span class=p>[{</span>
            <span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;ldap&quot;</span><span class=p>,</span><span class=nx>containerPort</span>: <span class=kt>1389</span><span class=p>,</span>
        <span class=p>},</span>
    <span class=p>]</span>
<span class=p>};</span>
</pre></div> </td></tr></table> <p>As the configuration arguments can be any TypeScript type, you can allow people to override entire segments (such as Resources). Which you would do as follows:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span>    <span class=nx>resources</span>: <span class=kt>args.resources</span> <span class=o>||</span> <span class=p>{</span>
        <span class=nx>requests</span><span class=o>:</span> <span class=p>{</span> <span class=nx>cpu</span><span class=o>:</span> <span class=s2>&quot;100m&quot;</span><span class=p>,</span> <span class=nx>memory</span><span class=o>:</span> <span class=s2>&quot;200Mi&quot;</span> <span class=p>},</span>
        <span class=nx>limits</span><span class=o>:</span> <span class=p>{</span> <span class=nx>cpu</span><span class=o>:</span> <span class=s2>&quot;100m&quot;</span><span class=p>,</span> <span class=nx>memory</span><span class=o>:</span> <span class=s2>&quot;200Mi&quot;</span> <span class=p>},</span>
    <span class=p>},</span>
</pre></div> </td></tr></table> <p>The Deployment and Service construction are quite similar.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=k>this</span><span class=p>.</span><span class=nx>deployment</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>k8s</span><span class=p>.</span><span class=nx>apps</span><span class=p>.</span><span class=nx>v1</span><span class=p>.</span><span class=nx>Deployment</span><span class=p>(</span><span class=nx>args</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>spec</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>selector</span><span class=o>:</span> <span class=p>{</span> <span class=nx>matchLabels</span>: <span class=kt>labels</span> <span class=p>},</span>
        <span class=nx>replicas</span>: <span class=kt>1</span><span class=p>,</span>
        <span class=nx>template</span><span class=o>:</span> <span class=p>{</span>
            <span class=nx>metadata</span><span class=o>:</span> <span class=p>{</span> <span class=nx>labels</span>: <span class=kt>labels</span> <span class=p>},</span>
            <span class=nx>spec</span><span class=o>:</span> <span class=p>{</span> <span class=nx>containers</span><span class=o>:</span> <span class=p>[</span> <span class=nx>container</span> <span class=p>]</span> <span class=p>},</span>
        <span class=p>},</span>
    <span class=p>},</span>
<span class=p>},{</span> <span class=nx>provider</span>: <span class=kt>cluster.k8sProvider</span> <span class=p>});</span>
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=k>this</span><span class=p>.</span><span class=nx>service</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>k8s</span><span class=p>.</span><span class=nx>core</span><span class=p>.</span><span class=nx>v1</span><span class=p>.</span><span class=nx>Service</span><span class=p>(</span><span class=nx>args</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>metadata</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>labels</span>: <span class=kt>this.deployment.metadata.apply</span><span class=p>(</span><span class=nx>meta</span> <span class=o>=&gt;</span> <span class=nx>meta</span><span class=p>.</span><span class=nx>labels</span><span class=p>),</span>
    <span class=p>},</span>
    <span class=nx>spec</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>ports</span><span class=o>:</span> <span class=p>[{</span>
                <span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;ldap&quot;</span><span class=p>,</span> <span class=nx>port</span>: <span class=kt>389</span><span class=p>,</span> <span class=nx>targetPort</span><span class=o>:</span> <span class=s2>&quot;ldap&quot;</span> <span class=p>,</span> <span class=nx>protocol</span><span class=o>:</span> <span class=s2>&quot;TCP&quot;</span>
            <span class=p>},</span>
        <span class=p>],</span>
        <span class=nx>selector</span>: <span class=kt>this.deployment.spec.apply</span><span class=p>(</span><span class=nx>spec</span> <span class=o>=&gt;</span> <span class=nx>spec</span><span class=p>.</span><span class=nx>template</span><span class=p>.</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>labels</span><span class=p>),</span>
        <span class=nx>type</span><span class=o>:</span> <span class=s2>&quot;ClusterIP&quot;</span><span class=p>,</span>
    <span class=p>},</span>
<span class=p>},</span> <span class=p>{</span> <span class=nx>provider</span>: <span class=kt>cluster.k8sProvider</span> <span class=p>});</span>
</pre></div> </td></tr></table> <h2 id=jfrog-jenkins-challenge>JFrog Jenkins Challenge<a class=headerlink href=#jfrog-jenkins-challenge title="Permanent link">&para;</a></h2> <p>Visited the stand of JFrog where they had stories about two main products: Artifactory and X-Ray.</p> <p>For both there is a Challenge, <a href=https://jfrog.com/content/xray-challenge/ >an X-Ray Challenge</a> and <a href=https://jfrog.com/content/jenkins-challenge>a Jenkins &amp; Artifactory Challenge</a>.</p> <h3 id=jenkins-challenge>Jenkins Challenge<a class=headerlink href=#jenkins-challenge title="Permanent link">&para;</a></h3> <p>The instructions for the Challenge were simply, follow what is stated <a href=https://github.com/jbaruch/jenkins-challenge>in their GitHub repository</a> and email a screenshot of the result.</p> <p>The instruction were as follows:</p> <ol> <li>Get an Artifactory instance (you can start a free trial on prem or in the cloud)</li> <li>Install Jenkins</li> <li>Install Artifactory Jenkins Plugin</li> <li>Add Artifactory credentials to Jenkins Credentials</li> <li>Create a new pipeline job</li> <li>Use the Artifactory Plugin DSL documentation to complete the following script:</li> </ol> <p>With a Scripted Pipeline as starting point:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>node</span> <span class=o>{</span>
    <span class=kt>def</span> <span class=n>rtServer</span>
    <span class=kt>def</span> <span class=n>rtGradle</span>
    <span class=kt>def</span> <span class=n>buildInfo</span>
    <span class=nf>stage</span><span class=o>(</span><span class=s1>&#39;Preparation&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>git</span> <span class=s1>&#39;https://github.com/jbaruch/gradle-example.git&#39;</span>
        <span class=c1>// create a new Artifactory server using the credentials defined in Jenkins </span>
        <span class=c1>// create a new Gradle build</span>
        <span class=c1>// set the resolver to the Gradle build to resolve from Artifactory</span>
        <span class=c1>// set the deployer to the Gradle build to deploy to Artifactory</span>
        <span class=c1>// declare that your gradle script does not use Artifactory plugin</span>
        <span class=c1>// declare that your gradle script uses Gradle wrapper</span>
    <span class=o>}</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Build&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=c1>//run the artifactoryPublish gradle task and collect the build info</span>
    <span class=o>}</span>
    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Publish Build Info&#39;</span><span class=o>)</span> <span class=o>{</span>
        <span class=c1>//collect the environment variables to build info</span>
        <span class=c1>//publish the build info</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <p>I don't like scripted, so I opted for Declarative with Jenkins in Kubernetes with the Jenkins Kubernetes plugin.</p> <p>Steps I took:</p> <ul> <li>get a trial license from the <a href=https://www.jfrog.com/artifactory/free-trial/ >JFrog website</a></li> <li>install Artifactory<ul> <li>and copy in the license when prompted</li> <li>change admin password</li> <li>create local maven repo 'libs-snapshot-local'</li> <li>create remote maven repo 'jcenter' (default remote value is jcenter, so only have to set the name)</li> </ul> </li> <li>install Jenkins<ul> <li>Artifactory plugin</li> <li>Kubernetes plugin</li> </ul> </li> <li>add Artifactory username/password as credential in Jenkins</li> <li>create a gradle application (Spring boot via start.spring.io) which <a href=https://github.com/demomon/gradle-jenkins-challenge>you can find here</a></li> <li>create a Jenkinsfile</li> </ul> <h4 id=installing-artifactory>Installing Artifactory<a class=headerlink href=#installing-artifactory title="Permanent link">&para;</a></h4> <p>I installed Artifactory via Helm. JFrog has their own Helm repository - of course, would weird otherwise tbh - and you have to add that first.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm repo add jfrog https://charts.jfrog.io
helm install --name artifactory stable/artifactory
</pre></div> </td></tr></table> <h4 id=jenkinsfile>Jenkinsfile<a class=headerlink href=#jenkinsfile title="Permanent link">&para;</a></h4> <p>This uses the Gradle wrapper - as per instructions in the challenge.</p> <p>So we can use the standard JNLP container, which is default, so <code class=codehilite><span class=n>agent</span> <span class=k>any</span></code> will do.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>pipeline</span> <span class=o>{</span>
    <span class=n>agent</span> <span class=n>any</span>
    <span class=n>environment</span> <span class=o>{</span>
        <span class=n>rtServer</span>  <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>rtGradle</span>  <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>buildInfo</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>artifactoryServerAddress</span> <span class=o>=</span> <span class=s1>&#39;http://..../artifactory&#39;</span>
    <span class=o>}</span>
    <span class=n>stages</span> <span class=o>{</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Test Container&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;gradle&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>sh</span> <span class=s1>&#39;which gradle&#39;</span>
                    <span class=n>sh</span> <span class=s1>&#39;uname -a&#39;</span>
                    <span class=n>sh</span> <span class=s1>&#39;gradle -version&#39;</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Checkout&#39;</span><span class=o>){</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>git</span> <span class=s1>&#39;https://github.com/demomon/gradle-jenkins-challenge.git&#39;</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Preparation&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span><span class=o>{</span>
                    <span class=c1>// create a new Artifactory server using the credentials defined in Jenkins </span>
                    <span class=n>rtServer</span> <span class=o>=</span> <span class=n>Artifactory</span><span class=o>.</span><span class=na>newServer</span> <span class=nl>url:</span> <span class=n>artifactoryServerAddress</span><span class=o>,</span> <span class=nl>credentialsId:</span> <span class=s1>&#39;art-admin&#39;</span>

                    <span class=c1>// create a new Gradle build</span>
                    <span class=n>rtGradle</span> <span class=o>=</span> <span class=n>Artifactory</span><span class=o>.</span><span class=na>newGradleBuild</span><span class=o>()</span>

                    <span class=c1>// set the resolver to the Gradle build to resolve from Artifactory</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>resolver</span> <span class=nl>repo:</span><span class=s1>&#39;jcenter&#39;</span><span class=o>,</span> <span class=nl>server:</span> <span class=n>rtServer</span>

                    <span class=c1>// set the deployer to the Gradle build to deploy to Artifactory</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>deployer</span> <span class=nl>repo:</span><span class=s1>&#39;libs-snapshot-local&#39;</span><span class=o>,</span>  <span class=nl>server:</span> <span class=n>rtServer</span>

                    <span class=c1>// declare that your gradle script does not use Artifactory plugin</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>usesPlugin</span> <span class=o>=</span> <span class=kc>false</span>

                    <span class=c1>// declare that your gradle script uses Gradle wrapper</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>useWrapper</span> <span class=o>=</span> <span class=kc>true</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Build&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span> <span class=o>{</span>
                    <span class=c1>//run the artifactoryPublish gradle task and collect the build info</span>
                    <span class=n>buildInfo</span> <span class=o>=</span> <span class=n>rtGradle</span><span class=o>.</span><span class=na>run</span> <span class=nl>buildFile:</span> <span class=s1>&#39;build.gradle&#39;</span><span class=o>,</span> <span class=nl>tasks:</span> <span class=s1>&#39;clean build artifactoryPublish&#39;</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Publish Build Info&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span> <span class=o>{</span>
                    <span class=c1>//collect the environment variables to build info</span>
                    <span class=n>buildInfo</span><span class=o>.</span><span class=na>env</span><span class=o>.</span><span class=na>capture</span> <span class=o>=</span> <span class=kc>true</span>
                    <span class=c1>//publish the build info</span>
                    <span class=n>rtServer</span><span class=o>.</span><span class=na>publishBuildInfo</span> <span class=n>buildInfo</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h4 id=jenkinsfile-without-gradle-wrapper>Jenkinsfile without Gradle Wrapper<a class=headerlink href=#jenkinsfile-without-gradle-wrapper title="Permanent link">&para;</a></h4> <p>I'd rather not install the Gradle tool if I can just use a pre-build container with it.</p> <p>Unfortunately, to use it correctly with the Artifactory plugin and a Jenkins Kubernetes plugin, we need to do two things.</p> <ol> <li>create a <code class=codehilite><span class=n>Gradle</span></code> Tool in the Jenkins master<ul> <li>because the Artifactory plugin expects a <code class=codehilite><span class=n>Jenkins</span> <span class=n>Tool</span></code> object, not a location</li> <li>Manage Jenkins -&gt; Global Tool Configuration -&gt; Gradle -&gt; Add</li> <li>As value supply <code class=codehilite><span class=o>/</span><span class=n>usr</span></code>, the Artifactory build will add <code class=codehilite><span class=o>/</span><span class=n>gradle</span><span class=o>/</span><span class=n>bin</span></code> to it automatically</li> </ul> </li> <li>set the user of build Pod to id <code class=codehilite><span class=mi>1000</span></code> explicitly<ul> <li>else the build will not be allowed to touch files in <code class=codehilite><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>jenkins</span><span class=o>/</span><span class=n>workspace</span></code></li> </ul> </li> </ol> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>pipeline</span> <span class=o>{</span>
    <span class=n>agent</span> <span class=o>{</span>
        <span class=n>kubernetes</span> <span class=o>{</span>
        <span class=n>label</span> <span class=s1>&#39;mypod&#39;</span>
        <span class=n>yaml</span> <span class=s2>&quot;&quot;&quot;apiVersion: v1</span>
<span class=s2>kind: Pod</span>
<span class=s2>spec:</span>
<span class=s2>  securityContext:</span>
<span class=s2>    runAsUser: 1000</span>
<span class=s2>    fsGroup: 1000</span>
<span class=s2>  containers:</span>
<span class=s2>  - name: gradle</span>
<span class=s2>    image: gradle:4.10-jdk-alpine</span>
<span class=s2>    command: [&#39;cat&#39;]</span>
<span class=s2>    tty: true</span>
<span class=s2>&quot;&quot;&quot;</span>
        <span class=o>}</span>
    <span class=o>}</span>
    <span class=n>environment</span> <span class=o>{</span>
        <span class=n>rtServer</span>  <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>rtGradle</span>  <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>buildInfo</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
        <span class=n>CONTAINER_GRADLE_TOOL</span> <span class=o>=</span> <span class=s1>&#39;/usr/bin/gradle&#39;</span>
    <span class=o>}</span>
    <span class=n>stages</span> <span class=o>{</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Test Container&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>container</span><span class=o>(</span><span class=s1>&#39;gradle&#39;</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>sh</span> <span class=s1>&#39;which gradle&#39;</span>
                    <span class=n>sh</span> <span class=s1>&#39;uname -a&#39;</span>
                    <span class=n>sh</span> <span class=s1>&#39;gradle -version&#39;</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Checkout&#39;</span><span class=o>){</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=c1>// git &#39;https://github.com/demomon/gradle-jenkins-challenge.git&#39;</span>
        <span class=n>checkout</span> <span class=n>scm</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Preparation&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span><span class=o>{</span>
                    <span class=c1>// create a new Artifactory server using the credentials defined in Jenkins </span>
                    <span class=n>rtServer</span> <span class=o>=</span> <span class=n>Artifactory</span><span class=o>.</span><span class=na>newServer</span> <span class=nl>url:</span> <span class=s1>&#39;http://35.204.238.14/artifactory&#39;</span><span class=o>,</span> <span class=nl>credentialsId:</span> <span class=s1>&#39;art-admin&#39;</span>

                    <span class=c1>// create a new Gradle build</span>
                    <span class=n>rtGradle</span> <span class=o>=</span> <span class=n>Artifactory</span><span class=o>.</span><span class=na>newGradleBuild</span><span class=o>()</span>

                    <span class=c1>// set the resolver to the Gradle build to resolve from Artifactory</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>resolver</span> <span class=nl>repo:</span><span class=s1>&#39;jcenter&#39;</span><span class=o>,</span> <span class=nl>server:</span> <span class=n>rtServer</span>

                    <span class=c1>// set the deployer to the Gradle build to deploy to Artifactory</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>deployer</span> <span class=nl>repo:</span><span class=s1>&#39;libs-snapshot-local&#39;</span><span class=o>,</span>  <span class=nl>server:</span> <span class=n>rtServer</span>

                    <span class=c1>// declare that your gradle script does not use Artifactory plugin</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>usesPlugin</span> <span class=o>=</span> <span class=kc>false</span>

                    <span class=c1>// declare that your gradle script uses Gradle wrapper</span>
                    <span class=n>rtGradle</span><span class=o>.</span><span class=na>useWrapper</span> <span class=o>=</span> <span class=kc>true</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Build&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=c1>//run the artifactoryPublish gradle task and collect the build info</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span> <span class=o>{</span>
                    <span class=n>buildInfo</span> <span class=o>=</span> <span class=n>rtGradle</span><span class=o>.</span><span class=na>run</span> <span class=nl>buildFile:</span> <span class=s1>&#39;build.gradle&#39;</span><span class=o>,</span> <span class=nl>tasks:</span> <span class=s1>&#39;clean build artifactoryPublish&#39;</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Publish Build Info&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=c1>//collect the environment variables to build info</span>
            <span class=c1>//publish the build info</span>
            <span class=n>steps</span> <span class=o>{</span>
                <span class=n>script</span> <span class=o>{</span>
                    <span class=n>buildInfo</span><span class=o>.</span><span class=na>env</span><span class=o>.</span><span class=na>capture</span> <span class=o>=</span> <span class=kc>true</span>
                    <span class=n>rtServer</span><span class=o>.</span><span class=na>publishBuildInfo</span> <span class=n>buildInfo</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> </td></tr></table> <h2 id=docker-security-standards>Docker security &amp; standards<a class=headerlink href=#docker-security-standards title="Permanent link">&para;</a></h2> <ul> <li>security takes place in every layer/lifecycle phase</li> <li>for scaling, security needs to be part of developer's day-to-day</li> <li>as everything is code, anything part of the sdlc should be secure and auditable</li> <li>use an admission controller</li> <li>network policies</li> <li>automate your security processes</li> <li>expand your security automation by adding learnings</li> </ul> <p><img alt="Secure 1" src=../../images/dockerconeu2018/secure-1.jpg></p> <p><img alt="Secure 2" src=../../images/dockerconeu2018/secure-2.jpg></p> <h2 id=docker-java-cicd>Docker &amp; Java &amp; CICD<a class=headerlink href=#docker-java-cicd title="Permanent link">&para;</a></h2> <ul> <li>telepresence</li> <li>Distroless (google mini os)</li> <li>OpenJ9</li> <li>Portala (for jdk 12)</li> <li>wagoodman/dive</li> <li>use jre for the runtime instead of jdk</li> <li>buildkit can use mounttarget for local caches</li> <li>add labels with Metadata (depency trees)</li> <li>grafeas &amp; kritis</li> <li>FindSecBugs</li> <li>org.owasp:dependency-check-maven</li> <li>arminc/clair-scanner</li> <li>jlink = in limbo</li> </ul> <h2 id=docker-windows>Docker &amp; Windows<a class=headerlink href=#docker-windows title="Permanent link">&para;</a></h2> <ul> <li>specific base images for different use cases</li> <li>Docker capabilities heavily depend on Windows Server version</li> </ul> <p><img alt="Windows 1" src=../../images/dockerconeu2018/windows-1.jpg></p> <p><img alt="Windows 2" src=../../images/dockerconeu2018/windows-2.jpg></p> <p><img alt="Windows 3" src=../../images/dockerconeu2018/windows-3.jpg></p> <p><img alt="Windows 4" src=../../images/dockerconeu2018/windows-4.jpg></p> <h2 id=other>Other<a class=headerlink href=#other title="Permanent link">&para;</a></h2> <h3 id=docker-pipeline>Docker pipeline<a class=headerlink href=#docker-pipeline title="Permanent link">&para;</a></h3> <ul> <li>Dind + privileged</li> <li>mount socket</li> <li>windows &amp; linux</li> <li>Windows build agent provisioning with docker EE &amp; Jenkins</li> <li>Docker swarm update_config</li> </ul> <h3 id=idea-build-a-dynamic-cicd-platform-with-kubernetes>Idea: build a dynamic ci/cd platform with kubernetes<a class=headerlink href=#idea-build-a-dynamic-cicd-platform-with-kubernetes title="Permanent link">&para;</a></h3> <ul> <li>jenkins evergreen + jcasc</li> <li>kubernetes plugin</li> <li>gitops pipeline</li> <li>AKS + virtual kubelet + ACI</li> <li>Jenkins + EC2 Pluging + ECS/Fargate</li> <li>jenkins agent as ecs task (fargate agent)</li> <li>docker on windows, only on ECS</li> </ul> <h3 id=apply-diplomacy-to-code-review>Apply Diplomacy to Code Review<a class=headerlink href=#apply-diplomacy-to-code-review title="Permanent link">&para;</a></h3> <ul> <li>apply diplomacy to code review</li> <li>always positive</li> <li>remove human resistantance with inclusive language</li> <li>improvement focused</li> <li>persist, kindly</li> </ul> <p><img alt="Diplomacy Language" src=../../images/dockerconeu2018/diplomacy-1.jpg></p> <h3 id=citizens-bank-journey>Citizens Bank journey<a class=headerlink href=#citizens-bank-journey title="Permanent link">&para;</a></h3> <ul> <li>started with swarm, grew towards kubernetes (ucp)</li> <li>elk stack, centralised operations cluster</li> </ul> <p><img alt="Citizens 1" src=../../images/dockerconeu2018/citizens-1.jpg></p> <p><img alt="Citizens 2" src=../../images/dockerconeu2018/citizens-2.jpg></p> <h3 id=docker-ee-assemble>Docker EE - Assemble<a class=headerlink href=#docker-ee-assemble title="Permanent link">&para;</a></h3> <p>Docker EE now has a binary called <code class=codehilite><span class=n>docker</span><span class=o>-</span><span class=n>assemble</span></code>. This allows you to build a Docker image directly from something like a pom.xml, much like JIB.</p> <p><img alt="DockerAssemble MetaData" src=../../images/dockerconeu2018/metadata-1.jpg></p> <h3 id=other_1>Other<a class=headerlink href=#other_1 title="Permanent link">&para;</a></h3> <p><img alt=Random src=../../images/dockerconeu2018/random-1.jpg></p> <h2 id=__comments>Comments</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://joostvdg.github.io/blogs/dockercon-eu-2018/";
      this.page.identifier =
        "/blogs/dockercon-eu-2018/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//joostvdg-github-io.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../monitor-jenkins-on-k8s/cloudbees/ title=CloudBees class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> CloudBees </span> </div> </a> <a href=../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Single Sign On - AzureAD </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Joost van der Griendt </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=https://github.com/joostvdg class="md-footer-social__link fa fa-github"></a> <a href=https://twitter.com/joost_vdg class="md-footer-social__link fa fa-twitter"></a> <a href=https://linkedin.com/in/joostvdg class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.245445c6.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>