<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Setup Single Sign-On for Jenkins with Apache Keycloak"><link href=https://joostvdg.github.io/blogs/kubernetes-sso-keycloak/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.2"><title>SSO Jenkins With Keycloak On Kubernetes</title><link rel=stylesheet href=../../assets/stylesheets/application.30686662.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#fb8c00><script src=../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-145385967-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=orange data-md-color-accent=red> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#single-sign-on-on-kubernetes-with-keycloak tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-header-nav__button md-logo"> <i class=md-icon>public</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> J's Software Development Pages </span> <span class=md-header-nav__topic> SSO Jenkins With Keycloak On Kubernetes </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../jenkins-pipeline-support-tool/ class="md-tabs__link md-tabs__link--active"> Blogs </a> </li> <li class=md-tabs__item> <a href=../../cloudbees/sso-azure-ad/ class=md-tabs__link> CICD </a> </li> <li class=md-tabs__item> <a href=../../kubernetes/ class=md-tabs__link> Containers </a> </li> <li class=md-tabs__item> <a href=../../cloud/automation-pulumi/ class=md-tabs__link> Cloud </a> </li> <li class=md-tabs__item> <a href=../../certificates/lets-encrypt-k8s/ class=md-tabs__link> SWE </a> </li> <li class=md-tabs__item> <a href=../../java/ class=md-tabs__link> Java </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://joostvdg.github.io title="J's Software Development Pages" class="md-nav__button md-logo"> <i class=md-icon>public</i> </a> J's Software Development Pages </label> <div class=md-nav__source> <a href=https://github.com/joostvdg/joostvdg.github.io/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> joostvdg/joostvdg.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Me class=md-nav__link> Me </a> </li> <li class=md-nav__item> <a href=../../other/mkdocs/ title="MKDocs (This Static Website)" class=md-nav__link> MKDocs (This Static Website) </a> </li> <li class=md-nav__item> <a href=../../other/vim/ title=VIM class=md-nav__link> VIM </a> </li> <li class=md-nav__item> <a href=../../other/shell/ title=Shell class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Blogs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../jenkins-pipeline-support-tool/ title="Jenkins Pipeline Support Tools" class=md-nav__link> Jenkins Pipeline Support Tools </a> </li> <li class=md-nav__item> <a href=../graceful-shutdown/ title="Docker Graceful Shutdown" class=md-nav__link> Docker Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../docker-alternatives/ title="Pipelines with Docker Alternatives" class=md-nav__link> Pipelines with Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../k8s-lets-encrypt/ title="Let's Encrypt for Kubernetes Apps" class=md-nav__link> Let's Encrypt for Kubernetes Apps </a> </li> <li class=md-nav__item> <a href=../sso-azure-ad/ title="CloudBees SSO Azure AD" class=md-nav__link> CloudBees SSO Azure AD </a> </li> <li class=md-nav__item> <a href=../teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Kubernetes SSO Keycloak </label> <a href=./ title="Kubernetes SSO Keycloak" class="md-nav__link md-nav__link--active"> Kubernetes SSO Keycloak </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#goal class=md-nav__link> Goal </a> </li> <li class=md-nav__item> <a href=#audience class=md-nav__link> Audience </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> Steps </a> </li> <li class=md-nav__item> <a href=#ldap class=md-nav__link> LDAP </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-data-set class=md-nav__link> Test Data Set </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basics class=md-nav__link> Basics </a> </li> <li class=md-nav__item> <a href=#user-entries class=md-nav__link> User Entries </a> </li> <li class=md-nav__item> <a href=#group class=md-nav__link> Group </a> </li> <li class=md-nav__item> <a href=#administrator class=md-nav__link> Administrator </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-opendj class=md-nav__link> Configure OpenDJ </a> </li> <li class=md-nav__item> <a href=#dockerfile class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#kubernetes-deployment class=md-nav__link> Kubernetes Deployment </a> </li> <li class=md-nav__item> <a href=#kubernetes-service class=md-nav__link> Kubernetes Service </a> </li> <li class=md-nav__item> <a href=#homegrown-helm-chart-with-github class=md-nav__link> Homegrown Helm chart with GitHub </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#keycloak class=md-nav__link> Keycloak </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-requisites class=md-nav__link> Pre-requisites </a> </li> <li class=md-nav__item> <a href=#install-via-helm class=md-nav__link> Install Via Helm </a> </li> <li class=md-nav__item> <a href=#ldap-as-user-federation class=md-nav__link> LDAP As User Federation </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-ldap class=md-nav__link> Create LDAP </a> </li> <li class=md-nav__item> <a href=#add-group-mapping class=md-nav__link> Add Group Mapping </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mix-ldap-users-with-other-sources class=md-nav__link> Mix LDAP Users With Other Sources </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ui class=md-nav__link> UI </a> </li> <li class=md-nav__item> <a href=#rest-api class=md-nav__link> REST API </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-token class=md-nav__link> Get Token </a> </li> <li class=md-nav__item> <a href=#get-users class=md-nav__link> Get Users </a> </li> <li class=md-nav__item> <a href=#create-user class=md-nav__link> Create User </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verify class=md-nav__link> Verify </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sso-with-jenkins class=md-nav__link> SSO with Jenkins </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keycloak-client class=md-nav__link> Keycloak Client </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#main-settings class=md-nav__link> Main Settings </a> </li> <li class=md-nav__item> <a href=#group-mappings class=md-nav__link> Group Mappings </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-via-ui class=md-nav__link> Configure Via UI </a> </li> <li class=md-nav__item> <a href=#configure-via-configuration-as-code class=md-nav__link> Configure Via Configuration-as-Code </a> </li> <li class=md-nav__item> <a href=#use-keycloak-groups-in-jenkins class=md-nav__link> Use Keycloak Groups In Jenkins </a> </li> <li class=md-nav__item> <a href=#verify_1 class=md-nav__link> Verify </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-8 type=checkbox id=nav-2-8> <label class=md-nav__link for=nav-2-8> Jenkins Monitoring Kubernetes </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-8> Jenkins Monitoring Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/prepare/ title="Prepare Environment" class=md-nav__link> Prepare Environment </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/install/ title="Install Tools" class=md-nav__link> Install Tools </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/metrics/ title=Metrics class=md-nav__link> Metrics </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/alerts/ title=Alerts class=md-nav__link> Alerts </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/pipeline/ title=Pipeline class=md-nav__link> Pipeline </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/dashboard/ title=Dashboard class=md-nav__link> Dashboard </a> </li> <li class=md-nav__item> <a href=../monitor-jenkins-on-k8s/cloudbees/ title=CloudBees class=md-nav__link> CloudBees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../k8s-crd/ title="Create your own k8s resource" class=md-nav__link> Create your own k8s resource </a> </li> <li class=md-nav__item> <a href=../dockercon-eu-2018/ title="DockerCon EU 2018" class=md-nav__link> DockerCon EU 2018 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> CICD </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> CICD </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> CloudBees </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> CloudBees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloudbees/sso-azure-ad/ title="Single Sign On - AzureAD" class=md-nav__link> Single Sign On - AzureAD </a> </li> <li class=md-nav__item> <a href=../../cloudbees/teams-automation/ title="CloudBees Automate Teams" class=md-nav__link> CloudBees Automate Teams </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-gke-helm/ title="CloudBees Core on GKE" class=md-nav__link> CloudBees Core on GKE </a> </li> <li class=md-nav__item> <a href=../../cloudbees/cbc-eks/ title="CloudBees Core on EKS" class=md-nav__link> CloudBees Core on EKS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Jenkins X </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Jenkins X </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkinsx/jxboot/ title="JX Boot GKE" class=md-nav__link> JX Boot GKE </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/jxboot-aks/ title="JX Boot AKS" class=md-nav__link> JX Boot AKS </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/aks-boot-core/ title="JX Boot & CloudBees Core" class=md-nav__link> JX Boot & CloudBees Core </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hello-world/ title=HelloWorld class=md-nav__link> HelloWorld </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/buildpack/ title=BuildPack class=md-nav__link> BuildPack </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/hybrid/ title=Hybrid class=md-nav__link> Hybrid </a> </li> <li class=md-nav__item> <a href=../../jenkinsx/kubernetes-days/ title="Example For Console Reel" class=md-nav__link> Example For Console Reel </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Jenkins </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Jenkins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jobdsl/ title=JobDSL class=md-nav__link> JobDSL </a> </li> <li class=md-nav__item> <a href=../../jenkins-jobs/jenkins-jobs-builder/ title=JenkinsJobsBuilder class=md-nav__link> JenkinsJobsBuilder </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> Jenkins Pipelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-4> Jenkins Pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline/job-types/ title="Job Types" class=md-nav__link> Job Types </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/kaniko-pipelines/ title="Build Docker Image Kaniko" class=md-nav__link> Build Docker Image Kaniko </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/podtemplate-dind/ title="PodTemplate With Docker-In-Docker" class=md-nav__link> PodTemplate With Docker-In-Docker </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/jenkins-parallel-pipeline/ title="Parallel Pipelines" class=md-nav__link> Parallel Pipelines </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/core-concepts/ title="Core Concepts" class=md-nav__link> Core Concepts </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/artifactory-integration/ title="Artifactory Integration" class=md-nav__link> Artifactory Integration </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/declarative-pipeline/ title="Pipeline (declarative)" class=md-nav__link> Pipeline (declarative) </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/groovy-pipeline/ title="Groovy DSL Pipeline" class=md-nav__link> Groovy DSL Pipeline </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/global-shared-library/ title="Pipeline Libraries" class=md-nav__link> Pipeline Libraries </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/ide-integration-pipeline-dsl/ title="DSL IDE Integration" class=md-nav__link> DSL IDE Integration </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline/input/ title=Input class=md-nav__link> Input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Jenkins Pipeline Examples </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-5> Jenkins Pipeline Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-alternatives/ title="Docker Alternatives" class=md-nav__link> Docker Alternatives </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/maven-declarative/ title="Maven Declarative" class=md-nav__link> Maven Declarative </a> </li> <li class=md-nav__item> <a href=../../jenkins-pipeline-examples/docker-declarative/ title="Docker Declarative" class=md-nav__link> Docker Declarative </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Containers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1> <label class=md-nav__link for=nav-4-1> Kubernetes (K8S) </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> Kubernetes (K8S) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../kubernetes/cka-exam-prep/ title="CKA Exam prep" class=md-nav__link> CKA Exam prep </a> </li> <li class=md-nav__item> <a href=../../kubernetes/tools/ title=Tools class=md-nav__link> Tools </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-2 type=checkbox id=nav-4-2> <label class=md-nav__link for=nav-4-2> K8S Public Services </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-2> K8S Public Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/distributions/install-gke/ title=GKE class=md-nav__link> GKE </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/gke-terraform/ title="GKE Terraform" class=md-nav__link> GKE Terraform </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/eks-eksctl/ title="AWS EKS" class=md-nav__link> AWS EKS </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aks-cli/ title="AKS CLI" class=md-nav__link> AKS CLI </a> </li> <li class=md-nav__item> <a href=../../kubernetes/distributions/aks-terraform/ title="AKS Terraform" class=md-nav__link> AKS Terraform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> K8S Hard Way - GCE </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> K8S Hard Way - GCE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/ title="Installer Preparation" class=md-nav__link> Installer Preparation </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/terraform-compute/ title="Create GCE resources" class=md-nav__link> Create GCE resources </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/certificates/ title="Prepare Certificates" class=md-nav__link> Prepare Certificates </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/kubeconfigs/ title="Prepare Kubeconfigs" class=md-nav__link> Prepare Kubeconfigs </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/encryption/ title="Encryption configuration" class=md-nav__link> Encryption configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/etcd/ title="ETCD configuration" class=md-nav__link> ETCD configuration </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/controller/ title="Controller Config" class=md-nav__link> Controller Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/worker/ title="Worker Config" class=md-nav__link> Worker Config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/remote-access/ title="Remote access" class=md-nav__link> Remote access </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/network/ title="Network config" class=md-nav__link> Network config </a> </li> <li class=md-nav__item> <a href=../../kubernetes/khw-gce/debug/ title=Debug class=md-nav__link> Debug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class=md-nav__link for=nav-4-4> Docker </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-4> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker/graceful-shutdown/ title="Graceful Shutdown" class=md-nav__link> Graceful Shutdown </a> </li> <li class=md-nav__item> <a href=../../docker/build-kit/ title=BuildKit class=md-nav__link> BuildKit </a> </li> <li class=md-nav__item> <a href=../../docker/multi-stage-builds/ title="Multi-Stage Builds(TBD)" class=md-nav__link> Multi-Stage Builds(TBD) </a> </li> <li class=md-nav__item> <a href=../../docker/swarm/ title="Swarm (mode) (TBD)" class=md-nav__link> Swarm (mode) (TBD) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-5> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../linux/systemd/ title=SystemD class=md-nav__link> SystemD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Cloud </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloud/automation-pulumi/ title="Automation - Pulumi" class=md-nav__link> Automation - Pulumi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> SWE </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> SWE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../certificates/lets-encrypt-k8s/ title="Let's Encrypt K8S" class=md-nav__link> Let's Encrypt K8S </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Software Engineering </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-2> Software Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../swe/important-concepts/ title="Important Concepts" class=md-nav__link> Important Concepts </a> </li> <li class=md-nav__item> <a href=../../swe/naming/ title=Naming class=md-nav__link> Naming </a> </li> <li class=md-nav__item> <a href=../../swe/distributed/ title="Distributed Computing" class=md-nav__link> Distributed Computing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-3 type=checkbox id=nav-6-3> <label class=md-nav__link for=nav-6-3> Productivity </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-3> Productivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../productivity/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../productivity/incidents/ title=Incidents class=md-nav__link> Incidents </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../java/ title=General class=md-nav__link> General </a> </li> <li class=md-nav__item> <a href=../../keep-watching/ title="Spring Boot App" class=md-nav__link> Spring Boot App </a> </li> <li class=md-nav__item> <a href=../../java/networking/ title="Java Networking" class=md-nav__link> Java Networking </a> </li> <li class=md-nav__item> <a href=../../java/concurrency/ title="Java Concurrency" class=md-nav__link> Java Concurrency </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#goal class=md-nav__link> Goal </a> </li> <li class=md-nav__item> <a href=#audience class=md-nav__link> Audience </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> Steps </a> </li> <li class=md-nav__item> <a href=#ldap class=md-nav__link> LDAP </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#test-data-set class=md-nav__link> Test Data Set </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basics class=md-nav__link> Basics </a> </li> <li class=md-nav__item> <a href=#user-entries class=md-nav__link> User Entries </a> </li> <li class=md-nav__item> <a href=#group class=md-nav__link> Group </a> </li> <li class=md-nav__item> <a href=#administrator class=md-nav__link> Administrator </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-opendj class=md-nav__link> Configure OpenDJ </a> </li> <li class=md-nav__item> <a href=#dockerfile class=md-nav__link> Dockerfile </a> </li> <li class=md-nav__item> <a href=#kubernetes-deployment class=md-nav__link> Kubernetes Deployment </a> </li> <li class=md-nav__item> <a href=#kubernetes-service class=md-nav__link> Kubernetes Service </a> </li> <li class=md-nav__item> <a href=#homegrown-helm-chart-with-github class=md-nav__link> Homegrown Helm chart with GitHub </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#keycloak class=md-nav__link> Keycloak </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-requisites class=md-nav__link> Pre-requisites </a> </li> <li class=md-nav__item> <a href=#install-via-helm class=md-nav__link> Install Via Helm </a> </li> <li class=md-nav__item> <a href=#ldap-as-user-federation class=md-nav__link> LDAP As User Federation </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-ldap class=md-nav__link> Create LDAP </a> </li> <li class=md-nav__item> <a href=#add-group-mapping class=md-nav__link> Add Group Mapping </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mix-ldap-users-with-other-sources class=md-nav__link> Mix LDAP Users With Other Sources </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ui class=md-nav__link> UI </a> </li> <li class=md-nav__item> <a href=#rest-api class=md-nav__link> REST API </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#get-token class=md-nav__link> Get Token </a> </li> <li class=md-nav__item> <a href=#get-users class=md-nav__link> Get Users </a> </li> <li class=md-nav__item> <a href=#create-user class=md-nav__link> Create User </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verify class=md-nav__link> Verify </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sso-with-jenkins class=md-nav__link> SSO with Jenkins </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keycloak-client class=md-nav__link> Keycloak Client </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#main-settings class=md-nav__link> Main Settings </a> </li> <li class=md-nav__item> <a href=#group-mappings class=md-nav__link> Group Mappings </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-via-ui class=md-nav__link> Configure Via UI </a> </li> <li class=md-nav__item> <a href=#configure-via-configuration-as-code class=md-nav__link> Configure Via Configuration-as-Code </a> </li> <li class=md-nav__item> <a href=#use-keycloak-groups-in-jenkins class=md-nav__link> Use Keycloak Groups In Jenkins </a> </li> <li class=md-nav__item> <a href=#verify_1 class=md-nav__link> Verify </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> <li class=md-nav__item> <a href=#__comments title=Comments class="md-nav__link md-nav__link--active"> Comments </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/joostvdg/joostvdg.github.io/edit/master/docs/blogs/kubernetes-sso-keycloak.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=single-sign-on-on-kubernetes-with-keycloak>Single Sign On on Kubernetes with Keycloak<a class=headerlink href=#single-sign-on-on-kubernetes-with-keycloak title="Permanent link">&para;</a></h1> <p>This article is about setting up an Apache Keycloak<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> instance for Single Sign-On<sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup> (SSO) on Kubernetes.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>This guide is created to help you show how you can do this from a technical point of view. If you are in an enterprise, please consult your in-house - if available - or external security professionals before running tools such as Keycloak in production.</p> </div> <h2 id=goal>Goal<a class=headerlink href=#goal title="Permanent link">&para;</a></h2> <p>The goal is to show why using Keycloak as SSO can be valuable and guide on how to do so.</p> <p>For what's in the <code class=codehilite><span class=n>How</span></code>, look at the next paragraph: <code class=codehilite><span class=n>Steps</span></code>.</p> <p>At the outset, this article is not about comparing SSO solutions or about claiming Keycloak is the best. Its a solution, and if you're interested in using this, it helps you with the how.</p> <p>Below are some links to alternatives as reference, but are not discussed.</p> <h2 id=audience>Audience<a class=headerlink href=#audience title="Permanent link">&para;</a></h2> <p>The expected audience are those who are using Kubernetes<sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup> and are:</p> <ul> <li>looking to host a SSO solution themselves</li> <li>want to use LDAP<sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup> as <code class=codehilite><span class=k>User</span> <span class=n>Federation</span></code> for Keycloak</li> <li>want to setup a SSO with Jenkins<sup id=fnref:5><a class=footnote-ref href=#fn:5>5</a></sup> and/or SonarQube<sup id=fnref:6><a class=footnote-ref href=#fn:6>6</a></sup></li> </ul> <h2 id=steps>Steps<a class=headerlink href=#steps title="Permanent link">&para;</a></h2> <p>These are the steps we will execute.</p> <ul> <li>configure an LDAP server with a test data set</li> <li>package LDAP server in a Docker container and run it as an kubernetes <code class=codehilite><span class=n>Deployment</span></code><ul> <li>you might think, why not a <code class=codehilite><span class=n>StatefulSet</span></code>, but our LDAP will have static data</li> <li>and the idea of this setup, is that we do not control LDAP, meaning, we should expect LDAP's data to be immutable</li> </ul> </li> <li>install Keycloak with Helm<sup id=fnref:8><a class=footnote-ref href=#fn:8>8</a></sup><ul> <li>we use Helm 2, as Helm 3<sup id=fnref:9><a class=footnote-ref href=#fn:9>9</a></sup> is still in beta at the time of writing (September 2019)</li> </ul> </li> <li>configure Keycloak to use LDAP for <code class=codehilite><span class=k>User</span> <span class=n>Federation</span></code></li> <li>install Jenkins and SonarQube with Helm<sup id=fnref2:8><a class=footnote-ref href=#fn:8>8</a></sup></li> <li>configure SSO with Keycloak in Jenkins</li> <li>configure SSO with Keycloak in SonarQube</li> </ul> <h2 id=ldap>LDAP<a class=headerlink href=#ldap title="Permanent link">&para;</a></h2> <p>We will use OpenDJ<sup id=fnref:7><a class=footnote-ref href=#fn:7>7</a></sup> as LDAP implementation. There are many alternatives out there, feel free to use those. But for this guide, we will use OpenDJ's community edition, it works well and is easy to configure.</p> <p>We need the following:</p> <ul> <li>configured with a test data set including users and groups</li> <li>Docker container image definition</li> <li>Kubernetes <code class=codehilite><span class=n>Deployment</span></code> definition to run</li> <li>Kubernetes <code class=codehilite><span class=n>Service</span></code> definition to access a stable address</li> </ul> <h3 id=test-data-set>Test Data Set<a class=headerlink href=#test-data-set title="Permanent link">&para;</a></h3> <details class=example><summary>example.ldiff</summary><p>This a full example.</p> <p>The different parts will be explained below.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>dn</span><span class=o>:</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>domain</span>
<span class=n>dc</span><span class=o>:</span> <span class=n>example</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>People</span>
<span class=n>aci</span><span class=o>:</span> <span class=o>(</span><span class=n>targetattr</span><span class=o>=</span><span class=s2>&quot;*||+&quot;</span><span class=o>)(</span><span class=n>version</span> <span class=mf>3.0</span><span class=o>;</span> <span class=n>acl</span> <span class=s2>&quot;IDM Access&quot;</span><span class=o>;</span> <span class=n>allow</span> <span class=o>(</span><span class=n>all</span><span class=o>)</span>
<span class=n>userdn</span><span class=o>=</span><span class=s2>&quot;ldap:///uid=idm,ou=Administrators,dc=example,dc=com&quot;</span><span class=o>;)</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>cptjack</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>cpt</span><span class=o>.</span> <span class=n>Jack</span> <span class=n>Sparrow</span>
<span class=n>sn</span><span class=o>:</span> <span class=n>Sparrow</span>
<span class=n>givenname</span><span class=o>:</span> <span class=n>Jack</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>person</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalPerson</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>inetOrgPerson</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Operations</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>People</span>
<span class=n>l</span><span class=o>:</span> <span class=n>Caribbean</span>
<span class=n>uid</span><span class=o>:</span> <span class=n>cptjack</span>
<span class=n>mail</span><span class=o>:</span> <span class=n>jack</span><span class=err>@</span><span class=n>example</span><span class=o>.</span><span class=na>com</span>
<span class=n>telephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>421</span> <span class=mi>910</span> <span class=mi>123456</span>
<span class=n>facsimiletelephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>1</span> <span class=mi>408</span> <span class=mi>555</span> <span class=mi>1111</span>
<span class=n>roomnumber</span><span class=o>:</span> <span class=mi>666</span>
<span class=n>userpassword</span><span class=o>:</span> <span class=n>MyAwesomePassword</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>djones</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>Davy</span> <span class=n>Jones</span>
<span class=n>sn</span><span class=o>:</span> <span class=n>Jones</span>
<span class=n>givenname</span><span class=o>:</span> <span class=n>Davy</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>person</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalPerson</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>inetOrgPerson</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Operations</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>People</span>
<span class=n>l</span><span class=o>:</span> <span class=n>Caribbean</span>
<span class=n>uid</span><span class=o>:</span> <span class=n>djones</span>
<span class=n>mail</span><span class=o>:</span> <span class=n>d</span><span class=o>.</span><span class=na>jones</span><span class=err>@</span><span class=n>example</span><span class=o>.</span><span class=na>com</span>
<span class=n>telephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>421</span> <span class=mi>910</span> <span class=mi>382735</span>
<span class=n>facsimiletelephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>1</span> <span class=mi>408</span> <span class=mi>555</span> <span class=mi>1112</span>
<span class=n>roomnumber</span><span class=o>:</span> <span class=mi>112</span>
<span class=n>userpassword</span><span class=o>:</span> <span class=n>MyAwesomePassword</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Groups</span>
<span class=n>aci</span><span class=o>:</span> <span class=o>(</span><span class=n>targetattr</span><span class=o>=</span><span class=s2>&quot;*||+&quot;</span><span class=o>)(</span><span class=n>version</span> <span class=mf>3.0</span><span class=o>;</span> <span class=n>acl</span> <span class=s2>&quot;IDM Access&quot;</span><span class=o>;</span> <span class=n>allow</span> <span class=o>(</span><span class=n>all</span><span class=o>)</span>
<span class=n>userdn</span><span class=o>=</span><span class=s2>&quot;ldap:///uid=idm,ou=Administrators,dc=example,dc=com&quot;</span><span class=o>;)</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>cn</span><span class=o>=</span><span class=n>Pirates</span><span class=o>,</span><span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>groupOfUniqueNames</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>Pirates</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Groups</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>cptjack</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>djones</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>description</span><span class=o>:</span> <span class=n>Arrrrr</span><span class=o>!</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>cn</span><span class=o>=</span><span class=n>Catmins</span><span class=o>,</span><span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>groupOfUniqueNames</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>Catmins</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Groups</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>djones</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>description</span><span class=o>:</span> <span class=n>Purrrr</span><span class=o>!</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>Administrators</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Administrators</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>idm</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>Administrators</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>person</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalPerson</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>inetOrgPerson</span>
<span class=n>uid</span><span class=o>:</span> <span class=n>idm</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>IDM</span> <span class=n>Administrator</span>
<span class=n>sn</span><span class=o>:</span> <span class=n>IDM</span> <span class=n>Administrator</span>
<span class=n>description</span><span class=o>:</span> <span class=n>Special</span> <span class=n>LDAP</span> <span class=n>acccount</span> <span class=n>used</span> <span class=n>by</span> <span class=n>the</span> <span class=n>IDM</span>
<span class=n>to</span> <span class=n>access</span> <span class=n>the</span> <span class=n>LDAP</span> <span class=n>data</span><span class=o>.</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Administrators</span>
<span class=n>userPassword</span><span class=o>:</span> <span class=n>MySecretAdminPassword</span>
<span class=n>ds</span><span class=o>-</span><span class=n>privilege</span><span class=o>-</span><span class=n>name</span><span class=o>:</span> <span class=n>unindexed</span><span class=o>-</span><span class=n>search</span>
<span class=n>ds</span><span class=o>-</span><span class=n>privilege</span><span class=o>-</span><span class=n>name</span><span class=o>:</span> <span class=n>password</span><span class=o>-</span><span class=n>reset</span>
</pre></div> </td></tr></table> </details> <h4 id=basics>Basics<a class=headerlink href=#basics title="Permanent link">&para;</a></h4> <p>We need some basic meta data for our server. The two most important elements being:</p> <ul> <li>the base <code class=codehilite><span class=n>dn</span></code> (<em>Distinguished Name</em>), where all of our data lives<ul> <li>build up out of <code class=codehilite><span class=n>dc</span></code> (<em>domainComponent</em>) elements, representing a domain name, usually <em>companyName.com</em></li> </ul> </li> <li>the <code class=codehilite><span class=n>dn</span></code> where our user data will live and which user owns it (the <code class=codehilite><span class=n>userdn</span></code> assigned in the <code class=codehilite><span class=n>aci</span></code>)</li> </ul> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>dn</span><span class=o>:</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>domain</span>
<span class=n>dc</span><span class=o>:</span> <span class=n>example</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>People</span>
<span class=n>aci</span><span class=o>:</span> <span class=o>(</span><span class=n>targetattr</span><span class=o>=</span><span class=s2>&quot;*||+&quot;</span><span class=o>)(</span><span class=n>version</span> <span class=mf>3.0</span><span class=o>;</span> <span class=n>acl</span> <span class=s2>&quot;IDM Access&quot;</span><span class=o>;</span> <span class=n>allow</span> <span class=o>(</span><span class=n>all</span><span class=o>)</span>
  <span class=n>userdn</span><span class=o>=</span><span class=s2>&quot;ldap:///uid=idm,ou=Administrators,dc=example,dc=com&quot;</span><span class=o>;)</span>
</pre></div> </td></tr></table> <h4 id=user-entries>User Entries<a class=headerlink href=#user-entries title="Permanent link">&para;</a></h4> <p>After these two main metadata <code class=codehilite><span class=n>dn</span></code> elements, we have all the user entries.</p> <p>We start with the identifier of the entry, designated by the <code class=codehilite><span class=n>dn</span></code>, followed by attributes and classifications. While LDAP stands for <em>Lightweight</em>, it has a lot of attributes which are not easily understood because they are commonly used by their two-letter acronym only. Below we explain a few of the attributes, but there are more complete lists available<sup id=fnref:10><a class=footnote-ref href=#fn:10>10</a></sup>.</p> <ul> <li><strong>dn</strong>: the full identifier of the data entry, in reverse tree</li> <li><strong>uid</strong>: the unique id of the user within the organizational structure</li> <li><strong>cn</strong>: <em>Common Name</em>, generally how humans would identify this resource</li> <li><strong>l</strong>: <em>Location</em></li> <li><strong>ou</strong>: <em>Organizational Unit</em>, these commonly represent departments</li> <li><strong>objectclass</strong>: defines a object hierarchy, derived from Object Oriented Programming<ul> <li><strong>top</strong>: is commonly the root object class, every other object inheriting from there</li> <li>object classes are used to create typed objects which have their own schema</li> <li>this allows you to define what values are required and which are optional</li> <li>object classes are also used in search filters, so you can distinguish different value types (users, groups)</li> </ul> </li> </ul> <div class="admonition note"> <p class=admonition-title>Organizational Tree</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>.</span>
<span class=err>├──</span> <span class=n>com</span>
<span class=err>│  </span> <span class=err>└──</span> <span class=n>example</span>
<span class=err>│  </span>     <span class=err>├──</span> <span class=n>Operations</span>
<span class=err>│  </span>     <span class=err>└──</span> <span class=n>People</span>
<span class=err>│  </span>         <span class=err>└──</span> <span class=n>jwick</span>
</pre></div> </td></tr></table> </div> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>dn</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>jwick</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>John</span> <span class=n>Wick</span>
<span class=n>sn</span><span class=o>:</span> <span class=n>Wick</span>
<span class=n>givenname</span><span class=o>:</span> <span class=n>John</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>person</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalPerson</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>inetOrgPerson</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Operations</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>People</span>
<span class=n>l</span><span class=o>:</span> <span class=n>New</span> <span class=n>York</span>
<span class=n>uid</span><span class=o>:</span> <span class=n>jwick</span>
<span class=n>mail</span><span class=o>:</span> <span class=n>jwick</span><span class=err>@</span><span class=n>example</span><span class=o>.</span><span class=na>com</span>
<span class=n>telephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>1</span> <span class=mi>408</span> <span class=mi>555</span> <span class=mi>1236</span>
<span class=n>facsimiletelephonenumber</span><span class=o>:</span> <span class=o>+</span><span class=mi>1</span> <span class=mi>408</span> <span class=mi>555</span> <span class=mi>4323</span>
<span class=n>roomnumber</span><span class=o>:</span> <span class=mi>233</span>
<span class=n>userpassword</span><span class=o>:</span> <span class=n>myawesomepassword</span>
</pre></div> </td></tr></table> <h4 id=group>Group<a class=headerlink href=#group title="Permanent link">&para;</a></h4> <p>We first create the <code class=codehilite><span class=n>OU</span></code> housing our Groups, including which object classes it represents.</p> <p>Then we can attach groups to this <code class=codehilite><span class=n>OU</span></code> by creating <code class=codehilite><span class=n>dn</span></code>'s under it. There are two flavors of groups, we have <code class=codehilite><span class=n>groupOfNames</span></code> and <code class=codehilite><span class=n>groupOfUniqueNames</span></code>, I'm sure you understand what the difference is.</p> <p>We explain wich kind of group we are by the <code class=codehilite><span class=n>objectclass</span><span class=o>:</span> <span class=n>groupOfUniqueNames</span></code>, and include a list of members. In the case of <code class=codehilite><span class=n>groupOfNames</span></code> we use <code class=codehilite><span class=n>member</span><span class=p>:</span> <span class=o>&lt;</span><span class=n>member</span> <span class=n>dn</span><span class=o>&gt;</span></code>, in our case we user <code class=codehilite><span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>cptjack</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span></code>. To make it a list, add more than one entry, each with a unique value.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Groups</span>
<span class=n>aci</span><span class=o>:</span> <span class=o>(</span><span class=n>targetattr</span><span class=o>=</span><span class=s2>&quot;*||+&quot;</span><span class=o>)(</span><span class=n>version</span> <span class=mf>3.0</span><span class=o>;</span> <span class=n>acl</span> <span class=s2>&quot;IDM Access&quot;</span><span class=o>;</span> <span class=n>allow</span> <span class=o>(</span><span class=n>all</span><span class=o>)</span>
  <span class=n>userdn</span><span class=o>=</span><span class=s2>&quot;ldap:///uid=idm,ou=Administrators,dc=example,dc=com&quot;</span><span class=o>;)</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>cn</span><span class=o>=</span><span class=n>Pirates</span><span class=o>,</span><span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>groupOfUniqueNames</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>Pirates</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Groups</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>cptjack</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>will</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>uniquemember</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>djones</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>People</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>description</span><span class=o>:</span> <span class=n>Arrrrr</span><span class=o>!</span>
</pre></div> </td></tr></table> <h4 id=administrator>Administrator<a class=headerlink href=#administrator title="Permanent link">&para;</a></h4> <p>We have to configure our main administrator, as we've already given it a lot of privileges to manage the other resources (via the <code class=codehilite><span class=n>aci</span></code> rules). As usual, we start with defining a <code class=codehilite><span class=n>ou</span></code> that houses our <code class=codehilite><span class=n>Administrators</span></code>.</p> <p>In this case, we give it two more special permissions via <code class=codehilite><span class=n>ds</span><span class=o>-</span><span class=n>privilege</span><span class=o>-</span><span class=n>name</span></code>. So this user can also reset passwords, just in case.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>dn</span><span class=o>:</span> <span class=n>ou</span><span class=o>=</span><span class=n>Administrators</span><span class=o>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalunit</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Administrators</span>

<span class=n>dn</span><span class=o>:</span> <span class=n>uid</span><span class=o>=</span><span class=n>idm</span><span class=o>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>Administrators</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=o>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>top</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>person</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>organizationalPerson</span>
<span class=n>objectclass</span><span class=o>:</span> <span class=n>inetOrgPerson</span>
<span class=n>uid</span><span class=o>:</span> <span class=n>idm</span>
<span class=n>cn</span><span class=o>:</span> <span class=n>IDM</span> <span class=n>Administrator</span>
<span class=n>sn</span><span class=o>:</span> <span class=n>IDM</span> <span class=n>Administrator</span>
<span class=n>description</span><span class=o>:</span> <span class=n>Special</span> <span class=n>LDAP</span> <span class=n>acccount</span> <span class=n>used</span> <span class=n>by</span> <span class=n>the</span> <span class=n>IDM</span>
  <span class=n>to</span> <span class=n>access</span> <span class=n>the</span> <span class=n>LDAP</span> <span class=n>data</span><span class=o>.</span>
<span class=n>ou</span><span class=o>:</span> <span class=n>Administrators</span>
<span class=n>userPassword</span><span class=o>:</span> <span class=n>MySecretAdminPassword</span>
<span class=n>ds</span><span class=o>-</span><span class=n>privilege</span><span class=o>-</span><span class=n>name</span><span class=o>:</span> <span class=n>unindexed</span><span class=o>-</span><span class=n>search</span>
<span class=n>ds</span><span class=o>-</span><span class=n>privilege</span><span class=o>-</span><span class=n>name</span><span class=o>:</span> <span class=n>password</span><span class=o>-</span><span class=n>reset</span>
</pre></div> </td></tr></table> <h3 id=configure-opendj>Configure OpenDJ<a class=headerlink href=#configure-opendj title="Permanent link">&para;</a></h3> <p>One of the reasons I like OpenDJ is because it is very easy to operate. It has many tools to help you manage the server. Some are separate tools that interact with a running server, others interact with the configure while the server is offline.</p> <p>We have to do two configuration actions, 1) we intialize it with our root <code class=codehilite><span class=n>dn</span></code>, which port to use and so on, 2) we add our test data set, so we have our groups and users to work with.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class=code><div class=codehilite><pre><span></span>/opt/opendj/setup --cli <span class=se>\</span>
    -p <span class=m>1389</span> <span class=se>\</span>
    --ldapsPort <span class=m>1636</span> <span class=se>\</span>
    --enableStartTLS <span class=se>\</span>
    --generateSelfSignedCertificate <span class=se>\</span>
    --baseDN <span class=nv>dc</span><span class=o>=</span>example,dc<span class=o>=</span>com <span class=se>\</span>
    -h localhost <span class=se>\</span>
    --rootUserDN <span class=s2>&quot;</span><span class=nv>$ROOT_USER_DN</span><span class=s2>&quot;</span> <span class=se>\</span>
    --rootUserPassword <span class=s2>&quot;</span><span class=nv>$ROOT_PASSWORD</span><span class=s2>&quot;</span> <span class=se>\</span>
    --acceptLicense <span class=se>\</span>
    --no-prompt <span class=se>\</span>
    --doNotStart
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span>/opt/opendj/bin/import-ldif <span class=se>\</span>
    --includeBranch <span class=nv>dc</span><span class=o>=</span>example,dc<span class=o>=</span>com <span class=se>\</span>
    --backendID userRoot <span class=se>\</span>
    --offline <span class=se>\</span>
    --ldifFile example.ldiff
</pre></div> </td></tr></table> <h3 id=dockerfile>Dockerfile<a class=headerlink href=#dockerfile title="Permanent link">&para;</a></h3> <p>For completeness I will also include my Docker image.</p> <p>We use Tini<sup id=fnref:11><a class=footnote-ref href=#fn:11>11</a></sup> order to manage the process of OpenDJ nicely, even in the face of being shutdown. For more information, read <a href=/blogs/graceful-shutdown/ >my article on Docker Graceful Shutdown</a>.</p> <p>We use a <code class=codehilite><span class=n>jre</span></code> as we only need to run Java, so no need for a JDK. We use the OpenJDK distribution from <code class=codehilite><span class=n>Azul</span></code><sup id=fnref:15><a class=footnote-ref href=#fn:15>15</a></sup> in order to avoid possible violations of Oracle's License<sup id=fnref:12><a class=footnote-ref href=#fn:12>12</a></sup>. We use Azul's Alpine<sup id=fnref:13><a class=footnote-ref href=#fn:13>13</a></sup> based image as it is much smaller than those based of full-fledged OS's. This makes the image smaller in size on disk and in memory and reduces the attack vector and recommended by the likes of Docker and Snyk<sup id=fnref:14><a class=footnote-ref href=#fn:14>14</a></sup>.</p> <p>We download the latest version available which, as of this writing in September 2019, is <code class=codehilite><span class=mi>4</span><span class=p>.</span><span class=mi>4</span><span class=p>.</span><span class=mi>3</span></code> which you can retrieve from the OpenDJ Community's <code class=codehilite><span class=n>releases</span></code> page on GitHub<sup id=fnref2:13><a class=footnote-ref href=#fn:13>13</a></sup>.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=k>FROM</span><span class=s> azul/zulu-openjdk-alpine:8u222-jre</span>

<span class=k>LABEL</span> <span class=nv>authors</span><span class=o>=</span><span class=s2>&quot;Joost van der Griendt &lt;joostvdg@gmail.com&gt;&quot;</span>
<span class=k>LABEL</span> <span class=nv>version</span><span class=o>=</span><span class=s2>&quot;0.2.0&quot;</span>
<span class=k>LABEL</span> <span class=nv>description</span><span class=o>=</span><span class=s2>&quot;OpenDJ container&quot;</span>

<span class=k>WORKDIR</span><span class=s> /opt</span>
<span class=k>EXPOSE</span><span class=s> 1389 1636 4444</span>

<span class=k>ENV</span> <span class=nv>CHANGE_DATE</span><span class=o>=</span><span class=s1>&#39;20190916-2100&#39;</span>
<span class=k>ENV</span> JAVA_HOME /usr/lib/jvm/zulu-8
<span class=k>ENV</span> OPENDJ_JAVA_HOME /usr/lib/jvm/zulu-8
<span class=k>ENV</span> <span class=nv>VERSION</span><span class=o>=</span><span class=m>4</span>.4.3
<span class=k>ENV</span> <span class=nv>ROOT_USER_DN</span><span class=o>=</span><span class=s1>&#39;cn=admin&#39;</span>
<span class=k>ENV</span> <span class=nv>ROOT_PASSWORD</span><span class=o>=</span><span class=s1>&#39;changeme&#39;</span>
<span class=k>RUN</span> apk add --no-cache tini

<span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&quot;/sbin/tini&quot;</span><span class=p>,</span> <span class=s2>&quot;-vv&quot;</span><span class=p>,</span><span class=s2>&quot;-g&quot;</span><span class=p>,</span><span class=s2>&quot;-s&quot;</span><span class=p>,</span> <span class=s2>&quot;--&quot;</span><span class=p>]</span>
<span class=k>CMD</span> <span class=p>[</span><span class=s2>&quot;/opt/opendj/bin/start-ds&quot;</span><span class=p>,</span> <span class=s2>&quot;--nodetach&quot;</span><span class=p>]</span>

<span class=k>RUN</span> wget --quiet <span class=se>\</span>
    https://github.com/OpenIdentityPlatform/OpenDJ/releases/download/<span class=nv>$VERSION</span>/opendj-<span class=nv>$VERSION</span>.zip <span class=o>&amp;&amp;</span> <span class=se>\</span>
    unzip opendj-<span class=nv>$VERSION</span>.zip <span class=o>&amp;&amp;</span> <span class=se>\</span>
    rm -r opendj-<span class=nv>$VERSION</span>.zip

<span class=k>RUN</span> /opt/opendj/setup --cli <span class=se>\</span>
    -p <span class=m>1389</span> <span class=se>\</span>
    --ldapsPort <span class=m>1636</span> <span class=se>\</span>
    --enableStartTLS <span class=se>\</span>
    --generateSelfSignedCertificate <span class=se>\</span>
    --baseDN <span class=nv>dc</span><span class=o>=</span>example,dc<span class=o>=</span>com <span class=se>\</span>
    -h localhost <span class=se>\</span>
    --rootUserDN <span class=s2>&quot;</span><span class=nv>$ROOT_USER_DN</span><span class=s2>&quot;</span> <span class=se>\</span>
    --rootUserPassword <span class=s2>&quot;</span><span class=nv>$ROOT_PASSWORD</span><span class=s2>&quot;</span> <span class=se>\</span>
    --acceptLicense <span class=se>\</span>
    --no-prompt <span class=se>\</span>
    --doNotStart

<span class=k>ADD</span> Example.ldif /var/tmp/example.ldiff
<span class=c># RUN /opt/opendj/bin/import-ldif --help</span>
<span class=k>RUN</span> /opt/opendj/bin/import-ldif --includeBranch <span class=nv>dc</span><span class=o>=</span>example,dc<span class=o>=</span>com --backendID userRoot --offline --ldifFile /var/tmp/example.ldiff
</pre></div> </td></tr></table> <h3 id=kubernetes-deployment>Kubernetes Deployment<a class=headerlink href=#kubernetes-deployment title="Permanent link">&para;</a></h3> <p>In production you might want to run LDAP in a <code class=codehilite><span class=n>StatefulSet</span></code> and give it some permanent storage. But in this guide the goal of LDAP is to show how to use it with Keycloak and we stick to a <code class=codehilite><span class=n>Deployment</span></code> as it is easier.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class=nt>metadata</span><span class=p>:</span>
  <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>app</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
<span class=nt>spec</span><span class=p>:</span>
  <span class=nt>replicas</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class=nt>selector</span><span class=p>:</span>
    <span class=nt>matchLabels</span><span class=p>:</span>
      <span class=nt>app</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
  <span class=nt>template</span><span class=p>:</span>
    <span class=nt>metadata</span><span class=p>:</span>
      <span class=nt>labels</span><span class=p>:</span>
        <span class=nt>app</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
    <span class=nt>spec</span><span class=p>:</span>
      <span class=nt>containers</span><span class=p>:</span>
      <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
        <span class=nt>image</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">caladreas/opendj:4.4.3-1</span>
        <span class=nt>ports</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class=nt>containerPort</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1389</span>
          <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">ldap</span>
        <span class=nt>resources</span><span class=p>:</span>
          <span class=nt>requests</span><span class=p>:</span>
            <span class=nt>memory</span><span class=p>:</span> <span class=s>&quot;250Mi&quot;</span>
            <span class=nt>cpu</span><span class=p>:</span> <span class=s>&quot;50m&quot;</span>
          <span class=nt>limits</span><span class=p>:</span>
            <span class=nt>memory</span><span class=p>:</span> <span class=s>&quot;500Mi&quot;</span>
            <span class=nt>cpu</span><span class=p>:</span> <span class=s>&quot;250m&quot;</span>
</pre></div> </td></tr></table> <h3 id=kubernetes-service>Kubernetes Service<a class=headerlink href=#kubernetes-service title="Permanent link">&para;</a></h3> <p>When we use a <code class=codehilite><span class=n>Deployment</span></code> our container instance will have a generated name and a new ip address on every (re-)start. So we use a <code class=codehilite><span class=n>Service</span></code> to create a stable endpoint, which means that we will now access our LDAP server via our service: <code class=codehilite><span class=n>ldap</span><span class=p>:</span><span class=o>//</span><span class=n>opendj4</span><span class=p>:</span><span class=mi>389</span></code>.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class=nt>metadata</span><span class=p>:</span>
  <span class=nt>labels</span><span class=p>:</span>
    <span class=nt>app</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
  <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
<span class=nt>spec</span><span class=p>:</span>
  <span class=nt>ports</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
      <span class=nt>port</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">389</span>
      <span class=nt>targetPort</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1389</span>
      <span class=nt>protocol</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">TCP</span>
  <span class=nt>selector</span><span class=p>:</span>
    <span class=nt>app</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">opendj4</span>
</pre></div> </td></tr></table> <div class="admonition caution"> <p class=admonition-title>Caution</p> <p>If you deploy the <code class=codehilite><span class=n>Service</span></code> and <code class=codehilite><span class=n>Deployment</span></code> in a different namespace than where you want to access them from, you will have to add the namespace to the access url.</p> <p>If you've configured them in namespace <code class=codehilite><span class=n>ldap</span></code>, the access url becomes <code class=codehilite><span class=n>ldap</span><span class=p>:</span><span class=o>//</span><span class=n>opendj4</span><span class=p>.</span><span class=n>ldap</span><span class=p>:</span><span class=mi>389</span></code>.</p> </div> <h3 id=homegrown-helm-chart-with-github>Homegrown Helm chart with GitHub<a class=headerlink href=#homegrown-helm-chart-with-github title="Permanent link">&para;</a></h3> <p>You can also package the above explained Docker Image + Kubernetes Yaml definition as a Helm package in a GitHub repository<sup id=fnref:16><a class=footnote-ref href=#fn:16>16</a></sup>.</p> <p>So if you do not want to use any of the above, feel free to use my personal Helm Repository<sup id=fnref:17><a class=footnote-ref href=#fn:17>17</a></sup>.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm repo add joostvdg https://raw.githubusercontent.com/joostvdg/helm-repo/master/
helm repo update
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm install joostvdg/opendj4 --name ldap --namespace ldap
</pre></div> </td></tr></table> <p>The service, retrieved by <code class=codehilite><span class=n>kubectl</span> <span class=k>get</span> <span class=n>service</span></code> now has a different name.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>NAME           TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>   AGE
ldap-opendj4   ClusterIP   <span class=m>10</span>.100.19.29     &lt;none&gt;        <span class=m>389</span>/TCP   105s
</pre></div> </td></tr></table> <p>So now we access the LDAP server via <code class=codehilite><span class=n>ldap</span><span class=p>:</span><span class=o>//</span><span class=n>ldap</span><span class=o>-</span><span class=n>opendj4</span><span class=p>:</span><span class=mi>389</span></code>.</p> <h2 id=keycloak>Keycloak<a class=headerlink href=#keycloak title="Permanent link">&para;</a></h2> <h3 id=pre-requisites>Pre-requisites<a class=headerlink href=#pre-requisites title="Permanent link">&para;</a></h3> <ul> <li>Helm installed</li> <li>TLS certificate</li> </ul> <p>Using a tool as Keycloak to do SSO well, feels wrong without using TLS certificates. So I wholeheartedly recommend configuring Keycloak with a Domain name and TLS Certificate.</p> <p>For the TLS certificate, you use Let's Encrypt<sup id=fnref:20><a class=footnote-ref href=#fn:20>20</a></sup> with Cert Manager<sup id=fnref:19><a class=footnote-ref href=#fn:19>19</a></sup>, if you unsure how to proceed in Kubernetes <a href=/blogs/k8s-lets-encrypt/ >read my guide on Let's Encrypt on Kubernetes</a>.</p> <h3 id=install-via-helm>Install Via Helm<a class=headerlink href=#install-via-helm title="Permanent link">&para;</a></h3> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm repo add codecentric https://codecentric.github.io/helm-charts
helm repo update
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl apply -f keycloak-certificate.yaml
</pre></div> </td></tr></table> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>helm install --name keycloak codecentric/keycloak -f keycloak-values.yaml
</pre></div> </td></tr></table> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Make sure you replace the dns name <code class=codehilite><span class=n>keycloak</span><span class=p>.</span><span class=n>my</span><span class=p>.</span><span class=k>domain</span><span class=p>.</span><span class=n>com</span></code> with your own domain. If you do not have a domain, you can use `nip.io<sup id=fnref:18><a class=footnote-ref href=#fn:18>18</a></sup>.</p> </div> <div class="admonition example"> <p class=admonition-title>keycloak-certificate.yaml</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>apiVersion</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">certmanager.k8s.io/v1alpha1</span>
<span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">Certificate</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">keycloak.my.domain.com</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tls-keycloak</span>
<span class=nt>dnsNames</span><span class=p>:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">keycloak.my.domain.com</span>
<span class=nt>acme</span><span class=p>:</span>
    <span class=nt>config</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>http01</span><span class=p>:</span>
        <span class=nt>ingressClass</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class=nt>domains</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">keycloak.my.domain.com</span>
<span class=nt>issuerRef</span><span class=p>:</span>
    <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
    <span class=nt>kind</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterIssuer</span>
</pre></div> </td></tr></table> </div> <div class="admonition example"> <p class=admonition-title>keycloak-values.yaml</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>keycloak</span><span class=p>:</span>
  <span class=nt>password</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">notsosecret</span>
  <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class=nt>annotations</span><span class=p>:</span> 
    <span class=nt>kubernetes.io/ingress.class</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class=nt>kubernetes.io/tls-acme</span><span class=p>:</span> <span class=s>&quot;true&quot;</span>
    <span class=nt>ingress.kubernetes.io/affinity</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">cookie</span>
    <span class=nt>hosts</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">keycloak.my.domain.com</span>
    <span class=nt>tls</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>hosts</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">keycloak.my.domain.com</span>
    <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">tls-keycloak</span>
</pre></div> </td></tr></table> </div> <h3 id=ldap-as-user-federation>LDAP As User Federation<a class=headerlink href=#ldap-as-user-federation title="Permanent link">&para;</a></h3> <p>Assuming you have Keycloak running now, login with the admin user, <code class=codehilite><span class=n>keycloak</span></code>, and the password you set in the <code class=codehilite><span class=n>keycloak</span><span class=o>-</span><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code>.</p> <p>In the left hand menu, you can select <code class=codehilite><span class=k>User</span> <span class=n>Federation</span></code>, this is where we can add <code class=codehilite><span class=n>ldap</span></code> and <code class=codehilite><span class=n>kerberos</span></code> providers. As Keycloak supports multiple sources, these will be listed by their priority (the smaller the number, the higher). The federations are consulted in the order according to their priority.</p> <h4 id=create-ldap>Create LDAP<a class=headerlink href=#create-ldap title="Permanent link">&para;</a></h4> <p>Let's create the new LDAP provider, select the <code class=codehilite><span class=k>Add</span> <span class=n>provider</span></code> dropdown - top right - and choose <code class=codehilite><span class=n>ldap</span></code>.</p> <p>You will now see a whole list of values to fill in, don't worry, many can be kept as default. And to be sure, I will list them all here. For more information, each field has a little question mark, hover over it.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>When you've filled in the <code class=codehilite><span class=k>Connection</span> <span class=n>URL</span></code>, you should test the configuration with the <code class=codehilite><span class=n>Test</span> <span class=k>connection</span></code> button. The same is true for when you've configured the fields <code class=codehilite><span class=n>Users</span> <span class=n>DN</span></code>, <code class=codehilite><span class=n>Bind</span> <span class=k>Type</span></code>, <code class=codehilite><span class=n>Bind</span> <span class=n>DN</span></code>, <code class=codehilite><span class=n>Bind</span> <span class=n>Credential</span></code> with the button <code class=codehilite><span class=n>Test</span> <span class=n>authentication</span></code>.</p> </div> <ul> <li><strong>Console Display Name</strong>: display name, should be a name that tells you what this provider is</li> <li><strong>Priority</strong>: the priority of this provider, will be used for the order that the federation is accessed</li> <li><strong>Import Users</strong>: wether or not to import the users, I just leave this to <code class=codehilite><span class=k>On</span></code> as to cache the users</li> <li><strong>Import Users</strong>: <code class=codehilite><span class=n>READ_ONLY</span></code>, in this guide we assume the LDAP server is not under your control, so read only</li> <li><strong>Vendor</strong>: <code class=codehilite><span class=n>Other</span></code></li> <li><strong>Username LDAP attribute</strong>: <code class=codehilite><span class=n>uid</span></code></li> <li><strong>RDN LDAP attribute</strong>: <code class=codehilite><span class=n>uid</span></code></li> <li><strong>UUID LDAP attribute</strong>: <code class=codehilite><span class=n>entryUUID</span></code></li> <li><strong>User Object Classes</strong>: <code class=codehilite><span class=n>inetOrgPerson</span><span class=p>,</span> <span class=n>organizationalPerson</span></code></li> <li><strong>Connection URL</strong>: <code class=codehilite><span class=n>ldap</span><span class=p>:</span><span class=o>//</span><span class=n>opendj4</span><span class=p>:</span><span class=mi>389</span></code></li> <li><strong>Users DN</strong>: <code class=codehilite><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=p>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span></code></li> <li><strong>Bind Type</strong>: <code class=codehilite><span class=k>simple</span></code></li> <li><strong>Bind DN</strong>: <code class=codehilite><span class=n>uid</span><span class=o>=</span><span class=n>idm</span><span class=p>,</span> <span class=n>ou</span><span class=o>=</span><span class=n>Administrators</span><span class=p>,</span><span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=p>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span></code></li> <li><strong>Bind Credential</strong>: <code class=codehilite><span class=n>secret</span></code> -&gt; or what ever you've set it in the <code class=codehilite><span class=n>example</span><span class=p>.</span><span class=n>diff</span></code></li> <li><strong>Custom User LDAP Filter</strong>: ``</li> <li><strong>Search Scope</strong>: <code class=codehilite><span class=n>Subtree</span></code></li> <li><strong>Validate Password Policy</strong>: <code class=codehilite><span class=k>OFF</span></code></li> <li><strong>Use Truststore SPI</strong>: <code class=codehilite><span class=nv>Only</span> <span class=k>for</span> <span class=nv>ldap</span></code></li> <li><strong>Connection Pooling</strong>: <code class=codehilite><span class=k>ON</span></code></li> <li><strong>Connection Timeout</strong>: ``</li> <li><strong>Read Timeout</strong>: ``</li> <li><strong>Pagination</strong>: <code class=codehilite><span class=k>ON</span></code></li> </ul> <p>Sync Settings:</p> <ul> <li><strong>Cache Policy</strong>: 1000</li> <li><strong>Periodic Full Sync</strong>: <code class=codehilite><span class=k>On</span></code></li> <li><strong>Full Sync Period</strong>: <code class=codehilite><span class=mi>604800</span></code></li> <li><strong>Periodic Changed Users Sync</strong>: <code class=codehilite><span class=k>On</span></code></li> <li><strong>Changed Users Sync Period</strong>: <code class=codehilite><span class=mi>86400</span></code></li> </ul> <p>Cache Settings:</p> <ul> <li><strong>Cache Policy</strong>: <code class=codehilite><span class=k>DEFAULT</span></code></li> </ul> <p><img alt="Keycloak - Add LDAP" src=../../images/keycloak-ldap-01.png></p> <h4 id=add-group-mapping>Add Group Mapping<a class=headerlink href=#add-group-mapping title="Permanent link">&para;</a></h4> <p>If the value is not mentioned, the default value should be fine.</p> <p>Some values listed here are default, but listed all the same.</p> <ul> <li><strong>Name</strong>: <code class=codehilite><span class=n>groups</span></code></li> <li><strong>Mapper Type</strong>: <code class=codehilite><span class=k>group</span><span class=o>-</span><span class=n>ldap</span><span class=o>-</span><span class=n>mapper</span></code></li> <li><strong>LDAP Groups DN</strong>: <code class=codehilite><span class=n>ou</span><span class=o>=</span><span class=n>Groups</span><span class=p>,</span> <span class=n>dc</span><span class=o>=</span><span class=n>example</span><span class=p>,</span><span class=n>dc</span><span class=o>=</span><span class=n>com</span></code></li> <li><strong>Group Name LDAP Attribute</strong>: <code class=codehilite><span class=n>cn</span></code></li> <li><strong>Group Object Classes</strong>: <code class=codehilite><span class=n>groupOfUniqueNames</span></code></li> <li><strong>Membership LDAP Attribute</strong>: <code class=codehilite><span class=n>uniquemember</span></code></li> <li><strong>User Groups Retrieve Strategy</strong>: <code class=codehilite><span class=n>LOAD_GROUPS_BY_MEMBER_ATTRIBUTE</span></code></li> </ul> <p>When you hit <code class=codehilite><span class=n>Save</span></code>, you can synchronize the groups to Keycloak - if you don't need to, it will confirm the configuration works. Hit the <code class=codehilite><span class=n>Sync</span> <span class=n>LDAP</span> <span class=n>Groups</span> <span class=k>To</span> <span class=n>Keycloak</span></code> button, and on top there should be a temporary banner stating how many groups were synchronized (if all categories are <code class=codehilite><span class=mi>0</span></code>, something is wrong).</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Everytime you change a value, you first have to save the page before you can synchronize again.</p> </div> <p><img alt="Keycloak - Add LDAP" src=../../images/keycloak-ldap-02.png></p> <h3 id=mix-ldap-users-with-other-sources>Mix LDAP Users With Other Sources<a class=headerlink href=#mix-ldap-users-with-other-sources title="Permanent link">&para;</a></h3> <p>One of the reasons for this guide to exist, is to be able to encapsulate an LDAP over which you have no control and add additional accounts and groups. There's multiple ways forward here, you can use <code class=codehilite><span class=k>Identity</span> <span class=n>Providers</span></code> and <code class=codehilite><span class=k>User</span> <span class=n>Federation</span></code> to create more sources of user accounts.</p> <p>Perhaps the simplest way is to manage these extra accounts in Keycloak itself. It has its own User database and Groups database. In addition to that, it allows you to assign users created in Keycloak to be a member of a group derived from LDAP - if you've synched them.</p> <h4 id=ui>UI<a class=headerlink href=#ui title="Permanent link">&para;</a></h4> <p>We can use the UI in Keycloak to manage Users and Groups.</p> <p>We initiate this by going to the <code class=codehilite><span class=n>Users</span></code> view and hit <code class=codehilite><span class=k>Add</span> <span class=k>user</span></code>.</p> <p><img alt="Keycloak - Create User" src=../../images/keycloak-create-user-01.png></p> <p>We can then fill in all the details of the User.</p> <p><img alt="Keycloak - Create User" src=../../images/keycloak-create-user-02.png></p> <h4 id=rest-api>REST API<a class=headerlink href=#rest-api title="Permanent link">&para;</a></h4> <p>Keycloak has a rich REST API with good decent documentation<sup id=fnref:21><a class=footnote-ref href=#fn:21>21</a></sup>. The thing missing is some examples for how to use them correctly.</p> <p>I recommend using HTTPie<sup id=fnref:28><a class=footnote-ref href=#fn:28>28</a></sup> rather than cUrl, as it is easier to use for these more complex calls.</p> <h5 id=get-token>Get Token<a class=headerlink href=#get-token title="Permanent link">&para;</a></h5> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The Bearer Token is only valid for a short period of time. If you wait too long, you will get <code class=codehilite><span class=mi>401</span> <span class=n>unauthorized</span></code>.</p> </div> <p>The default REALM is <code class=codehilite><span class=n>master</span></code>.</p> <div class=superfences-tabs> <input name=__tabs_1 type=radio id=__tab_1_0 checked=checked> <label for=__tab_1_0>httpie</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>http --form POST <span class=s2>&quot;</span><span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span><span class=s2>/auth/realms/</span><span class=si>${</span><span class=nv>REALM</span><span class=si>}</span><span class=s2>/protocol/openid-connect/token&quot;</span> <span class=nv>username</span><span class=o>=</span><span class=s2>&quot;keycloak&quot;</span> <span class=nv>password</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>PASS</span><span class=si>}</span><span class=s2>&quot;</span> <span class=nv>client_id</span><span class=o>=</span><span class=s2>&quot;admin-cli&quot;</span> <span class=nv>grant_type</span><span class=o>=</span><span class=s2>&quot;password&quot;</span>
</pre></div> </td></tr></table></div> <input name=__tabs_1 type=radio id=__tab_1_1> <label for=__tab_1_1>curl</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>curl <span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span>/auth/realms/<span class=si>${</span><span class=nv>REALM</span><span class=si>}</span>/protocol/openid-connect/token -u keycloak:<span class=si>${</span><span class=nv>PASS</span><span class=si>}</span>
</pre></div> </td></tr></table></div> </div> <h5 id=get-users>Get Users<a class=headerlink href=#get-users title="Permanent link">&para;</a></h5> <div class=superfences-tabs> <input name=__tabs_2 type=radio id=__tab_2_0 checked=checked> <label for=__tab_2_0>httpie</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>http <span class=s2>&quot;</span><span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span><span class=s2>/auth/admin/realms/</span><span class=si>${</span><span class=nv>REALM</span><span class=si>}</span><span class=s2>/users&quot;</span> <span class=s2>&quot;Authorization: Bearer </span><span class=nv>$TOKEN</span><span class=s2>&quot;</span>
</pre></div> </td></tr></table></div> <input name=__tabs_2 type=radio id=__tab_2_1> <label for=__tab_2_1>httpie - get user</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>http <span class=s2>&quot;</span><span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span><span class=s2>/auth/admin/realms/</span><span class=si>${</span><span class=nv>REALM</span><span class=si>}</span><span class=s2>/users/</span><span class=si>${</span><span class=nv>userId</span><span class=si>}</span><span class=s2>&quot;</span> <span class=s2>&quot;Authorization: Bearer </span><span class=nv>$TOKEN</span><span class=s2>&quot;</span>
</pre></div> </td></tr></table></div> <input name=__tabs_2 type=radio id=__tab_2_2> <label for=__tab_2_2>curl</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>curl -v <span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span>/auth/admin/realms/<span class=si>${</span><span class=nv>REALM</span><span class=si>}</span>/users -H <span class=s2>&quot;Authorization: Bearer </span><span class=nv>$TOKEN</span><span class=s2>&quot;</span> <span class=p>|</span> jq
</pre></div> </td></tr></table></div> </div> <h5 id=create-user>Create User<a class=headerlink href=#create-user title="Permanent link">&para;</a></h5> <div class=superfences-tabs> <input name=__tabs_3 type=radio id=__tab_3_0 checked=checked> <label for=__tab_3_0>httpie</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class=code><div class=codehilite><pre><span></span>http POST <span class=s2>&quot;</span><span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span><span class=s2>/auth/admin/realms/</span><span class=si>${</span><span class=nv>REALM</span><span class=si>}</span><span class=s2>/users&quot;</span> <span class=se>\</span>
    <span class=s2>&quot;Authorization: Bearer </span><span class=nv>$TOKEN</span><span class=s2>&quot;</span> <span class=se>\</span>
    credentials:<span class=o>=</span><span class=s2>&quot;[{\&quot;value\&quot; : \&quot;mypass\&quot;, \&quot;type\&quot;: \&quot;password\&quot; }]&quot;</span> <span class=se>\</span>
    <span class=nv>email</span><span class=o>=</span><span class=s2>&quot;user@example.com&quot;</span> <span class=se>\</span>
    <span class=nv>firstName</span><span class=o>=</span><span class=s2>&quot;hannibal&quot;</span> <span class=se>\</span>
    <span class=nv>lastName</span><span class=o>=</span><span class=s2>&quot;lecter&quot;</span> <span class=se>\</span>
    <span class=nv>username</span><span class=o>=</span><span class=s2>&quot;hlecter&quot;</span> <span class=se>\</span>
    groups:<span class=o>=</span><span class=s1>&#39;[&quot;Robots&quot;]&#39;</span> <span class=se>\</span>
    emailVerified:<span class=o>=</span><span class=nb>true</span> <span class=se>\</span>
    enabled:<span class=o>=</span><span class=nb>true</span>
</pre></div> </td></tr></table></div> <input name=__tabs_3 type=radio id=__tab_3_1> <label for=__tab_3_1>curl</label> <div class=superfences-content><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span>curl -v <span class=si>${</span><span class=nv>KEYCLOAK_URL</span><span class=si>}</span>/auth/admin/realms/<span class=si>${</span><span class=nv>REALM</span><span class=si>}</span>/users -H <span class=s2>&quot;Authorization: Bearer </span><span class=nv>$TOKEN</span><span class=s2>&quot;</span> <span class=p>|</span> jq
</pre></div> </td></tr></table></div> </div> <h3 id=verify>Verify<a class=headerlink href=#verify title="Permanent link">&para;</a></h3> <p>To verify everything is working as it should, you can go to the <code class=codehilite><span class=n>Groups</span></code> and <code class=codehilite><span class=n>Users</span></code> pages within the <code class=codehilite><span class=n>Manage</span></code> menu (left hand side).</p> <p>With Groups you have <code class=codehilite><span class=k>View</span> <span class=k>all</span> <span class=n>groups</span></code>, which should have the groups from LDAP and any group you have created within Keycloak - if not yet, you can do so here as well.</p> <p>To view details of a Group, double click the name - it's not obvious you can do so - and you will go to the details page. Here you can also see the members of the Group.</p> <p>You can do the same with the Users menu item. By default the page is empty, if your list of users is not too large, click on <code class=codehilite><span class=k>View</span> <span class=k>all</span> <span class=n>users</span></code>. You can view the details page of a user by clicking the link of the User ID. Within the Groups tab you can add the user to more groups, this should contain all the groups known to Keycloak - both Keycloak internal and from LDAP.</p> <h2 id=sso-with-jenkins>SSO with Jenkins<a class=headerlink href=#sso-with-jenkins title="Permanent link">&para;</a></h2> <p>To configure Jenkins to use Keycloak we have two plugins at our disposal, OpenId Connect(<code class=codehilite><span class=n>oic</span><span class=o>-</span><span class=n>auth</span></code>)<sup id=fnref:22><a class=footnote-ref href=#fn:22>22</a></sup> and Keycloak<sup id=fnref:23><a class=footnote-ref href=#fn:23>23</a></sup>. While the Keycloak plugin is easier to configure for authentication, I found it difficult to configure groups. As I feel the group management is mandatory we're going with the OpenId Connect plugin.</p> <p>You can install plugins in Jenkins via the UI<sup id=fnref:24><a class=footnote-ref href=#fn:24>24</a></sup>, via the new Jenkins CLI<sup id=fnref:25><a class=footnote-ref href=#fn:25>25</a></sup>, or via the <code class=codehilite><span class=k>values</span><span class=p>.</span><span class=n>yaml</span></code> when installing via the Helm Chart<sup id=fnref:27><a class=footnote-ref href=#fn:27>27</a></sup>.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Install the OpenId Connect plugin before configuring the next parts, and restart your Jenkins instance for best results.</p> </div> <p>In order to configure OpenId Connect with Jenkins, it is the easiest to use the <code class=codehilite><span class=n>well</span><span class=o>-</span><span class=n>known</span></code> endpoint url. This endpoint contains all the configuration information the plugin needs to configure itself.</p> <p>Usually, this is <code class=codehilite><span class=cp>${</span><span class=n>KEYCLOAK_URL</span><span class=cp>}</span>/auth/realms/<span class=cp>${</span><span class=n>REALM</span><span class=cp>}</span>/.well-known/openid-configuration</code>.</p> <p>From Keycloak's perspective we have to register Jenkins as a Client.</p> <h3 id=keycloak-client>Keycloak Client<a class=headerlink href=#keycloak-client title="Permanent link">&para;</a></h3> <p>We go to the <code class=codehilite><span class=n>Clients</span></code> screen in Keycloak and hit the <code class=codehilite><span class=k>Create</span></code> button.</p> <p>In the next screen, we need to supply three values:</p> <ul> <li><strong>Client ID</strong>: the name of your client, <code class=codehilite><span class=n>jenkins</span></code> would be good example</li> <li><strong>Client Protocol</strong>: <code class=codehilite><span class=nv>openid</span><span class=o>-</span><span class=k>connect</span></code> is recommended</li> <li><strong>Root URL</strong>: the main url of your installation, for example <code class=codehilite><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>jenkins</span><span class=p>.</span><span class=n>my</span><span class=p>.</span><span class=k>domain</span><span class=p>.</span><span class=n>com</span></code></li> </ul> <h4 id=main-settings>Main Settings<a class=headerlink href=#main-settings title="Permanent link">&para;</a></h4> <p>Once we hit save, we get a details view.</p> <p>We have to change some values here.</p> <ul> <li><strong>Access Type</strong>: we need a Client ID and Client Secret, we only get this when we select <code class=codehilite><span class=n>confidential</span></code></li> <li><strong>Valid Redirect URIs</strong>: confirm this is <code class=codehilite><span class=cp>${</span><span class=n>yourJenkinsURL</span><span class=cp>}</span>/*</code></li> </ul> <p><img alt="Keycloak - Configure Jenkins via UI" src=../../images/keycloak-client-01.png></p> <p>Once you hit save, you get a new Tab in the Details screen of this Client. It is called <code class=codehilite><span class=n>Credentials</span></code>, and here you can see the Client <code class=codehilite><span class=n>Secret</span></code> which we will need to enter in Jenkins.</p> <p><img alt="Keycloak - Configure Jenkins via UI" src=../../images/keycloak-client-03.png></p> <h4 id=group-mappings>Group Mappings<a class=headerlink href=#group-mappings title="Permanent link">&para;</a></h4> <p>Just as we had to add the Group mapping to the LDAP configuration, we will need to configure the Group mapping in the Client.</p> <p>If we go into the Client details, we see there's a Tab called <code class=codehilite><span class=n>Mappers</span></code>. We create a new Mapping here by hitting the <code class=codehilite><span class=k>Create</span></code> button.</p> <p>Give the mapping a name and then select the <strong><em>Mapper Type</em></strong> <code class=codehilite><span class=k>Group</span> <span class=n>Membership</span></code>.</p> <p>The <strong><em>Token Claim Name</em></strong> is important as well, we use this in our Jenkins configuration, give it a descriptive name such as <code class=codehilite><span class=k>group</span><span class=o>-</span><span class=n>membership</span></code>.</p> <p><img alt="Keycloak - Configure Jenkins via UI" src=../../images/keycloak-client-02.png></p> <h3 id=configure-via-ui>Configure Via UI<a class=headerlink href=#configure-via-ui title="Permanent link">&para;</a></h3> <p>In Jenkins we go to <code class=codehilite><span class=n>Manage</span> <span class=n>Jenkins</span></code> -&gt; <code class=codehilite><span class=n>Configure</span> <span class=k>Global</span> <span class=k>Security</span></code> and here we select <code class=codehilite><span class=nv>Login</span> <span class=nv>with</span> <span class=nv>Openid</span> <span class=k>Connect</span></code> in the <code class=codehilite><span class=k>Security</span> <span class=n>Realm</span></code> block.</p> <ul> <li><strong>Client id</strong>: the client we've configured in Keycloak, if you've followed this guide, it should be <code class=codehilite><span class=n>jenkins</span></code></li> <li><strong>Client secret</strong>: the secret of the client configured in Keycloak, if you've lost it, go back to <code class=codehilite><span class=n>Keycloak</span></code> -&gt; <code class=codehilite><span class=n>Clients</span></code> -&gt; <code class=codehilite><span class=n>jenkins</span></code> -&gt; <code class=codehilite><span class=n>Credentials</span></code> and copy the value in the field <code class=codehilite><span class=n>Secret</span></code>.</li> </ul> <p>We now get a <code class=codehilite><span class=n>Configuration</span> <span class=k>mode</span></code> block where we can select either <code class=codehilite><span class=n>Automatic</span> <span class=n>configuration</span></code> on <code class=codehilite><span class=n>Manual</span> <span class=n>configuration</span></code>. We select <code class=codehilite><span class=n>Automatic</span></code> and enter our <code class=codehilite><span class=n>Well</span><span class=o>-</span><span class=n>known</span></code> configuration endpoint URL from Keycloak we've written down earlier. If you don't remember, the format is usually this: <code class=codehilite><span class=cp>${</span><span class=n>KEYCLOAK_URL</span><span class=cp>}</span>/auth/realms/<span class=cp>${</span><span class=n>REALM</span><span class=cp>}</span>/.well-known/openid-configuration</code>.</p> <ul> <li><strong>User name field name</strong>: <code class=codehilite><span class=n>preferred_username</span></code></li> <li><strong>Full name field name</strong>: <code class=codehilite><span class=n>name</span></code></li> <li><strong>Email field name</strong>: <code class=codehilite><span class=n>email</span></code></li> <li><strong>Groups field name</strong>: <code class=codehilite><span class=k>group</span><span class=o>-</span><span class=n>membership</span></code></li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The field <strong>Groups field name</strong> refers back to the <strong><em>Token Claim Name</em></strong> we configured in Keycloak within our Client's Mapping for Group Membership.</p> </div> <p><img alt="Keycloak - Configure Jenkins via UI" src=../../images/keycloak-jenkins-01.png></p> <h3 id=configure-via-configuration-as-code>Configure Via Configuration-as-Code<a class=headerlink href=#configure-via-configuration-as-code title="Permanent link">&para;</a></h3> <p>We can use the amazing Jenkins Configuration-as-Code<sup id=fnref:26><a class=footnote-ref href=#fn:26>26</a></sup> to make sure our SSO configuration is configured out-of-the-box!</p> <p>In order to avoid the having to store the Client ID and Client Secret, we're going to create these as Kubernetes Secrets first.</p> <p>There's more ways to create these, but this is to keep it simple.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5</pre></div></td><td class=code><div class=codehilite><pre><span></span>kubectl create secret generic oic-auth <span class=se>\</span>
  --from-literal<span class=o>=</span><span class=nv>clientID</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>CLIENT_ID</span><span class=si>}</span><span class=s2>&quot;</span> <span class=se>\</span>
  --from-literal<span class=o>=</span><span class=nv>clientSecret</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>CLIENT_SECRET</span><span class=si>}</span><span class=s2>&quot;</span> <span class=se>\</span>
  --from-literal<span class=o>=</span><span class=nv>keycloakUrl</span><span class=o>=</span><span class=si>${</span><span class=nv>keycloakUrl</span><span class=si>}</span> <span class=se>\</span>
  --namespace jenkins
</pre></div> </td></tr></table> <div class="admonition example"> <p class=admonition-title>JCASC-config.yaml</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class=code><div class=codehilite><pre><span></span>  <span class=nt>jenkins</span><span class=p>:</span>
    <span class=nt>securityRealm</span><span class=p>:</span>
    <span class=nt>oic</span><span class=p>:</span>
      <span class=nt>clientId</span><span class=p>:</span> <span class=s>&quot;${clientID}&quot;</span>
      <span class=nt>clientSecret</span><span class=p>:</span> <span class=s>&quot;${clientSecret}&quot;</span>
      <span class=nt>wellKnownOpenIDConfigurationUrl</span><span class=p>:</span> <span class=s>&quot;${keycloakUrl}/auth/realms/master/.well-known/openid-configuration&quot;</span>
      <span class=nt>tokenServerUrl</span><span class=p>:</span> <span class=s>&quot;${keycloakUrl}auth/realms/master/protocol/openid-connect/token&quot;</span>
      <span class=nt>authorizationServerUrl</span><span class=p>:</span> <span class=s>&quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/auth&quot;</span>
      <span class=nt>userInfoServerUrl</span><span class=p>:</span> <span class=s>&quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/userinfo&quot;</span>
      <span class=nt>userNameField</span><span class=p>:</span> <span class=s>&quot;preferred_username&quot;</span>
      <span class=nt>fullNameFieldName</span><span class=p>:</span> <span class=s>&quot;name&quot;</span>
      <span class=nt>emailFieldName</span><span class=p>:</span> <span class=s>&quot;email&quot;</span>
      <span class=nt>groupsFieldName</span><span class=p>:</span> <span class=s>&quot;group-membership&quot;</span>
      <span class=nt>scopes</span><span class=p>:</span> <span class=s>&quot;web-origins</span><span class=nv> </span><span class=s>address</span><span class=nv> </span><span class=s>phone</span><span class=nv> </span><span class=s>openid</span><span class=nv> </span><span class=s>offline_access</span><span class=nv> </span><span class=s>profile</span><span class=nv> </span><span class=s>roles</span><span class=nv> </span><span class=s>microprofile-jwt</span><span class=nv> </span><span class=s>email&quot;</span>
      <span class=nt>disableSslVerification</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class=nt>logoutFromOpenidProvider</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class=nt>endSessionUrl</span><span class=p>:</span> <span class=s>&quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/logout&quot;</span>
      <span class=nt>postLogoutRedirectUrl</span><span class=p>:</span> <span class=s>&quot;&quot;</span>
      <span class=nt>escapeHatchEnabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class=nt>escapeHatchSecret</span><span class=p>:</span> <span class=s>&quot;&quot;</span>
</pre></div> </td></tr></table> </div> <details class=example><summary>complete-jenkins-helm-values.yaml</summary><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nt>master</span><span class=p>:</span>
  <span class=nt>ingress</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>hostName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jenkins.my.doamain.com</span>
  <span class=nt>csrf</span><span class=p>:</span>
    <span class=nt>defaultCrumbIssuer</span><span class=p>:</span>
      <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class=nt>proxyCompatability</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class=nt>cli</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class=nt>installPlugins</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes-credentials:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">workflow-aggregator:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">workflow-job:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">credentials-binding:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">blueocean:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prometheus:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">matrix-auth:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">keycloak:latest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth:latest</span>
  <span class=nt>JCasC</span><span class=p>:</span>
    <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class=nt>pluginVersion</span><span class=p>:</span> <span class=s>&quot;1.30&quot;</span>
    <span class=nt>configScripts</span><span class=p>:</span>
      <span class=nt>welcome-message</span><span class=p>:</span> <span class="p p-Indicator">|</span>
        <span class=no>jenkins:</span>
          <span class=no>systemMessage: Welcome, this Jenkins is configured and managed as code.</span>
      <span class=nt>ldap-settings</span><span class=p>:</span> <span class="p p-Indicator">|</span>
        <span class=no>jenkins:</span>
          <span class=no>securityRealm:</span>
            <span class=no>oic:</span>
              <span class=no>clientId: &quot;${clientID}&quot;</span>
              <span class=no>clientSecret: &quot;${clientSecret}&quot;</span>
              <span class=no>wellKnownOpenIDConfigurationUrl: &quot;${keycloakUrl}/auth/realms/master/.well-known/openid-configuration&quot;</span>
              <span class=no>tokenServerUrl: &quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/token&quot;</span>
              <span class=no>authorizationServerUrl: &quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/auth&quot;</span>
              <span class=no>userInfoServerUrl: &quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/userinfo&quot;</span>
              <span class=no>userNameField: &quot;preferred_username&quot;</span>
              <span class=no>fullNameFieldName: &quot;name&quot;</span>
              <span class=no>emailFieldName: &quot;email&quot;</span>
              <span class=no>groupsFieldName: &quot;group-membership&quot;</span>
              <span class=no>scopes: &quot;web-origins address phone openid offline_access profile roles microprofile-jwt email&quot;</span>
              <span class=no>disableSslVerification: false</span>
              <span class=no>logoutFromOpenidProvider: true</span>
              <span class=no>endSessionUrl: &quot;${keycloakUrl}/auth/realms/master/protocol/openid-connect/logout&quot;</span>
              <span class=no>postLogoutRedirectUrl: &quot;&quot;</span>
              <span class=no>escapeHatchEnabled: false</span>
              <span class=no>escapeHatchSecret: &quot;&quot;</span>
      <span class=nt>matrix-auth</span><span class=p>:</span> <span class="p p-Indicator">|</span>
        <span class=no>jenkins:</span>
          <span class=no>authorizationStrategy:</span>
            <span class=no>globalMatrix:</span>
              <span class=no>permissions:</span>
                <span class=no>- &quot;Overall/Read:authenticated&quot;</span>
                <span class=no>- &quot;Overall/Administer:barbossa&quot;</span>
                <span class=no>- &quot;Overall/Administer:Catmins&quot;</span>
                <span class=no>- &quot;Overall/Administer:Robots&quot;</span>
                <span class=no>- &quot;Overall/Administer:/Catmins&quot;</span>
                <span class=no>- &quot;Overall/Administer:/Robots&quot;</span>
<span class=nt>persistence</span><span class=p>:</span>
  <span class=nt>enabled</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class=nt>volumes</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-clientid</span>
    <span class=nt>secret</span><span class=p>:</span>
      <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth</span>
      <span class=nt>items</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class=nt>key</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientID</span>
          <span class=nt>path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientID</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-clientsecret</span>
    <span class=nt>secret</span><span class=p>:</span>
      <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth</span>
      <span class=nt>items</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class=nt>key</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientSecret</span>
          <span class=nt>path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientSecret</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-keycloakurl</span>
    <span class=nt>secret</span><span class=p>:</span>
      <span class=nt>secretName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth</span>
      <span class=nt>items</span><span class=p>:</span>
        <span class="p p-Indicator">-</span> <span class=nt>key</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">keycloakUrl</span>
          <span class=nt>path</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">keycloakUrl</span>
  <span class=nt>mounts</span><span class=p>:</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-clientid</span>
      <span class=nt>mountPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/run/secrets/clientID</span>
      <span class=nt>subPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientID</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-clientsecret</span>
      <span class=nt>mountPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/run/secrets/clientSecret</span>
      <span class=nt>subPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">clientSecret</span>
    <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">oic-auth-keycloakurl</span>
      <span class=nt>mountPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">/run/secrets/keycloakUrl</span>
      <span class=nt>subPath</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">keycloakUrl</span>
</pre></div> </td></tr></table> </details> <h3 id=use-keycloak-groups-in-jenkins>Use Keycloak Groups In Jenkins<a class=headerlink href=#use-keycloak-groups-in-jenkins title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Unfortuantely, there is one caveat about using Keycloak as intermediary between LDAP and Jenkins.</p> <p>Groups do not come across the same as before, they're now prefixed with <code class=codehilite><span class=o>/</span></code>. I'm sure it is down to a misconfiguration on my end, so please let me know how to resolve that if you figure it out. </p> <p>This means, that a LDAP group called <strong><em>Catmins</em></strong> will have to be used in Jenkins via <code class=codehilite><span class=o>/</span><span class=n>Catmins</span></code> in <code class=codehilite><span class=n>Matrix</span></code>, <code class=codehilite><span class=n>Project</span> <span class=n>Matrix</span></code> or other authorization schemes.</p> </div> <h3 id=verify_1>Verify<a class=headerlink href=#verify_1 title="Permanent link">&para;</a></h3> <p>To verify, take the leap of faith to save the configuration, logout (top right) and then log back in. If everything goes well, you will be redirected to Keycloak, once successfully logged in, redirected back to Jenkins!</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>One thing to remark, that if you're logged into Jenkins and you want to see the Groups, you can select your User (top right, click on your name). </p> <p>Alternatively, you can go to <code class=codehilite><span class=cp>${</span><span class=n>JENKINS_URL</span><span class=cp>}</span>/whoAmI</code> (notice the capital casing of the 'A' and 'I', it is required).</p> </div> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <div class=footnote> <hr> <ol> <li id=fn:1> <p><a href=https://www.keycloak.org/ >Apache Keycloak Home</a>&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p><a href=https://en.wikipedia.org/wiki/Single_sign-on>Wikipedia Definition on Single sign-on</a>&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p><a href=https://kubernetes.io/ >Kubernetes Home</a>&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p><a href=https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol>Lightweight Directory Access Protocol (LDAP)</a>&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> <li id=fn:5> <p><a href=http://jenkins.io>Jenkins Home</a>&#160;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">&#8617;</a></p> </li> <li id=fn:6> <p><a href=https://www.sonarqube.org/ >SonarQube Home</a>&#160;<a class=footnote-backref href=#fnref:6 title="Jump back to footnote 6 in the text">&#8617;</a></p> </li> <li id=fn:7> <p><a href=https://github.com/OpenIdentityPlatform/OpenDJ>OpenDJ Community Edition</a>&#160;<a class=footnote-backref href=#fnref:7 title="Jump back to footnote 7 in the text">&#8617;</a></p> </li> <li id=fn:8> <p><a href=https://helm.sh/ >Helm - Package Manager for Kubernetes</a>&#160;<a class=footnote-backref href=#fnref:8 title="Jump back to footnote 8 in the text">&#8617;</a><a class=footnote-backref href=#fnref2:8 title="Jump back to footnote 8 in the text">&#8617;</a></p> </li> <li id=fn:9> <p><a href=https://medium.com/better-programming/helm-3-fun-with-the-new-beta-8f91c70891ff>Helm 3 Beta</a>&#160;<a class=footnote-backref href=#fnref:9 title="Jump back to footnote 9 in the text">&#8617;</a></p> </li> <li id=fn:10> <p><a href=http://www.zytrax.com/books/ldap/ape/#attributes>Common Used LDAP Attributes Explained</a>&#160;<a class=footnote-backref href=#fnref:10 title="Jump back to footnote 10 in the text">&#8617;</a></p> </li> <li id=fn:11> <p><a href=https://github.com/krallin/tini>tini - process manager</a>&#160;<a class=footnote-backref href=#fnref:11 title="Jump back to footnote 11 in the text">&#8617;</a></p> </li> <li id=fn:12> <p><a href=https://blog.overops.com/running-java-on-docker-youre-breaking-the-law/ >Overops Article on Java License in Docker images</a>&#160;<a class=footnote-backref href=#fnref:12 title="Jump back to footnote 12 in the text">&#8617;</a></p> </li> <li id=fn:13> <p><a href=https://hub.docker.com/_/alpine>Alpine Docker Image</a>&#160;<a class=footnote-backref href=#fnref:13 title="Jump back to footnote 13 in the text">&#8617;</a><a class=footnote-backref href=#fnref2:13 title="Jump back to footnote 13 in the text">&#8617;</a></p> </li> <li id=fn:14> <p><a href=https://snyk.io/blog/10-docker-image-security-best-practices/ >Snyk - 10 docker image security best practices</a>&#160;<a class=footnote-backref href=#fnref:14 title="Jump back to footnote 14 in the text">&#8617;</a></p> </li> <li id=fn:15> <p><a href=https://hub.docker.com/r/azul/zulu-openjdk-alpine>Azul OpenJDK Alpine Image</a>&#160;<a class=footnote-backref href=#fnref:15 title="Jump back to footnote 15 in the text">&#8617;</a></p> </li> <li id=fn:16> <p><a href=https://blog.softwaremill.com/hosting-helm-private-repository-from-github-ff3fa940d0b7>Hosting Helm Private Repository from GitHub</a>&#160;<a class=footnote-backref href=#fnref:16 title="Jump back to footnote 16 in the text">&#8617;</a></p> </li> <li id=fn:17> <p><a href=https://github.com/joostvdg/helm-repo>Joost van der Griendt's Helm Repository</a>&#160;<a class=footnote-backref href=#fnref:17 title="Jump back to footnote 17 in the text">&#8617;</a></p> </li> <li id=fn:18> <p><a href=https://nip.io/ >Nip Io - Dead simple wildcard DNS for any IP Address</a>&#160;<a class=footnote-backref href=#fnref:18 title="Jump back to footnote 18 in the text">&#8617;</a></p> </li> <li id=fn:19> <p><a href=https://github.com/jetstack/cert-manager>Cert Manager</a>&#160;<a class=footnote-backref href=#fnref:19 title="Jump back to footnote 19 in the text">&#8617;</a></p> </li> <li id=fn:20> <p><a href=https://letsencrypt.org/ >Let's Encrypt - Let's Encrypt the world!</a>&#160;<a class=footnote-backref href=#fnref:20 title="Jump back to footnote 20 in the text">&#8617;</a></p> </li> <li id=fn:21> <p><a href=https://www.keycloak.org/docs-api/6.0/rest-api/index.html#_uri_scheme>Keycloak Admin REST API</a>&#160;<a class=footnote-backref href=#fnref:21 title="Jump back to footnote 21 in the text">&#8617;</a></p> </li> <li id=fn:22> <p><a href=https://github.com/jenkinsci/oic-auth-plugin>Jenkins OpenId Connect Plugin</a>&#160;<a class=footnote-backref href=#fnref:22 title="Jump back to footnote 22 in the text">&#8617;</a></p> </li> <li id=fn:23> <p><a href=https://wiki.jenkins.io/display/JENKINS/keycloak-plugin>Jenkins Keycloak Plugin</a>&#160;<a class=footnote-backref href=#fnref:23 title="Jump back to footnote 23 in the text">&#8617;</a></p> </li> <li id=fn:24> <p><a href=https://jenkins.io/doc/book/managing/plugins/ >Jenkins Plugin Management</a>&#160;<a class=footnote-backref href=#fnref:24 title="Jump back to footnote 24 in the text">&#8617;</a></p> </li> <li id=fn:25> <p><a href=https://jenkins.io/blog/2019/08/30/jenkins-cli/ >Jenkins JCLI</a>&#160;<a class=footnote-backref href=#fnref:25 title="Jump back to footnote 25 in the text">&#8617;</a></p> </li> <li id=fn:26> <p><a href=https://github.com/jenkinsci/configuration-as-code-plugin/blob/master/README.md>Jenkins Configuration As Code</a>&#160;<a class=footnote-backref href=#fnref:26 title="Jump back to footnote 26 in the text">&#8617;</a></p> </li> <li id=fn:27> <p><a href=https://github.com/helm/charts/tree/master/stable/jenkins>Jenkins Helm Chart</a>&#160;<a class=footnote-backref href=#fnref:27 title="Jump back to footnote 27 in the text">&#8617;</a></p> </li> <li id=fn:28> <p><a href=https://httpie.org>HTTPie http commandline interface</a>&#160;<a class=footnote-backref href=#fnref:28 title="Jump back to footnote 28 in the text">&#8617;</a></p> </li> </ol> </div> <h2 id=__comments>Comments</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://joostvdg.github.io/blogs/kubernetes-sso-keycloak/";
      this.page.identifier =
        "/blogs/kubernetes-sso-keycloak/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//joostvdg-github-io.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../teams-automation/ title="CloudBees Automate Teams" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> CloudBees Automate Teams </span> </div> </a> <a href=../monitor-jenkins-on-k8s/introduction/ title=Introduction class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Introduction </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Joost van der Griendt </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=https://github.com/joostvdg class="md-footer-social__link fa fa-github"></a> <a href=https://twitter.com/joost_vdg class="md-footer-social__link fa fa-twitter"></a> <a href=https://linkedin.com/in/joostvdg class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c648116f.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>